# ğŸš€ Monitoringç»„ä»¶é‡æ„ä»»åŠ¡æ‰§è¡Œè®¡åˆ’

## ğŸ“Š æ‰§è¡Œè¿›åº¦æ€»è§ˆ

### âœ… å·²å®Œæˆé˜¶æ®µ
- **Phase 1**: æ–‡ä»¶é‡å‘½åè„šæœ¬æ‰§è¡Œå®Œæˆ
  - Infrastructureå±‚: 7ä¸ªæ–‡ä»¶é‡å‘½å âœ…
  - Collectorå±‚: 1ä¸ªæ–‡ä»¶ç§»åŠ¨ï¼Œ1ä¸ªç›®å½•æ¸…ç† âœ…
  - Analyzerå±‚: 6ä¸ªæ–‡ä»¶ç§»åŠ¨/é‡å‘½åï¼Œ3ä¸ªç›®å½•æ¸…ç† âœ…
  - Presenterå±‚: 3ä¸ªæ–‡ä»¶ç§»åŠ¨/é‡å‘½åï¼Œ2ä¸ªç›®å½•æ¸…ç† âœ…
  - Sharedå±‚: 4ä¸ªæ–‡ä»¶é‡å‘½å âœ…

## ğŸ¯ è¯¦ç»†ä»»åŠ¡åˆ†è§£

### Phase 2: Infrastructureå±‚ä»£ç é‡æ„ (é«˜ä¼˜å…ˆçº§)

#### 2.1 æ›´æ–°ç±»åå’Œå¯¼å‡º
- [ ] **infrastructure/metrics/metrics-registry.service.ts**
  - ç±»å: `InfrastructureMetricsRegistryService` â†’ `MetricsRegistryService`
  - æ›´æ–°æ‰€æœ‰ç›¸å…³å¯¼å…¥å¼•ç”¨

- [ ] **infrastructure/interceptors/infrastructure.interceptor.ts**
  - ç±»å: `InfrastructurePerformanceInterceptor` â†’ `InfrastructureInterceptor`
  - æ›´æ–°æ‰€æœ‰ç›¸å…³å¯¼å…¥å¼•ç”¨

- [ ] **åˆ›å»ºæ–°çš„åŸºç¡€æœåŠ¡æ–‡ä»¶**
  - [ ] `infrastructure/infrastructure.service.ts` - åŸºç¡€è®¾æ–½æŠ½è±¡æœåŠ¡
  - [ ] `infrastructure/infrastructure-cache.service.ts` - ç»Ÿä¸€ç¼“å­˜æœåŠ¡
  - [ ] `infrastructure/infrastructure-lock.service.ts` - åˆ†å¸ƒå¼é”æœåŠ¡
  - [ ] `infrastructure/infrastructure-sanitizer.service.ts` - æ•°æ®è„±æ•æœåŠ¡

#### 2.2 æ›´æ–°æ¨¡å—å¯¼å…¥
- [ ] **infrastructure/infrastructure.module.ts**
  - æ›´æ–°æ‰€æœ‰æœåŠ¡å¯¼å…¥è·¯å¾„
  - æ·»åŠ æ–°åˆ›å»ºçš„åŸºç¡€æœåŠ¡
  - æ›´æ–°providerså’Œexportsæ•°ç»„

### Phase 3: Collectorå±‚ä»£ç é‡æ„

#### 3.1 æ›´æ–°ç°æœ‰æ–‡ä»¶å¯¼å…¥è·¯å¾„
- [ ] **collector/collector.service.ts**
  - æ£€æŸ¥å’Œæ›´æ–°æ‰€æœ‰å¯¼å…¥è·¯å¾„
  - ç¡®ä¿ç±»åä¸æ–‡ä»¶åä¸€è‡´

- [ ] **collector/collector.interceptor.ts**
  - æ£€æŸ¥å’Œæ›´æ–°æ‰€æœ‰å¯¼å…¥è·¯å¾„

- [ ] **collector/collector.repository.ts**
  - æ£€æŸ¥å’Œæ›´æ–°æ‰€æœ‰å¯¼å…¥è·¯å¾„

#### 3.2 åˆ›å»ºæ–°çš„æ”¶é›†å™¨æœåŠ¡
- [ ] **collector/collector-validation.service.ts**
  - åˆ›å»ºæ•°æ®éªŒè¯æœåŠ¡
  - ç±»å: `CollectorValidationService`

- [ ] **collector/collector-task.service.ts**
  - åˆ›å»ºå¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—æœåŠ¡
  - ç±»å: `CollectorTaskService`

#### 3.3 æ›´æ–°æ¨¡å—é…ç½®
- [ ] **collector/collector.module.ts**
  - æ›´æ–°æ‰€æœ‰æœåŠ¡å¯¼å…¥è·¯å¾„
  - æ·»åŠ æ–°åˆ›å»ºçš„æœåŠ¡
  - æ›´æ–°providerså’Œexportsæ•°ç»„

### Phase 4: Analyzerå±‚ä»£ç é‡æ„

#### 4.1 æ›´æ–°ç±»åå’Œé‡æ„ç°æœ‰æ–‡ä»¶
- [ ] **analyzer/analyzer-health.service.ts**
  - ç±»å: `HealthAnalyzerService` â†’ `AnalyzerHealthService`
  - æ›´æ–°æ‰€æœ‰å¯¼å…¥å’Œå¼•ç”¨

- [ ] **analyzer/analyzer-trend.service.ts**
  - ç±»å: `TrendAnalyzerService` â†’ `AnalyzerTrendService`
  - æ›´æ–°æ‰€æœ‰å¯¼å…¥å’Œå¼•ç”¨

- [ ] **analyzer/analyzer-metrics.service.ts** (åŸcalculatoræ–‡ä»¶)
  - ç±»å: æ–°å»º `AnalyzerMetricsService`
  - å°†calculatoré€»è¾‘æ”¹ä¸ºserviceæ¨¡å¼

- [ ] **analyzer/analyzer-score.service.ts** (åŸhealth-score calculator)
  - ç±»å: æ–°å»º `AnalyzerScoreService`
  - å°†calculatoré€»è¾‘æ”¹ä¸ºserviceæ¨¡å¼

#### 4.2 åˆ›å»ºæ–°çš„åˆ†æå™¨ç»„ä»¶
- [ ] **analyzer/analyzer-engine.service.ts**
  - åˆ›å»ºç»Ÿè®¡å¼•æ“æœåŠ¡
  - ç±»å: `AnalyzerEngineService`

- [ ] **analyzer/analyzer.repository.ts**
  - åˆ›å»ºåˆ†ææ•°æ®ä»“åº“
  - ç±»å: `AnalyzerRepository`

#### 4.3 æ›´æ–°æ¨¡å—é…ç½®
- [ ] **analyzer/analyzer.module.ts**
  - æ›´æ–°æ‰€æœ‰æœåŠ¡å¯¼å…¥è·¯å¾„
  - æ·»åŠ æ–°åˆ›å»ºçš„æœåŠ¡å’Œä»“åº“
  - æ›´æ–°providerså’Œexportsæ•°ç»„

### Phase 5: Presenterå±‚ä»£ç é‡æ„

#### 5.1 æ›´æ–°ç±»åå’Œç°æœ‰æ–‡ä»¶
- [ ] **presenter/presenter-error.service.ts**
  - ç±»å: `PresenterErrorHandlerService` â†’ `PresenterErrorService`
  - æ›´æ–°æ‰€æœ‰å¯¼å…¥å’Œå¼•ç”¨

#### 5.2 åˆ›å»ºæ–°çš„å±•ç¤ºå™¨æœåŠ¡
- [ ] **presenter/presenter-formatter.service.ts**
  - åˆ›å»ºå“åº”æ ¼å¼åŒ–æœåŠ¡
  - ç±»å: `PresenterFormatterService`

- [ ] **presenter/presenter-report.service.ts**
  - åˆ›å»ºæŠ¥å‘Šç”ŸæˆæœåŠ¡
  - ç±»å: `PresenterReportService`

#### 5.3 æ›´æ–°æ¨¡å—é…ç½®
- [ ] **presenter/presenter.module.ts**
  - æ›´æ–°æ‰€æœ‰æœåŠ¡å¯¼å…¥è·¯å¾„
  - æ·»åŠ æ–°åˆ›å»ºçš„æœåŠ¡
  - æ›´æ–°providerså’Œexportsæ•°ç»„

### Phase 6: å…¨å±€å¯¼å…¥è·¯å¾„æ›´æ–°

#### 6.1 æ›´æ–°æ ¹æ¨¡å—
- [ ] **monitoring.module.ts**
  - æ›´æ–°æ‰€æœ‰å­æ¨¡å—å¯¼å…¥è·¯å¾„
  - ç¡®ä¿æ‰€æœ‰æ¨¡å—æ­£ç¡®åŠ è½½

#### 6.2 æ›´æ–°indexæ–‡ä»¶
- [ ] **contracts/index.ts**
  - æ›´æ–°æ‰€æœ‰å¯¼å‡ºè·¯å¾„

- [ ] **shared/types/index.ts**
  - æ›´æ–°ç±»å‹å¯¼å‡ºè·¯å¾„

- [ ] **shared/interfaces/index.ts**
  - æ›´æ–°æ¥å£å¯¼å‡ºè·¯å¾„

#### 6.3 è·¨æ¨¡å—å¼•ç”¨æ›´æ–°
- [ ] **æœç´¢å¹¶æ›´æ–°æ‰€æœ‰TypeScriptæ–‡ä»¶ä¸­çš„å¯¼å…¥è·¯å¾„**
  - ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼æŸ¥æ‰¾: `from ['"].*monitoring.*['"]`
  - æ›´æ–°ä¸ºæ–°çš„è·¯å¾„ç»“æ„

### Phase 7: æµ‹è¯•å’ŒéªŒè¯

#### 7.1 ç¼–è¯‘éªŒè¯
- [ ] **TypeScriptç¼–è¯‘æµ‹è¯•**
  ```bash
  npx tsc --noEmit --project .
  ```

#### 7.2 å¯¼å…¥è·¯å¾„éªŒè¯
- [ ] **æ£€æŸ¥å¾ªç¯ä¾èµ–**
  ```bash
  npx madge --circular --extensions ts src/monitoring/
  ```

#### 7.3 è¿è¡Œæµ‹è¯•å¥—ä»¶
- [ ] **å•å…ƒæµ‹è¯•**
  ```bash
  DISABLE_AUTO_INIT=true npx jest src/monitoring --passWithNoTests
  ```

#### 7.4 åŠŸèƒ½éªŒè¯
- [ ] **å¯åŠ¨åº”ç”¨ç¨‹åº**
  ```bash
  bun run dev
  ```
- [ ] **éªŒè¯ç›‘æ§ç«¯ç‚¹æ­£å¸¸å·¥ä½œ**

## ğŸ“‹ ä»»åŠ¡ä¼˜å…ˆçº§ä¸ä¾èµ–å…³ç³»

### ğŸ”´ P0 - å¿…é¡»ç«‹å³å®Œæˆ
1. Infrastructureå±‚åŸºç¡€æœåŠ¡åˆ›å»º
2. ç±»åé‡æ„å’Œå¯¼å…¥è·¯å¾„æ›´æ–°
3. TypeScriptç¼–è¯‘é”™è¯¯ä¿®å¤

### ğŸŸ¡ P1 - é«˜ä¼˜å…ˆçº§
4. æ–°æœåŠ¡ç»„ä»¶åˆ›å»º
5. æ¨¡å—é…ç½®æ›´æ–°
6. åŠŸèƒ½éªŒè¯æµ‹è¯•

### ğŸŸ¢ P2 - ä¸­ç­‰ä¼˜å…ˆçº§
7. ä»£ç ä¼˜åŒ–å’Œé‡æ„
8. æµ‹è¯•è¦†ç›–ç‡æå‡
9. æ–‡æ¡£æ›´æ–°

## ğŸ› ï¸ æ‰§è¡Œç­–ç•¥

### å•ä»»åŠ¡æ‰§è¡ŒåŸåˆ™
- ä¸€æ¬¡åªè¿›è¡Œä¸€ä¸ªå±‚çº§çš„é‡æ„
- æ¯å®Œæˆä¸€ä¸ªä»»åŠ¡ç«‹å³è¿›è¡Œç¼–è¯‘éªŒè¯
- å‘ç°é—®é¢˜ç«‹å³ä¿®å¤ï¼Œä¸ç´¯ç§¯æŠ€æœ¯å€ºåŠ¡

### å›æ»šå‡†å¤‡
- æ¯ä¸ªPhaseå®Œæˆååˆ›å»ºGitæäº¤
- ä¿æŒåŠŸèƒ½å®Œæ•´æ€§ï¼Œé¿å…ç ´åæ€§å˜æ›´
- å‡†å¤‡å¿«é€Ÿå›æ»šæœºåˆ¶

### è´¨é‡æ§åˆ¶
- æ¯ä¸ªæ–‡ä»¶ä¿®æ”¹åè¿è¡ŒTypeScriptæ£€æŸ¥
- ç¡®ä¿å¯¼å…¥è·¯å¾„æ­£ç¡®æ€§
- éªŒè¯ç±»åä¸æ–‡ä»¶åä¸€è‡´æ€§

## ğŸ“Š ä¼°ç®—å·¥ä½œé‡

| Phase | ä»»åŠ¡æ•°é‡ | é¢„ä¼°æ—¶é—´ | éš¾åº¦ |
|-------|----------|----------|------|
| Phase 2 | 8ä¸ªä»»åŠ¡ | 2-3å°æ—¶ | ğŸ”´ é«˜ |
| Phase 3 | 6ä¸ªä»»åŠ¡ | 1-2å°æ—¶ | ğŸŸ¡ ä¸­ |
| Phase 4 | 8ä¸ªä»»åŠ¡ | 2-3å°æ—¶ | ğŸ”´ é«˜ |
| Phase 5 | 6ä¸ªä»»åŠ¡ | 1-2å°æ—¶ | ğŸŸ¡ ä¸­ |
| Phase 6 | 4ä¸ªä»»åŠ¡ | 1å°æ—¶ | ğŸŸ¡ ä¸­ |
| Phase 7 | 4ä¸ªä»»åŠ¡ | 1å°æ—¶ | ğŸŸ¢ ä½ |
| **æ€»è®¡** | **36ä¸ªä»»åŠ¡** | **8-12å°æ—¶** | - |

## âš¡ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

1. **ç«‹å³å¼€å§‹Phase 2: Infrastructureå±‚é‡æ„**
2. **é‡ç‚¹å…³æ³¨åŸºç¡€æœåŠ¡åˆ›å»ºå’Œç±»åæ›´æ–°**
3. **æ¯ä¸ªæ­¥éª¤éƒ½è¦è¿›è¡Œç¼–è¯‘éªŒè¯**

---

**ğŸ¯ ç›®æ ‡**ï¼šå®Œæˆç»Ÿä¸€å‘½åè§„èŒƒçš„ç›‘æ§ç»„ä»¶é‡æ„ï¼Œä¸ºåç»­çš„ç»Ÿä¸€å¯è§‚æµ‹æ€§å¹³å°åˆå¹¶åšå¥½å‡†å¤‡ã€‚