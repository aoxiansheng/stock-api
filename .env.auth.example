# ================================
# Auth模块统一配置环境变量
# ================================
# 说明：这些环境变量用于Auth模块的新分层配置系统
# 用于替代原有分散在多个文件中的配置常量

# ================================
# 缓存配置层 (AuthCacheConfig)
# ================================

# 专用缓存TTL配置 - 完全消除配置重叠问题，每种缓存独立配置
# 原来分散在: security.config.ts, permission-control.constants.ts, api-security.constants.ts
AUTH_PERMISSION_CACHE_TTL=300        # 权限检查缓存TTL（秒），默认300秒（5分钟）
AUTH_API_KEY_CACHE_TTL=300           # API Key验证缓存TTL（秒），默认300秒（5分钟）
AUTH_RATE_LIMIT_TTL=60               # 频率限制缓存TTL（秒），默认60秒
AUTH_STATISTICS_CACHE_TTL=300        # 统计信息缓存TTL（秒），默认300秒（5分钟）
AUTH_SESSION_CACHE_TTL=3600          # 会话缓存TTL（秒），默认3600秒（1小时）

# ================================
# 限制配置层 (AuthLimitsConfig)
# ================================

# 频率限制配置 - 统一管理所有频率限制
# 原来分散在: auth-configuration.ts, rate-limiting.constants.ts, api-security.constants.ts
AUTH_RATE_LIMIT=100                  # 全局频率限制（每分钟），默认100次
AUTH_API_KEY_VALIDATE_RATE=100       # API Key验证频率（每秒），默认100次
AUTH_LOGIN_RATE_LIMIT=5              # 登录频率限制（每分钟），默认5次

# 字符串和数据长度限制 - 消除长度限制配置重叠
# 原来分散在: auth-configuration.ts, validation-limits.constants.ts, rate-limiting.constants.ts
AUTH_STRING_LIMIT=10000              # 最大字符串长度，默认10000字符
AUTH_MAX_PAYLOAD_BYTES=10485760      # 最大负载大小（字节），默认10MB
AUTH_MAX_PAYLOAD_SIZE=10MB           # 最大负载大小（字符串），默认10MB

# 超时配置 - 统一管理所有超时参数
# 原来分散在: permission-control.constants.ts, api-security.constants.ts, auth-configuration.ts
AUTH_TIMEOUT=5000                    # 通用操作超时（毫秒），默认5000ms（5秒）
AUTH_REDIS_CONNECTION_TIMEOUT=5000   # Redis连接超时（毫秒），默认5000ms
AUTH_REDIS_COMMAND_TIMEOUT=5000      # Redis命令超时（毫秒），默认5000ms

# API Key相关配置
AUTH_API_KEY_LENGTH=32               # API Key长度，默认32位
AUTH_MAX_API_KEYS_PER_USER=50        # 每用户最大API Key数量，默认50个
AUTH_API_KEY_CREATE_LIMIT=10         # API Key创建限制（每天），默认10个

# 对象复杂度限制
AUTH_MAX_OBJECT_DEPTH=10             # 最大对象深度，默认10层
AUTH_MAX_OBJECT_FIELDS=50            # 最大对象字段数，默认50个
AUTH_MAX_QUERY_PARAMS=100            # 最大查询参数数量，默认100个
AUTH_MAX_RECURSION_DEPTH=100         # 最大递归深度，默认100层

# 安全相关限制
AUTH_MAX_LOGIN_ATTEMPTS=5            # 最大登录尝试次数，默认5次
AUTH_LOGIN_LOCKOUT_MINUTES=15        # 登录锁定时长（分钟），默认15分钟
AUTH_PASSWORD_MIN_LENGTH=8           # 密码最小长度，默认8位
AUTH_PASSWORD_MAX_LENGTH=128         # 密码最大长度，默认128位

# 会话管理限制
AUTH_MAX_CONCURRENT_SESSIONS=5       # 最大并发会话数，默认5个
AUTH_SESSION_TIMEOUT_MINUTES=60      # 会话超时时间（分钟），默认60分钟

# ================================
# 兼容性说明
# ================================
# 以上环境变量与现有配置系统完全兼容
# 现有服务通过AuthConfigCompatibilityWrapper无缝访问这些配置
# 如果不设置这些环境变量，将使用上述默认值
# 
# 迁移路径：
# 1. 设置这些环境变量（可选，有合理默认值）
# 2. 现有服务自动通过兼容包装器使用新配置
# 3. 后续可逐步迁移服务到直接使用新配置接口

# ================================
# 配置验证范围
# ================================
# 所有配置值都有验证约束，确保系统安全和稳定：
# - 缓存TTL: 60-7200秒
# - 频率限制: 10-10000次
# - 字符串长度: 1000-100000字符
# - 超时时间: 1000-30000毫秒
# - API Key长度: 32-64位
# - 登录尝试: 3-20次
# - 会话数量: 1-50个
# 
# 设置超出范围的值将在应用启动时抛出验证错误