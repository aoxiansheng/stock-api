# æƒé™ä¼˜åŒ–æ–‡æ¡£

## ğŸ“‹ æ–‡æ¡£æ¦‚è¿°

æœ¬æ–‡æ¡£åŸºäºå¯¹New Stock APIç³»ç»Ÿ11ä¸ªæ§åˆ¶å™¨å…±108ä¸ªAPIç«¯ç‚¹çš„æ·±åº¦æƒé™åˆ†æï¼Œæå‡ºäº†å…¨é¢çš„æƒé™æ¶æ„ä¼˜åŒ–æ–¹æ¡ˆã€‚ç³»ç»Ÿå½“å‰é‡‡ç”¨ä¸‰å±‚æƒé™ä½“ç³»ï¼šAPI Keyè®¤è¯ã€JWTè®¤è¯å’Œå…¬å¼€è®¿é—®ï¼Œæ•´ä½“æ¶æ„åˆç†ä½†å­˜åœ¨ä¸€äº›ä¸ä¸€è‡´æ€§å’Œå®‰å…¨éšæ‚£ã€‚

## ğŸ” å½“å‰æƒé™çŠ¶å†µåˆ†æ

### æƒé™åˆ†å¸ƒç»Ÿè®¡

| æƒé™ç±»å‹ | ç«¯ç‚¹æ•°é‡ | å æ¯” | ä¸»è¦ç”¨é€” |
|---------|---------|------|----------|
| @ApiKeyAuth | 78 | 72.2% | ç¬¬ä¸‰æ–¹åº”ç”¨ã€è‡ªåŠ¨åŒ–è„šæœ¬ |
| @Auth (JWT) | 26 | 24.1% | ç®¡ç†å‘˜ã€å¼€å‘è€…ç”¨æˆ· |
| @Public | 4 | 3.7% | åŸºç¡€åŠŸèƒ½ã€å¥åº·æ£€æŸ¥ |

### API Keyæƒé™ç»†åˆ†

| æƒé™ç±»å‹ | ç«¯ç‚¹æ•°é‡ | å æ¯” | åŠŸèƒ½èŒƒå›´ |
|---------|---------|------|----------|
| SYSTEM_ADMIN | 22 | 28.2% | ç³»ç»Ÿç®¡ç†ã€å­˜å‚¨æ“ä½œã€å®‰å…¨åŠŸèƒ½ |
| CONFIG_READ | 10 | 12.8% | é…ç½®è¯»å–ã€æ˜ å°„æŸ¥çœ‹ |
| MAPPING_WRITE | 10 | 12.8% | æ˜ å°„è§„åˆ™å†™å…¥ã€é…ç½®ç®¡ç† |
| DATA_READ | 9 | 11.5% | åŸºç¡€æ•°æ®è¯»å– |
| QUERY_EXECUTE | 6 | 7.7% | æŸ¥è¯¢æ‰§è¡Œ |
| TRANSFORMER_PREVIEW | 3 | 3.8% | æ•°æ®è½¬æ¢é¢„è§ˆ |
| SYSTEM_MONITOR | 3 | 3.8% | ç³»ç»Ÿç›‘æ§ |
| PROVIDERS_READ | 4 | 5.1% | æ•°æ®æºä¿¡æ¯è¯»å– |
| SYSTEM_HEALTH | 1 | 1.3% | å¥åº·æ£€æŸ¥ |

## âš ï¸ å‘ç°çš„é—®é¢˜

### 1. æƒé™è£…é¥°å™¨ä¸å®Œæ•´

**é—®é¢˜ç«¯ç‚¹ï¼š**
- `POST /symbol-mapper/transform` - åªæœ‰@ApiKeyAuthï¼Œç¼ºå°‘@RequirePermissions
- éƒ¨åˆ†ç«¯ç‚¹æƒé™è¦æ±‚ä¸æ˜ç¡®

**å½±å“ï¼š**
- æƒé™æ§åˆ¶ä¸ä¸€è‡´
- å®‰å…¨é£é™©å¢åŠ 
- å®¡è®¡å›°éš¾

### 2. è®¤è¯ç­–ç•¥å¾…æ˜ç¡®

**é—®é¢˜æ¨¡å—ï¼š**
- **`MonitoringController`** å’Œ **`AlertController`** å½“å‰ä½¿ç”¨ `@Auth` (JWT) è®¤è¯ï¼Œä¸»è¦é¢å‘å†…éƒ¨ç®¡ç†å‘˜ã€‚è¿™ä¸éƒ¨åˆ†æ ¸å¿ƒä¸šåŠ¡æ¨¡å—ä½¿ç”¨ `@ApiKeyAuth` çš„ç­–ç•¥æœ‰æ‰€ä¸åŒã€‚
- **`AuthController`** ä¸­çš„ `getAllUsers` ç«¯ç‚¹åŠŸèƒ½å°šæœªå®ç°ï¼Œå…¶è®¤è¯æ–¹å¼å’Œæƒé™éœ€è¦æ˜ç¡®ã€‚

**å½±å“ï¼š**
- è®¤è¯ç­–ç•¥éœ€è¦æ˜ç¡®ç»Ÿä¸€ï¼Œä»¥æŒ‡å¯¼åç»­å¼€å‘å’Œé›†æˆã€‚

### 3. å…¬å¼€ç«¯ç‚¹å®‰å…¨éšæ‚£

**é—®é¢˜ç«¯ç‚¹ï¼š**
- `POST /data-mapper/field-suggestions` - @Publicè£…é¥°å™¨ï¼Œæ— é¢‘ç‡é™åˆ¶
- `GET /query/health` - å…¬å¼€è®¿é—®ï¼Œå¯èƒ½æ³„éœ²ç³»ç»Ÿä¿¡æ¯

**é£é™©ï¼š**
- æ½œåœ¨çš„DoSæ”»å‡»
- ä¿¡æ¯æ³„éœ²é£é™©
- ç¼ºå°‘è®¿é—®æ§åˆ¶

### 4. æƒé™çº§åˆ«ä¸ä¸€è‡´

**é—®é¢˜è¡¨ç°ï¼š**
- ç±»ä¼¼åŠŸèƒ½ä½¿ç”¨ä¸åŒæƒé™çº§åˆ«
- æƒé™ç»§æ‰¿å…³ç³»ä¸æ˜ç¡®
- æƒé™åˆ†é…åŸåˆ™ä¸ç»Ÿä¸€

## ğŸ¯ ä¼˜åŒ–ç›®æ ‡

### çŸ­æœŸç›®æ ‡ï¼ˆ1-2å‘¨ï¼‰
1. âœ… ä¿®å¤æƒé™è£…é¥°å™¨ä¸å®Œæ•´é—®é¢˜
2. âœ… ç»Ÿä¸€è®¤è¯æ–¹å¼
3. âœ… åŠ å¼ºå…¬å¼€ç«¯ç‚¹å®‰å…¨
4. âœ… å®Œå–„æƒé™æ–‡æ¡£

### ä¸­æœŸç›®æ ‡ï¼ˆ1ä¸ªæœˆï¼‰
1. ğŸ”„ å»ºç«‹æƒé™ç»§æ‰¿æœºåˆ¶
2. ğŸ”„ å®ç°æƒé™æ¨¡æ¿åŒ–ç®¡ç†
3. ğŸ”„ å®Œå–„æƒé™å®¡è®¡ç³»ç»Ÿ
4. ğŸ”„ ä¼˜åŒ–æƒé™æ€§èƒ½

### é•¿æœŸç›®æ ‡ï¼ˆ3ä¸ªæœˆï¼‰
1. ğŸš€ å®ç°åŠ¨æ€æƒé™åˆ†é…
2. ğŸš€ å»ºç«‹æƒé™æ²»ç†å¹³å°
3. ğŸš€ å®Œå–„åˆè§„æ€§æ”¯æŒ
4. ğŸš€ æƒé™æ™ºèƒ½æ¨è

## ğŸ“Š è¯¦ç»†æƒé™åˆ†æè¡¨

### æ‰€æœ‰APIç«¯ç‚¹æƒé™è¯¦æƒ…ï¼ˆå…±108ä¸ªç«¯ç‚¹ï¼‰

| HTTPæ–¹æ³• | è·¯å¾„ | å½“å‰æƒé™è£…é¥°å™¨ | å»ºè®®æƒé™é…ç½® | æƒé™çº§åˆ« | ç›®æ ‡ç”¨æˆ·ç¾¤ä½“ | åŠŸèƒ½æè¿° |
|---|---|---|---|---|---|---|
| **ReceiverController (1ä¸ªç«¯ç‚¹)** |
| POST | `/receiver/data` | `@ApiKeyAuth` + `@RequirePermissions(Permission.DATA_READ)` | ä¿æŒä¸å˜ | åŸºç¡€æ•°æ®è®¿é—® | ç¬¬ä¸‰æ–¹åº”ç”¨ | æ™ºèƒ½è‚¡ç¥¨æ•°æ®æ¥æ”¶ |
| **SymbolMapperController (17ä¸ªç«¯ç‚¹)** |
| GET | `/symbol-mapper/mappings` | `@ApiKeyAuth` + `@RequirePermissions(Permission.CONFIG_READ)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | è·å–æ˜ å°„è§„åˆ™åˆ—è¡¨ |
| GET | `/symbol-mapper/mappings/:id` | `@ApiKeyAuth` + `@RequirePermissions(Permission.CONFIG_READ)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | è·å–ç‰¹å®šæ˜ å°„è§„åˆ™ |
| POST | `/symbol-mapper/mappings` | `@ApiKeyAuth` + `@RequirePermissions(Permission.MAPPING_WRITE)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | åˆ›å»ºæ˜ å°„è§„åˆ™ |
| PUT | `/symbol-mapper/mappings/:id` | `@ApiKeyAuth` + `@RequirePermissions(Permission.MAPPING_WRITE)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | æ›´æ–°æ˜ å°„è§„åˆ™ |
| DELETE | `/symbol-mapper/mappings/:id` | `@ApiKeyAuth` + `@RequirePermissions(Permission.MAPPING_WRITE)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | åˆ é™¤æ˜ å°„è§„åˆ™ |
| POST | `/symbol-mapper/mappings/bulk` | `@ApiKeyAuth` + `@RequirePermissions(Permission.MAPPING_WRITE)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | æ‰¹é‡åˆ›å»ºæ˜ å°„è§„åˆ™ |
| PUT | `/symbol-mapper/mappings/bulk` | `@ApiKeyAuth` + `@RequirePermissions(Permission.MAPPING_WRITE)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | æ‰¹é‡æ›´æ–°æ˜ å°„è§„åˆ™ |
| DELETE | `/symbol-mapper/mappings/bulk` | `@ApiKeyAuth` + `@RequirePermissions(Permission.MAPPING_WRITE)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | æ‰¹é‡åˆ é™¤æ˜ å°„è§„åˆ™ |
| POST | `/symbol-mapper/transform` | `@ApiKeyAuth` | **éœ€è¦æ·»åŠ ** `@RequirePermissions(Permission.DATA_READ)` | åŸºç¡€æ•°æ®è®¿é—® | ç¬¬ä¸‰æ–¹åº”ç”¨ | ç¬¦å·æ ¼å¼è½¬æ¢ |
| GET | `/symbol-mapper/providers` | `@ApiKeyAuth` + `@RequirePermissions(Permission.CONFIG_READ)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | è·å–æä¾›å•†åˆ—è¡¨ |
| GET | `/symbol-mapper/markets` | `@ApiKeyAuth` + `@RequirePermissions(Permission.CONFIG_READ)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | è·å–å¸‚åœºåˆ—è¡¨ |
| GET | `/symbol-mapper/formats` | `@ApiKeyAuth` + `@RequirePermissions(Permission.CONFIG_READ)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | è·å–ç¬¦å·æ ¼å¼ |
| POST | `/symbol-mapper/search` | `@ApiKeyAuth` + `@RequirePermissions(Permission.CONFIG_READ)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | æœç´¢æ˜ å°„è§„åˆ™ |
| GET | `/symbol-mapper/stats` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_MONITOR)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç›‘æ§ | è¿ç»´å·¥ç¨‹å¸ˆ | è·å–ç»Ÿè®¡ä¿¡æ¯ |
| POST | `/symbol-mapper/validate` | `@ApiKeyAuth` + `@RequirePermissions(Permission.CONFIG_READ)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | éªŒè¯æ˜ å°„è§„åˆ™ |
| POST | `/symbol-mapper/export` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_ADMIN)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç®¡ç† | ç³»ç»Ÿç®¡ç†å‘˜ | å¯¼å‡ºæ˜ å°„è§„åˆ™ |
| POST | `/symbol-mapper/import` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_ADMIN)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç®¡ç† | ç³»ç»Ÿç®¡ç†å‘˜ | å¯¼å…¥æ˜ å°„è§„åˆ™ |
| **DataMapperController (16ä¸ªç«¯ç‚¹)** |
| GET | `/data-mapper/mappings` | `@ApiKeyAuth` + `@RequirePermissions(Permission.CONFIG_READ)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | è·å–å­—æ®µæ˜ å°„ |
| GET | `/data-mapper/mappings/:id` | `@ApiKeyAuth` + `@RequirePermissions(Permission.CONFIG_READ)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | è·å–ç‰¹å®šæ˜ å°„ |
| POST | `/data-mapper/mappings` | `@ApiKeyAuth` + `@RequirePermissions(Permission.MAPPING_WRITE)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | åˆ›å»ºå­—æ®µæ˜ å°„ |
| PUT | `/data-mapper/mappings/:id` | `@ApiKeyAuth` + `@RequirePermissions(Permission.MAPPING_WRITE)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | æ›´æ–°å­—æ®µæ˜ å°„ |
| DELETE | `/data-mapper/mappings/:id` | `@ApiKeyAuth` + `@RequirePermissions(Permission.MAPPING_WRITE)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | åˆ é™¤å­—æ®µæ˜ å°„ |
| POST | `/data-mapper/mappings/bulk` | `@ApiKeyAuth` + `@RequirePermissions(Permission.MAPPING_WRITE)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | æ‰¹é‡åˆ›å»ºæ˜ å°„ |
| PUT | `/data-mapper/mappings/bulk` | `@ApiKeyAuth` + `@RequirePermissions(Permission.MAPPING_WRITE)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | æ‰¹é‡æ›´æ–°æ˜ å°„ |
| DELETE | `/data-mapper/mappings/bulk` | `@ApiKeyAuth` + `@RequirePermissions(Permission.MAPPING_WRITE)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | æ‰¹é‡åˆ é™¤æ˜ å°„ |
| GET | `/data-mapper/templates` | `@ApiKeyAuth` + `@RequirePermissions(Permission.CONFIG_READ)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | è·å–æ˜ å°„æ¨¡æ¿ |
| POST | `/data-mapper/templates` | `@ApiKeyAuth` + `@RequirePermissions(Permission.MAPPING_WRITE)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | åˆ›å»ºæ˜ å°„æ¨¡æ¿ |
| GET | `/data-mapper/fields` | `@ApiKeyAuth` + `@RequirePermissions(Permission.CONFIG_READ)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | è·å–å¯ç”¨å­—æ®µ |
| POST | `/data-mapper/field-suggestions` | `@Public` | **å»ºè®®æ”¹ä¸º** `@ApiKeyAuth` + `@RequirePermissions(Permission.CONFIG_READ)` | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | å­—æ®µå»ºè®®ï¼ˆå­˜åœ¨å®‰å…¨é£é™©ï¼‰ |
| POST | `/data-mapper/analyze` | `@ApiKeyAuth` + `@RequirePermissions(Permission.CONFIG_READ)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | åˆ†ææ•°æ®ç»“æ„ |
| POST | `/data-mapper/validate` | `@ApiKeyAuth` + `@RequirePermissions(Permission.CONFIG_READ)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | éªŒè¯æ˜ å°„é…ç½® |
| GET | `/data-mapper/stats` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_MONITOR)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç›‘æ§ | è¿ç»´å·¥ç¨‹å¸ˆ | è·å–ç»Ÿè®¡ä¿¡æ¯ |
| POST | `/data-mapper/search` | `@ApiKeyAuth` + `@RequirePermissions(Permission.CONFIG_READ)` | ä¿æŒä¸å˜ | é…ç½®ç®¡ç† | ç³»ç»Ÿé›†æˆå•† | æœç´¢æ˜ å°„é…ç½® |
| **TransformerController (3ä¸ªç«¯ç‚¹)** |
| POST | `/transformer/transform` | `@ApiKeyAuth` + `@RequirePermissions(Permission.DATA_READ)` | ä¿æŒä¸å˜ | åŸºç¡€æ•°æ®è®¿é—® | ç¬¬ä¸‰æ–¹åº”ç”¨ | æ•°æ®è½¬æ¢ |
| POST | `/transformer/preview` | `@ApiKeyAuth` + `@RequirePermissions(Permission.TRANSFORMER_PREVIEW)` | ä¿æŒä¸å˜ | ä¸šåŠ¡æ“ä½œ | ä¸šåŠ¡åˆ†æå¸ˆ | è½¬æ¢é¢„è§ˆ |
| POST | `/transformer/batch` | `@ApiKeyAuth` + `@RequirePermissions(Permission.TRANSFORMER_PREVIEW)` | ä¿æŒä¸å˜ | ä¸šåŠ¡æ“ä½œ | ä¸šåŠ¡åˆ†æå¸ˆ | æ‰¹é‡è½¬æ¢ |
| **StorageController (6ä¸ªç«¯ç‚¹)** |
| POST | `/storage/store` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_ADMIN)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç®¡ç† | ç³»ç»Ÿç®¡ç†å‘˜ | å­˜å‚¨æ•°æ® |
| GET | `/storage/retrieve` | `@ApiKeyAuth` + `@RequirePermissions(Permission.DATA_READ)` | ä¿æŒä¸å˜ | åŸºç¡€æ•°æ®è®¿é—® | ç¬¬ä¸‰æ–¹åº”ç”¨ | æ£€ç´¢æ•°æ® |
| DELETE | `/storage/delete` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_ADMIN)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç®¡ç† | ç³»ç»Ÿç®¡ç†å‘˜ | åˆ é™¤æ•°æ® |
| POST | `/storage/optimize` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_ADMIN)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç®¡ç† | ç³»ç»Ÿç®¡ç†å‘˜ | ä¼˜åŒ–å­˜å‚¨ |
| GET | `/storage/stats` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_MONITOR)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç›‘æ§ | è¿ç»´å·¥ç¨‹å¸ˆ | å­˜å‚¨ç»Ÿè®¡ |
| GET | `/storage/health-check` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_HEALTH)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç›‘æ§ | è¿ç»´å·¥ç¨‹å¸ˆ | å­˜å‚¨å¥åº·æ£€æŸ¥ |
| **QueryController (7ä¸ªç«¯ç‚¹)** |
| POST | `/query/execute` | `@ApiKeyAuth` + `@RequirePermissions(Permission.QUERY_EXECUTE)` | ä¿æŒä¸å˜ | ä¸šåŠ¡æ“ä½œ | ä¸šåŠ¡åˆ†æå¸ˆ | æ‰§è¡ŒæŸ¥è¯¢ |
| POST | `/query/bulk` | `@ApiKeyAuth` + `@RequirePermissions(Permission.QUERY_EXECUTE)` | ä¿æŒä¸å˜ | ä¸šåŠ¡æ“ä½œ | ä¸šåŠ¡åˆ†æå¸ˆ | æ‰¹é‡æŸ¥è¯¢ |
| GET | `/query/symbols` | `@ApiKeyAuth` + `@RequirePermissions(Permission.QUERY_EXECUTE)` | ä¿æŒä¸å˜ | ä¸šåŠ¡æ“ä½œ | ä¸šåŠ¡åˆ†æå¸ˆ | æŒ‰ç¬¦å·æŸ¥è¯¢ |
| GET | `/query/market` | `@ApiKeyAuth` + `@RequirePermissions(Permission.QUERY_EXECUTE)` | ä¿æŒä¸å˜ | ä¸šåŠ¡æ“ä½œ | ä¸šåŠ¡åˆ†æå¸ˆ | æŒ‰å¸‚åœºæŸ¥è¯¢ |
| GET | `/query/provider` | `@ApiKeyAuth` + `@RequirePermissions(Permission.QUERY_EXECUTE)` | ä¿æŒä¸å˜ | ä¸šåŠ¡æ“ä½œ | ä¸šåŠ¡åˆ†æå¸ˆ | æŒ‰æä¾›å•†æŸ¥è¯¢ |
| GET | `/query/stats` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_MONITOR)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç›‘æ§ | è¿ç»´å·¥ç¨‹å¸ˆ | æŸ¥è¯¢ç»Ÿè®¡ |
| GET | `/query/health` | `@Public` | **å»ºè®®æ”¹ä¸º** `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_HEALTH)` | ç³»ç»Ÿç›‘æ§ | è¿ç»´å·¥ç¨‹å¸ˆ | æŸ¥è¯¢å¥åº·æ£€æŸ¥ï¼ˆå­˜åœ¨ä¿¡æ¯æ³„éœ²é£é™©ï¼‰ |
| **AuthController (9ä¸ªç«¯ç‚¹)** |
| POST | `/auth/register` | `@Public` | ä¿æŒä¸å˜ | å…¬å¼€è®¿é—® | æ‰€æœ‰ç”¨æˆ· | ç”¨æˆ·æ³¨å†Œ |
| POST | `/auth/login` | `@Public` | ä¿æŒä¸å˜ | å…¬å¼€è®¿é—® | æ‰€æœ‰ç”¨æˆ· | ç”¨æˆ·ç™»å½• |
| GET | `/auth/profile` | `@Auth` | ä¿æŒä¸å˜ | JWTè®¤è¯ | å¼€å‘è€…/ç®¡ç†å‘˜ | è·å–ç”¨æˆ·ä¿¡æ¯ |
| POST | `/auth/api-keys` | `@Auth` | ä¿æŒä¸å˜ | JWTè®¤è¯ | å¼€å‘è€…/ç®¡ç†å‘˜ | åˆ›å»ºAPIå¯†é’¥ |
| GET | `/auth/api-keys` | `@Auth` | ä¿æŒä¸å˜ | JWTè®¤è¯ | å¼€å‘è€…/ç®¡ç†å‘˜ | è·å–APIå¯†é’¥åˆ—è¡¨ |
| DELETE | `/auth/api-keys/:appKey` | `@Auth` | ä¿æŒä¸å˜ | JWTè®¤è¯ | å¼€å‘è€…/ç®¡ç†å‘˜ | æ’¤é”€APIå¯†é’¥ |
| GET | `/auth/api-keys/:appKey/usage` | `@Auth` | ä¿æŒä¸å˜ | JWTè®¤è¯ | å¼€å‘è€…/ç®¡ç†å‘˜ | APIå¯†é’¥ä½¿ç”¨ç»Ÿè®¡ |
| POST | `/auth/api-keys/:appKey/reset-rate-limit` | `@Auth` | ä¿æŒä¸å˜ | JWTè®¤è¯ | å¼€å‘è€…/ç®¡ç†å‘˜ | é‡ç½®é¢‘ç‡é™åˆ¶ |
| GET | `/auth/users` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_ADMIN)` | **å»ºè®®æ”¹ä¸º** `@Auth([UserRole.ADMIN])` | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | è·å–æ‰€æœ‰ç”¨æˆ· |
| **MonitoringController (12ä¸ªç«¯ç‚¹)** |
| GET | `/monitoring/performance` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | æ€§èƒ½æŒ‡æ ‡ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| GET | `/monitoring/endpoints` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | ç«¯ç‚¹æŒ‡æ ‡ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| GET | `/monitoring/database` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | æ•°æ®åº“æŒ‡æ ‡ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| GET | `/monitoring/redis` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | RedisæŒ‡æ ‡ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| GET | `/monitoring/system` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | ç³»ç»ŸæŒ‡æ ‡ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| GET | `/monitoring/health` | `@Public` | ä¿æŒä¸å˜ | å…¬å¼€è®¿é—® | æ‰€æœ‰ç”¨æˆ· | åŸºç¡€å¥åº·æ£€æŸ¥ |
| GET | `/monitoring/health/detailed` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_MONITOR)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç›‘æ§ | è¿ç»´å·¥ç¨‹å¸ˆ | è¯¦ç»†å¥åº·çŠ¶æ€ |
| GET | `/monitoring/cache` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | ç¼“å­˜æŒ‡æ ‡ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| GET | `/monitoring/optimization/recommendations` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | ä¼˜åŒ–å»ºè®®ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| GET | `/monitoring/dashboard` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | ä»ªè¡¨æ¿æ•°æ®ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| GET | `/monitoring/metrics-health` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | æŒ‡æ ‡ç³»ç»Ÿå¥åº·ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| GET | `/monitoring/metrics-health/check` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | æ‰‹åŠ¨å¥åº·æ£€æŸ¥ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| **AlertController (16ä¸ªç«¯ç‚¹)** |
| POST | `/alerts/rules` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | åˆ›å»ºå‘Šè­¦è§„åˆ™ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| GET | `/alerts/rules` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | è·å–æ‰€æœ‰å‘Šè­¦è§„åˆ™ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| GET | `/alerts/rules/:ruleId` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | æ ¹æ®IDè·å–å‘Šè­¦è§„åˆ™ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| PUT | `/alerts/rules/:ruleId` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | æ›´æ–°å‘Šè­¦è§„åˆ™ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| DELETE | `/alerts/rules/:ruleId` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | åˆ é™¤å‘Šè­¦è§„åˆ™ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| POST | `/alerts/rules/:ruleId/toggle` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | å¯ç”¨/ç¦ç”¨å‘Šè­¦è§„åˆ™ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| GET | `/alerts/active` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | è·å–æ´»è·ƒå‘Šè­¦ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| GET | `/alerts/history` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | æŸ¥è¯¢å‘Šè­¦å†å²ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| GET | `/alerts/stats` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | è·å–å‘Šè­¦ç»Ÿè®¡ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| GET | `/alerts/:alertId` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | æ ¹æ®IDè·å–å‘Šè­¦è¯¦æƒ…ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| POST | `/alerts/:alertId/acknowledge` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | ç¡®è®¤å‘Šè­¦ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| POST | `/alerts/:alertId/resolve` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | è§£å†³å‘Šè­¦ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| POST | `/alerts/channels/test` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | æµ‹è¯•é€šçŸ¥æ¸ é“ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| POST | `/alerts/trigger` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | æ‰‹åŠ¨è§¦å‘å‘Šè­¦è¯„ä¼°ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| POST | `/alerts/batch/acknowledge` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | æ‰¹é‡ç¡®è®¤å‘Šè­¦ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| POST | `/alerts/batch/resolve` | `@Auth([UserRole.ADMIN])` | ä¿æŒä¸å˜ | JWTè®¤è¯ | ç³»ç»Ÿç®¡ç†å‘˜ | æ‰¹é‡è§£å†³å‘Šè­¦ï¼ˆå†…éƒ¨ç®¡ç†ï¼‰ |
| **SecurityController (10ä¸ªç«¯ç‚¹)** |
| POST | `/security/scan` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_ADMIN)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç®¡ç† | ç³»ç»Ÿç®¡ç†å‘˜ | æ‰§è¡Œå®‰å…¨æ‰«æ |
| GET | `/security/scan/history` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_ADMIN)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç®¡ç† | ç³»ç»Ÿç®¡ç†å‘˜ | è·å–å®‰å…¨æ‰«æå†å² |
| GET | `/security/vulnerabilities` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_ADMIN)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç®¡ç† | ç³»ç»Ÿç®¡ç†å‘˜ | è·å–å®‰å…¨æ¼æ´åˆ—è¡¨ |
| GET | `/security/configuration` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_ADMIN)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç®¡ç† | ç³»ç»Ÿç®¡ç†å‘˜ | è·å–å®‰å…¨é…ç½® |
| GET | `/security/audit/events` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_ADMIN)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç®¡ç† | ç³»ç»Ÿç®¡ç†å‘˜ | è·å–å®‰å…¨å®¡è®¡äº‹ä»¶ |
| POST | `/security/manual-events` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_ADMIN)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç®¡ç† | ç³»ç»Ÿç®¡ç†å‘˜ | æ‰‹åŠ¨è®°å½•å®‰å…¨äº‹ä»¶ |
| GET | `/security/audit/report` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_ADMIN)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç®¡ç† | ç³»ç»Ÿç®¡ç†å‘˜ | ç”Ÿæˆå®‰å…¨å®¡è®¡æŠ¥å‘Š |
| GET | `/security/suspicious-ips` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_ADMIN)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç®¡ç† | ç³»ç»Ÿç®¡ç†å‘˜ | è·å–å¯ç–‘IPåˆ—è¡¨ |
| POST | `/security/suspicious-ips/:ip/clear` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_ADMIN)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç®¡ç† | ç³»ç»Ÿç®¡ç†å‘˜ | æ¸…é™¤å¯ç–‘IPæ ‡è®° |
| GET | `/security/dashboard` | `@ApiKeyAuth` + `@RequirePermissions(Permission.SYSTEM_ADMIN)` | ä¿æŒä¸å˜ | ç³»ç»Ÿç®¡ç† | ç³»ç»Ÿç®¡ç†å‘˜ | è·å–å®‰å…¨ä»ªè¡¨æ¿æ•°æ® |
| **ProvidersController (4ä¸ªç«¯ç‚¹)** |
| GET | `/providers/capabilities` | `@ApiKeyAuth` + `@RequirePermissions(Permission.PROVIDERS_READ)` | ä¿æŒä¸å˜ | åŸºç¡€æ•°æ®è®¿é—® | ç¬¬ä¸‰æ–¹åº”ç”¨ | è·å–æ‰€æœ‰å¯ç”¨èƒ½åŠ› |
| GET | `/providers/best-provider/:capability` | `@ApiKeyAuth` + `@RequirePermissions(Permission.PROVIDERS_READ)` | ä¿æŒä¸å˜ | åŸºç¡€æ•°æ®è®¿é—® | ç¬¬ä¸‰æ–¹åº”ç”¨ | è·å–æŒ‡å®šèƒ½åŠ›çš„æœ€ä½³æä¾›å•† |
| GET | `/providers/best-provider/:capability/:market` | `@ApiKeyAuth` + `@RequirePermissions(Permission.PROVIDERS_READ)` | ä¿æŒä¸å˜ | åŸºç¡€æ•°æ®è®¿é—® | ç¬¬ä¸‰æ–¹åº”ç”¨ | è·å–æŒ‡å®šèƒ½åŠ›çš„æœ€ä½³æä¾›å•†ï¼ˆæŒ‡å®šå¸‚åœºï¼‰ |
| GET | `/providers/:provider/capabilities` | `@ApiKeyAuth` + `@RequirePermissions(Permission.PROVIDERS_READ)` | ä¿æŒä¸å˜ | åŸºç¡€æ•°æ®è®¿é—® | ç¬¬ä¸‰æ–¹åº”ç”¨ | è·å–æŒ‡å®šæä¾›å•†çš„èƒ½åŠ›åˆ—è¡¨ |

### ğŸ” å…³é”®å‘ç°

#### éœ€è¦ç«‹å³ä¿®å¤çš„ç«¯ç‚¹ï¼ˆ2ä¸ªï¼‰
1. **POST** `/api/v1/symbol-mapper/transform` - ç¼ºå°‘`@RequirePermissions`è£…é¥°å™¨
2. **POST** `/api/v1/data-mapper/field-suggestions` - å…¬å¼€è®¿é—®å­˜åœ¨å®‰å…¨é£é™©

#### å­˜åœ¨ä¿¡æ¯æ³„éœ²é£é™©çš„ç«¯ç‚¹ï¼ˆ1ä¸ªï¼‰
1. **GET** `/api/v1/query/health` - å…¬å¼€è®¿é—®å¯èƒ½æ³„éœ²ç³»ç»Ÿä¿¡æ¯

#### è®¤è¯ç­–ç•¥æ˜ç¡®æ€§
- **MonitoringController** å’Œ **AlertController** æ­£ç¡®ä½¿ç”¨ `@Auth([UserRole.ADMIN])` è¿›è¡Œå†…éƒ¨ç®¡ç†
- **AuthController** ä¸­çš„ `getAllUsers` ç«¯ç‚¹åŠŸèƒ½å¾…å®ç°ï¼Œæƒé™è®¾ç½®æ­£ç¡®

## ğŸ“‹ ä¼˜åŒ–è§„åˆ’è¿›åº¦

### ç¬¬ä¸€é˜¶æ®µï¼šåŸºç¡€å®‰å…¨ä¿®å¤ï¼ˆç¬¬1-2å‘¨ï¼‰ğŸ”§

æœ¬é˜¶æ®µåŒ…å«ä¸‰ä¸ªå…³é”®å­ä»»åŠ¡ï¼Œéœ€è¦å¹¶è¡Œæ¨è¿›ä»¥å¿«é€Ÿæ¶ˆé™¤å½“å‰å®‰å…¨éšæ‚£ï¼š

#### 1.1 æƒé™è£…é¥°å™¨æ ‡å‡†åŒ–

**é—®é¢˜åˆ†æï¼š** å½“å‰éƒ¨åˆ†ç«¯ç‚¹æƒé™è£…é¥°å™¨ä¸å®Œæ•´ï¼Œå­˜åœ¨å®‰å…¨éšæ‚£ã€‚

**è§£å†³æ–¹æ¡ˆï¼š**

**1. ä¿®å¤Symbol Mapper Controller** âœ… å·²å®Œæˆ
```typescript
// å½“å‰ä»£ç  (æœ‰é—®é¢˜)
@Post('transform')
@ApiKeyAuth()
async transformSymbols(@Body() dto: TransformSymbolsDto) {
  return await this.symbolMapperService.transformSymbols(dto);
}

// ä¼˜åŒ–åä»£ç  âœ… å·²ä¿®å¤
@Post('transform')
@ApiKeyAuth()
@RequirePermissions(Permission.DATA_READ)
async transformSymbols(@Body() dto: TransformSymbolsDto) {
  return await this.symbolMapperService.transformSymbols(dto);
}
```

**2. å»ºç«‹æƒé™è£…é¥°å™¨æ£€æŸ¥è§„åˆ™** âœ… å·²å®Œæˆ
```typescript
// âœ… å·²å®ç°æƒé™è£…é¥°å™¨éªŒè¯å·¥å…·
// ä½ç½®: src/permission/validators/permission-decorator.validator.ts
@Injectable()
export class PermissionDecoratorValidator {
  async validateAllControllers(): Promise<ValidationResult[]> {
    // è‡ªåŠ¨æ£€æŸ¥æ‰€æœ‰æ§åˆ¶å™¨çš„æƒé™è£…é¥°å™¨ä½¿ç”¨è§„èŒƒ
  }
}

// âœ… å·²å®ç°æƒé™éªŒè¯æœåŠ¡
// ä½ç½®: src/permission/services/permission-validation.service.ts
@Injectable()
export class PermissionValidationService implements OnModuleInit {
  async onModuleInit() {
    // åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨éªŒè¯æƒé™è£…é¥°å™¨
  }
}
```

**3. æƒé™è£…é¥°å™¨æœ€ä½³å®è·µ** âœ… å·²å®ç°
```typescript
// æ¨èçš„æƒé™è£…é¥°å™¨ç»„åˆæ¨¡å¼

// æ¨¡å¼1: API Keyè®¤è¯ + ç‰¹å®šæƒé™
@ApiKeyAuth()
@RequirePermissions(Permission.DATA_READ)

// æ¨¡å¼2: JWTè®¤è¯ + è§’è‰²è¦æ±‚
@Auth([UserRole.ADMIN])

// æ¨¡å¼3: å…¬å¼€è®¿é—® + é¢‘ç‡é™åˆ¶ (å·²ä¼˜åŒ–ä¸ºè®¤è¯è®¿é—®)
@ApiKeyAuth()
@RequirePermissions(Permission.CONFIG_READ)
@UseGuards(ThrottlerGuard)
@Throttle({ default: { limit: 30, ttl: 60000 } })

```

#### 1.2 è®¤è¯æ–¹å¼ä¸ç­–ç•¥æ˜ç¡®åŒ–

**é—®é¢˜åˆ†æï¼š**
ä¸åŒæ¨¡å—çš„è®¤è¯æ–¹å¼éœ€è¦ä¸€ä¸ªæ¸…æ™°ã€ç»Ÿä¸€çš„é¡¶å±‚è®¾è®¡åŸåˆ™ï¼Œä»¥ç¡®ä¿ç³»ç»Ÿæ¶æ„çš„ä¸€è‡´æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚

#### è§£å†³æ–¹æ¡ˆ

**1. å»ºç«‹ç»Ÿä¸€è®¤è¯ç­–ç•¥**

æ ¹æ®æœ€æ–°çš„æŒ‡ä»¤ï¼Œæˆ‘ä»¬æ˜ç¡®ç³»ç»Ÿçš„è®¤è¯ç­–ç•¥å¦‚ä¸‹ï¼š

- **æ ¸å¿ƒä¸šåŠ¡ä¸è‡ªåŠ¨åŒ–æ¨¡å— (`@ApiKeyAuth`)**:
  - **ç›®æ ‡**: ä¸»è¦æœåŠ¡äºç¬¬ä¸‰æ–¹åº”ç”¨ã€è‡ªåŠ¨åŒ–è„šæœ¬å’Œç¨‹åºåŒ–è®¿é—®ã€‚
  - **åŒ…å«æ¨¡å—**: `Receiver`, `SymbolMapper`, `DataMapper`, `Transformer`, `Query`, `Storage`, `Security`, `Providers`ã€‚
  - **è¦æ±‚**: **å¿…é¡»**ä½¿ç”¨ `@ApiKeyAuth()` å¹¶é…åˆ `@RequirePermissions()` æŒ‡å®šå…·ä½“æƒé™ã€‚

- **å†…éƒ¨ç®¡ç†ä¸ç›‘æ§æ¨¡å— (`@Auth`)**:
  - **ç›®æ ‡**: ä¸»è¦æœåŠ¡äºå†…éƒ¨ç®¡ç†å‘˜å’Œå¼€å‘è€…é€šè¿‡Webç•Œé¢è¿›è¡Œçš„æ“ä½œã€‚
  - **åŒ…å«æ¨¡å—**: `AlertController`, `MonitoringController`ã€‚
  - **è¦æ±‚**: ä½¿ç”¨ `@Auth([UserRole.ADMIN])` æˆ– `@Auth([UserRole.DEVELOPER])` è¿›è¡ŒåŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ã€‚è¿™ç§æ–¹å¼ç¬¦åˆå…¶ä½œä¸ºå†…éƒ¨ç®¡ç†å·¥å…·çš„å®šä½ã€‚

- **ç”¨æˆ·èº«ä»½è®¤è¯æ¨¡å— (`@Auth` / `@Public`)**:
  - **ç›®æ ‡**: å¤„ç†ç”¨æˆ·è‡ªèº«çš„æ³¨å†Œã€ç™»å½•å’Œä¿¡æ¯ç®¡ç†ã€‚
  - **åŒ…å«æ¨¡å—**: `AuthController`ã€‚
  - **è¦æ±‚**:
    - ç™»å½•/æ³¨å†Œæ¥å£ä½¿ç”¨ `@Public()`ã€‚
    - ç”¨æˆ·ä¸ªäººä¿¡æ¯ã€API Keyç®¡ç†ç­‰æ¥å£ä½¿ç”¨ `@Auth()`ã€‚
    - **`getAllUsers` æ¥å£**ï¼šæ­¤æ¥å£åº”ä½œä¸ºç®¡ç†å‘˜åŠŸèƒ½ï¼Œä½¿ç”¨ `@Auth([UserRole.ADMIN])`ï¼Œå¹¶éœ€è¦å®Œæˆå…¶ä¸šåŠ¡é€»è¾‘çš„å®ç°ã€‚

**2. è®¤è¯ç­–ç•¥æ˜ å°„è¡¨ï¼ˆæ›´æ–°åï¼‰**

```typescript
const CONTROLLER_AUTH_STRATEGY = {
  // æ ¸å¿ƒä¸šåŠ¡æ¨¡å— - API Keyè®¤è¯
  'ReceiverController': AuthenticationStrategy.API_KEY_ACCESS,
  'SymbolMapperController': AuthenticationStrategy.API_KEY_ACCESS,
  'DataMapperController': AuthenticationStrategy.API_KEY_ACCESS,
  'TransformerController': AuthenticationStrategy.API_KEY_ACCESS,
  'StorageController': AuthenticationStrategy.API_KEY_ACCESS,
  'QueryController': AuthenticationStrategy.API_KEY_ACCESS,
  'ProvidersController': AuthenticationStrategy.API_KEY_ACCESS,
  'SecurityController': AuthenticationStrategy.API_KEY_ACCESS,
  
  // å†…éƒ¨ç®¡ç†æ¨¡å— - JWTè®¤è¯
  'MonitoringController': AuthenticationStrategy.JWT_ACCESS,
  'AlertController': AuthenticationStrategy.JWT_ACCESS,
  
  // ç”¨æˆ·ç®¡ç†æ¨¡å— - JWTè®¤è¯
  'AuthController': AuthenticationStrategy.JWT_ACCESS,
};
```

#### 1.3 å…¬å¼€ç«¯ç‚¹å®‰å…¨åŠ å¼º

**é—®é¢˜åˆ†æï¼š**
å…¬å¼€ç«¯ç‚¹ç¼ºå°‘å¿…è¦çš„å®‰å…¨æ§åˆ¶ï¼Œå­˜åœ¨æ½œåœ¨é£é™©ã€‚

#### è§£å†³æ–¹æ¡ˆ

**1. å…¬å¼€ç«¯ç‚¹é¢‘ç‡é™åˆ¶** âœ… å·²å®Œæˆ
```typescript
// å½“å‰ä»£ç  (æ— ä¿æŠ¤)
@Post('field-suggestions')
@Public()
async getFieldSuggestions(@Body() dto: FieldSuggestionsDto) { }

// ä¼˜åŒ–åä»£ç  âœ… å·²ä¿®å¤ - æ”¹ä¸ºè®¤è¯è®¿é—®å¹¶æ·»åŠ é¢‘ç‡é™åˆ¶
@ApiKeyAuth()
@RequirePermissions(Permission.CONFIG_READ)
@UseGuards(ThrottlerGuard)
@Throttle({ default: { limit: 30, ttl: 60000 } })
@Post('field-suggestions')
async getFieldSuggestions(@Body() dto: FieldSuggestionsDto) { }
```

**2. å¥åº·æ£€æŸ¥ç«¯ç‚¹ä¼˜åŒ–** âœ… å·²å®Œæˆ
```typescript
// å½“å‰ä»£ç  (å¯èƒ½æ³„éœ²ä¿¡æ¯)
@Get('health')
@Public()
async checkHealth() {
  return await this.queryService.getHealthStatus();
}

// ä¼˜åŒ–åä»£ç  âœ… å·²ä¿®å¤ - æ”¹ä¸ºè®¤è¯è®¿é—®å¹¶è¿‡æ»¤æ•æ„Ÿä¿¡æ¯
@ApiKeyAuth()
@RequirePermissions(Permission.SYSTEM_HEALTH)
@UseGuards(ThrottlerGuard)
@Throttle({ default: { limit: 60, ttl: 60000 } })
@Get('health')
async checkHealth() {
  const health = await this.queryService.getHealthStatus();
  // è¿‡æ»¤æ•æ„Ÿä¿¡æ¯ï¼Œåªè¿”å›åŸºç¡€å¥åº·çŠ¶æ€
  return {
    queryService: {
      available: health.queryService.available,
      latency: health.queryService.latency,
    },
    overallHealth: {
      healthy: health.overallHealth.healthy,
      timestamp: new Date().toISOString(),
    },
  };
}
```

**3. å»ºç«‹å…¬å¼€ç«¯ç‚¹å®‰å…¨ç­–ç•¥** âœ… å·²å®ç°
```typescript
// âœ… å·²å®ç° - å…¬å¼€ç«¯ç‚¹å·²æ”¹ä¸ºè®¤è¯è®¿é—®
// æ‰€æœ‰åŸå…¬å¼€ç«¯ç‚¹ç°åœ¨éƒ½è¦æ±‚é€‚å½“çš„API Keyè®¤è¯å’Œæƒé™
// é¢‘ç‡é™åˆ¶é€šè¿‡ @Throttle è£…é¥°å™¨å®ç°
// æ•æ„Ÿä¿¡æ¯é€šè¿‡ä¸šåŠ¡é€»è¾‘è¿‡æ»¤

// å½“å‰å®‰å…¨ç­–ç•¥:
// 1. ç§»é™¤ä¸å¿…è¦çš„å…¬å¼€ç«¯ç‚¹
// 2. ä¸ºæ‰€æœ‰ç«¯ç‚¹æ·»åŠ é€‚å½“çš„è®¤è¯è¦æ±‚
// 3. å®æ–½é¢‘ç‡é™åˆ¶ä¿æŠ¤
// 4. è¿‡æ»¤è¿”å›æ•°æ®ä¸­çš„æ•æ„Ÿä¿¡æ¯
```

#### ç¬¬ä¸€é˜¶æ®µå®æ–½è®¡åˆ’ âœ… å·²å®Œæˆ
- **ç¬¬1å‘¨**ï¼š
  - âœ… ä¿®å¤Symbol Mapper Controlleræƒé™è£…é¥°å™¨
  - âœ… æŒ‰ç…§ç»Ÿä¸€è®¤è¯ç­–ç•¥å®¡æŸ¥æ‰€æœ‰æ§åˆ¶å™¨
  - âœ… ä¸ºæ‰€æœ‰å…¬å¼€ç«¯ç‚¹æ·»åŠ é¢‘ç‡é™åˆ¶ï¼ˆæ”¹ä¸ºè®¤è¯è®¿é—®ï¼‰
- **ç¬¬2å‘¨**ï¼š
  - âœ… å®æ–½æƒé™è£…é¥°å™¨éªŒè¯å·¥å…·ï¼ˆç‹¬ç«‹ä¸ºpermissionç»„ä»¶ï¼‰
  - âœ… å®ŒæˆAuthControllerä¸­getAllUsersç«¯ç‚¹å¼€å‘
  - âœ… å®æ–½æ•æ„Ÿä¿¡æ¯è¿‡æ»¤å’Œå…¬å¼€ç«¯ç‚¹å®‰å…¨ç­–ç•¥

#### ç¬¬ä¸€é˜¶æ®µæˆæœæ€»ç»“ âœ…

**1. æƒé™è£…é¥°å™¨æ ‡å‡†åŒ–**
- ä¿®å¤äº† `POST /symbol-mapper/transform` ç¼ºå¤±çš„ `@RequirePermissions` è£…é¥°å™¨
- å»ºç«‹äº†å®Œå–„çš„æƒé™è£…é¥°å™¨éªŒè¯å·¥å…·ï¼Œä½äº `src/permission/` ç‹¬ç«‹ç»„ä»¶
- åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨éªŒè¯æ‰€æœ‰æ§åˆ¶å™¨çš„æƒé™è£…é¥°å™¨ä½¿ç”¨è§„èŒƒ

**2. å…¬å¼€ç«¯ç‚¹å®‰å…¨åŠ å¼º**
- å°† `POST /data-mapper/field-suggestions` ä»å…¬å¼€è®¿é—®æ”¹ä¸ºAPI Keyè®¤è¯
- å°† `GET /query/health` ä»å…¬å¼€è®¿é—®æ”¹ä¸ºAPI Keyè®¤è¯ï¼Œå¹¶è¿‡æ»¤æ•æ„Ÿä¿¡æ¯
- ä¸ºæ‰€æœ‰éœ€è¦ä¿æŠ¤çš„ç«¯ç‚¹æ·»åŠ äº†é¢‘ç‡é™åˆ¶

**3. ç”¨æˆ·ç®¡ç†åŠŸèƒ½å®Œå–„**
- å®Œæˆäº† `GET /auth/users` ç«¯ç‚¹çš„å®Œæ•´å¼€å‘
- ä½¿ç”¨æ­£ç¡®çš„JWTè®¤è¯æ–¹å¼ï¼ˆ@Auth([UserRole.ADMIN])ï¼‰
- æä¾›åˆ†é¡µæŸ¥è¯¢ã€ç”¨æˆ·ç»Ÿè®¡ç­‰å®Œæ•´åŠŸèƒ½

**4. æƒé™éªŒè¯ç»„ä»¶åŒ–**
- å°†æƒé™éªŒè¯å·¥å…·ä» `src/common/` è½¬ç§»åˆ°ç‹¬ç«‹çš„ `src/permission/` ç»„ä»¶
- åŒ…å«éªŒè¯å™¨ã€æœåŠ¡å’Œæ¨¡å—çš„å®Œæ•´æ¶æ„
- æ”¯æŒè‡ªåŠ¨éªŒè¯ã€æŠ¥å‘Šç”Ÿæˆå’Œä½¿ç”¨æŒ‡å—


  

### ç¬¬äºŒé˜¶æ®µï¼šæƒé™ç»§æ‰¿ä¸çº§åˆ«æ ‡å‡†åŒ–ï¼ˆç¬¬3-4å‘¨ï¼‰ğŸ“Š

#### é—®é¢˜åˆ†æ
æƒé™çº§åˆ«åˆ†é…ä¸ä¸€è‡´ï¼Œç¼ºå°‘æ¸…æ™°çš„æƒé™åˆ†å±‚ä½“ç³»ã€‚

#### è§£å†³æ–¹æ¡ˆ

**1. å»ºç«‹æƒé™å±‚çº§ä½“ç³»**
```typescript
// æƒé™å±‚çº§å®šä¹‰
export enum PermissionLevel {
  // çº§åˆ«1: åŸºç¡€æ•°æ®æƒé™ (æœ€ä½æƒé™)
  BASIC_DATA = 1,
  
  // çº§åˆ«2: ä¸šåŠ¡æ“ä½œæƒé™  
  BUSINESS_OPERATION = 2,
  
  // çº§åˆ«3: é…ç½®ç®¡ç†æƒé™
  CONFIGURATION = 3,
  
  // çº§åˆ«4: ç³»ç»Ÿç›‘æ§æƒé™
  SYSTEM_MONITORING = 4,
  
  // çº§åˆ«5: ç³»ç»Ÿç®¡ç†æƒé™ (æœ€é«˜æƒé™)
  SYSTEM_ADMINISTRATION = 5
}

// æƒé™åˆ†çº§æ˜ å°„
export const PERMISSION_HIERARCHY = {
  // çº§åˆ«1: åŸºç¡€æ•°æ®æƒé™
  [PermissionLevel.BASIC_DATA]: [
    Permission.DATA_READ,
    Permission.PROVIDERS_READ,
    Permission.QUERY_EXECUTE
  ],
  
  // çº§åˆ«2: ä¸šåŠ¡æ“ä½œæƒé™
  [PermissionLevel.BUSINESS_OPERATION]: [
    Permission.TRANSFORMER_PREVIEW,
    Permission.QUERY_STATS,
    Permission.QUERY_HEALTH
  ],
  
  // çº§åˆ«3: é…ç½®ç®¡ç†æƒé™
  [PermissionLevel.CONFIGURATION]: [
    Permission.CONFIG_READ,
    Permission.CONFIG_WRITE,
    Permission.MAPPING_WRITE
  ],
  
  // çº§åˆ«4: ç³»ç»Ÿç›‘æ§æƒé™
  [PermissionLevel.SYSTEM_MONITORING]: [
    Permission.SYSTEM_MONITOR,
    Permission.SYSTEM_METRICS,
    Permission.SYSTEM_HEALTH,
    Permission.DEBUG_ACCESS
  ],
  
  // çº§åˆ«5: ç³»ç»Ÿç®¡ç†æƒé™
  [PermissionLevel.SYSTEM_ADMINISTRATION]: [
    Permission.SYSTEM_ADMIN,
    Permission.USER_MANAGE,
    Permission.APIKEY_MANAGE,
    Permission.DATA_WRITE,
    Permission.PROVIDERS_MANAGE
  ]
};
```

**2. æƒé™ç»§æ‰¿æœºåˆ¶**
```typescript
// æƒé™ç»§æ‰¿æœåŠ¡
@Injectable()
export class PermissionInheritanceService {
  /**
   * è·å–ç”¨æˆ·çš„æ‰€æœ‰æœ‰æ•ˆæƒé™ï¼ˆåŒ…æ‹¬ç»§æ‰¿æƒé™ï¼‰
   */
  getEffectivePermissions(userPermissions: Permission[]): Permission[] {
    const effectivePermissions = new Set(userPermissions);
    
    // è®¡ç®—æœ€é«˜æƒé™çº§åˆ«
    const maxLevel = this.getMaxPermissionLevel(userPermissions);
    
    // æ·»åŠ æ‰€æœ‰è¾ƒä½çº§åˆ«çš„æƒé™
    for (let level = 1; level <= maxLevel; level++) {
      const levelPermissions = PERMISSION_HIERARCHY[level] || [];
      levelPermissions.forEach(permission => {
        effectivePermissions.add(permission);
      });
    }
    
    return Array.from(effectivePermissions);
  }
  
  private getMaxPermissionLevel(permissions: Permission[]): number {
    let maxLevel = 0;
    
    for (const permission of permissions) {
      for (const [level, levelPermissions] of Object.entries(PERMISSION_HIERARCHY)) {
        if (levelPermissions.includes(permission)) {
          maxLevel = Math.max(maxLevel, parseInt(level));
        }
      }
    }
    
    return maxLevel;
  }
}
```

**3. æƒé™æ¨¡æ¿åŒ–ç®¡ç†**
```typescript
// é¢„å®šä¹‰æƒé™æ¨¡æ¿
export const PERMISSION_TEMPLATES = {
  // æ•°æ®è®¿é—®è€…æ¨¡æ¿
  DATA_CONSUMER: {
    name: 'æ•°æ®è®¿é—®è€…',
    description: 'åŸºç¡€æ•°æ®è¯»å–å’ŒæŸ¥è¯¢æƒé™',
    permissions: [
      Permission.DATA_READ,
      Permission.QUERY_EXECUTE,
      Permission.PROVIDERS_READ
    ],
    level: PermissionLevel.BASIC_DATA
  },
  
  // ä¸šåŠ¡åˆ†æå¸ˆæ¨¡æ¿
  BUSINESS_ANALYST: {
    name: 'ä¸šåŠ¡åˆ†æå¸ˆ',
    description: 'æ•°æ®è®¿é—® + è½¬æ¢é¢„è§ˆæƒé™',
    permissions: [
      Permission.DATA_READ,
      Permission.QUERY_EXECUTE,
      Permission.PROVIDERS_READ,
      Permission.TRANSFORMER_PREVIEW,
      Permission.QUERY_STATS
    ],
    level: PermissionLevel.BUSINESS_OPERATION
  },
  
  // ç³»ç»Ÿé›†æˆå•†æ¨¡æ¿
  SYSTEM_INTEGRATOR: {
    name: 'ç³»ç»Ÿé›†æˆå•†',
    description: 'é…ç½®ç®¡ç†å’Œæ˜ å°„æƒé™',
    permissions: [
      Permission.DATA_READ,
      Permission.QUERY_EXECUTE,
      Permission.CONFIG_READ,
      Permission.CONFIG_WRITE,
      Permission.MAPPING_WRITE
    ],
    level: PermissionLevel.CONFIGURATION
  },
  
  // è¿ç»´å·¥ç¨‹å¸ˆæ¨¡æ¿
  OPERATIONS_ENGINEER: {
    name: 'è¿ç»´å·¥ç¨‹å¸ˆ',
    description: 'ç³»ç»Ÿç›‘æ§å’Œå¥åº·æ£€æŸ¥æƒé™',
    permissions: [
      Permission.SYSTEM_MONITOR,
      Permission.SYSTEM_METRICS,
      Permission.SYSTEM_HEALTH,
      Permission.DEBUG_ACCESS
    ],
    level: PermissionLevel.SYSTEM_MONITORING
  },
  
  // ç³»ç»Ÿç®¡ç†å‘˜æ¨¡æ¿
  SYSTEM_ADMINISTRATOR: {
    name: 'ç³»ç»Ÿç®¡ç†å‘˜',
    description: 'å®Œæ•´ç³»ç»Ÿç®¡ç†æƒé™',
    permissions: [
      Permission.SYSTEM_ADMIN,
      Permission.USER_MANAGE,
      Permission.APIKEY_MANAGE,
      Permission.DATA_WRITE,
      Permission.PROVIDERS_MANAGE
    ],
    level: PermissionLevel.SYSTEM_ADMINISTRATION
  }
};
```

#### å®æ–½è®¡åˆ’
- âœ… **ç¬¬1-2å‘¨**: å»ºç«‹æƒé™å±‚çº§ä½“ç³»
- âœ… **ç¬¬3-4å‘¨**: å®ç°æƒé™ç»§æ‰¿æœºåˆ¶
- âœ… **ç¬¬5-6å‘¨**: å®æ–½æƒé™æ¨¡æ¿åŒ–ç®¡ç†

### ç¬¬ä¸‰é˜¶æ®µï¼šæƒé™å®¡è®¡ä¸ç›‘æ§ï¼ˆç¬¬5-6å‘¨ï¼‰ğŸ“ˆ

#### é—®é¢˜åˆ†æ
ç¼ºå°‘å®Œå–„çš„æƒé™å®¡è®¡å’Œç›‘æ§æœºåˆ¶ï¼Œéš¾ä»¥å‘ç°æƒé™æ»¥ç”¨ã€‚

#### è§£å†³æ–¹æ¡ˆ

**1. æƒé™å®¡è®¡æ—¥å¿—ç³»ç»Ÿ**
```typescript
// æƒé™å®¡è®¡äº‹ä»¶å®šä¹‰
interface PermissionAuditEvent {
  eventId: string;
  timestamp: Date;
  userId?: string;
  apiKeyId?: string;
  endpoint: string;
  method: string;
  requiredPermissions: Permission[];
  grantedPermissions: Permission[];
  result: 'granted' | 'denied';
  reason?: string;
  ipAddress: string;
  userAgent: string;
  requestId: string;
}

// æƒé™å®¡è®¡æœåŠ¡
@Injectable()
export class PermissionAuditService {
  async logPermissionEvent(event: PermissionAuditEvent): Promise<void> {
    // è®°å½•åˆ°æ•°æ®åº“
    await this.auditRepository.create(event);
    
    // å®æ—¶æƒé™å¼‚å¸¸æ£€æµ‹
    await this.detectPermissionAnomalies(event);
    
    // æƒé™ä½¿ç”¨ç»Ÿè®¡æ›´æ–°
    await this.updatePermissionStats(event);
  }
  
  async detectPermissionAnomalies(event: PermissionAuditEvent): Promise<void> {
    // æ£€æµ‹æƒé™å‡çº§å°è¯•
    if (event.result === 'denied' && this.isPermissionEscalationAttempt(event)) {
      await this.alertService.sendSecurityAlert({
        type: 'permission_escalation_attempt',
        details: event
      });
    }
    
    // æ£€æµ‹å¼‚å¸¸è®¿é—®æ¨¡å¼
    const recentEvents = await this.getRecentEvents(event.userId || event.apiKeyId, '1h');
    if (this.isAbnormalAccessPattern(recentEvents)) {
      await this.alertService.sendSecurityAlert({
        type: 'abnormal_access_pattern',
        details: { event, recentEvents }
      });
    }
  }
}
```

**2. æƒé™ä½¿ç”¨åˆ†æ**
```typescript
// æƒé™ä½¿ç”¨ç»Ÿè®¡
interface PermissionUsageStats {
  permission: Permission;
  totalRequests: number;
  grantedRequests: number;
  deniedRequests: number;
  uniqueUsers: number;
  topEndpoints: Array<{
    endpoint: string;
    requests: number;
  }>;
  timeDistribution: Array<{
    hour: number;
    requests: number;
  }>;
}

// æƒé™åˆ†ææœåŠ¡
@Injectable()
export class PermissionAnalyticsService {
  async generatePermissionReport(timeRange: string): Promise<PermissionUsageStats[]> {
    const stats = await this.auditRepository.aggregate([
      {
        $match: {
          timestamp: { $gte: this.parseTimeRange(timeRange) }
        }
      },
      {
        $unwind: '$requiredPermissions'
      },
      {
        $group: {
          _id: '$requiredPermissions',
          totalRequests: { $sum: 1 },
          grantedRequests: {
            $sum: { $cond: [{ $eq: ['$result', 'granted'] }, 1, 0] }
          },
          deniedRequests: {
            $sum: { $cond: [{ $eq: ['$result', 'denied'] }, 1, 0] }
          },
          uniqueUsers: { $addToSet: { $ifNull: ['$userId', '$apiKeyId'] } }
        }
      }
    ]);
    
    return stats;
  }
  
  async identifyUnusedPermissions(): Promise<Permission[]> {
    const usedPermissions = await this.auditRepository.distinct('requiredPermissions');
    const allPermissions = Object.values(Permission);
    
    return allPermissions.filter(permission => !usedPermissions.includes(permission));
  }
  
  async suggestPermissionOptimizations(): Promise<Array<{
    type: string;
    description: string;
    recommendation: string;
  }>> {
    const suggestions = [];
    
    // æ£€æµ‹è¿‡åº¦æƒé™
    const overPrivilegedUsers = await this.findOverPrivilegedUsers();
    if (overPrivilegedUsers.length > 0) {
      suggestions.push({
        type: 'over_privileged',
        description: `å‘ç°${overPrivilegedUsers.length}ä¸ªè¿‡åº¦æˆæƒçš„ç”¨æˆ·`,
        recommendation: 'å»ºè®®å®¡æŸ¥å¹¶é™ä½è¿™äº›ç”¨æˆ·çš„æƒé™çº§åˆ«'
      });
    }
    
    // æ£€æµ‹æœªä½¿ç”¨æƒé™
    const unusedPermissions = await this.identifyUnusedPermissions();
    if (unusedPermissions.length > 0) {
      suggestions.push({
        type: 'unused_permissions',
        description: `å‘ç°${unusedPermissions.length}ä¸ªæœªä½¿ç”¨çš„æƒé™`,
        recommendation: 'è€ƒè™‘ä»ç³»ç»Ÿä¸­ç§»é™¤è¿™äº›æœªä½¿ç”¨çš„æƒé™'
      });
    }
    
    return suggestions;
  }
}
```


```

#### å®æ–½è®¡åˆ’
- âœ… **ç¬¬1-2å‘¨**: å®æ–½æƒé™å®¡è®¡æ—¥å¿—ç³»ç»Ÿ
- âœ… **ç¬¬3-4å‘¨**: å»ºç«‹æƒé™ä½¿ç”¨åˆ†æ


## ğŸš€ å®æ–½è·¯çº¿å›¾

### é˜¶æ®µä¸€ï¼šåŸºç¡€ä¿®å¤ (ç¬¬1-2å‘¨)

#### ç¬¬1å‘¨ï¼šæƒé™è£…é¥°å™¨ä¿®å¤
- âœ… ä¿®å¤Symbol Mapper Controlleræƒé™è£…é¥°å™¨ç¼ºå¤±
- âœ… å…¨é¢æ£€æŸ¥æ‰€æœ‰æ§åˆ¶å™¨çš„æƒé™è£…é¥°å™¨
- âœ… å»ºç«‹æƒé™è£…é¥°å™¨éªŒè¯å·¥å…·

#### ç¬¬2å‘¨ï¼šå…¬å¼€ç«¯ç‚¹å®‰å…¨åŠ å¼º
- âœ… ä¸ºæ‰€æœ‰å…¬å¼€ç«¯ç‚¹æ·»åŠ é¢‘ç‡é™åˆ¶
- âœ… å®æ–½æ•æ„Ÿä¿¡æ¯è¿‡æ»¤
- âœ… å»ºç«‹å…¬å¼€ç«¯ç‚¹å®‰å…¨ç­–ç•¥

**é¢„æœŸæˆæœï¼š**
- æ¶ˆé™¤æƒé™è£…é¥°å™¨ä¸å®Œæ•´é—®é¢˜
- æå‡å…¬å¼€ç«¯ç‚¹å®‰å…¨æ€§
- å»ºç«‹åŸºç¡€çš„æƒé™éªŒè¯æœºåˆ¶

### é˜¶æ®µäºŒï¼šæ¶æ„ä¼˜åŒ– (ç¬¬3-4å‘¨)

#### ç¬¬3å‘¨ï¼šè®¤è¯æ–¹å¼ç»Ÿä¸€
- âœ… åˆ¶å®šç»Ÿä¸€è®¤è¯ç­–ç•¥
- âœ… è¿ç§»Monitoring Controlleråˆ°API Keyè®¤è¯
- âœ… è¿ç§»Alert Controlleråˆ°API Keyè®¤è¯

#### ç¬¬4å‘¨ï¼šæƒé™å±‚çº§å»ºç«‹
- âœ… å»ºç«‹æƒé™å±‚çº§ä½“ç³»
- âœ… å®ç°æƒé™ç»§æ‰¿æœºåˆ¶
- âœ… åˆ›å»ºæƒé™æ¨¡æ¿

**é¢„æœŸæˆæœï¼š**
- ç»Ÿä¸€çš„è®¤è¯æ¶æ„
- æ¸…æ™°çš„æƒé™å±‚çº§ä½“ç³»
- æ¨¡æ¿åŒ–çš„æƒé™ç®¡ç†

### é˜¶æ®µä¸‰ï¼šç›‘æ§å¢å¼º (ç¬¬5-6å‘¨)

#### ç¬¬5å‘¨ï¼šæƒé™å®¡è®¡ç³»ç»Ÿ
- âœ… å®æ–½æƒé™å®¡è®¡æ—¥å¿—
- âœ… å»ºç«‹æƒé™å¼‚å¸¸æ£€æµ‹
- âœ… å¼€å‘æƒé™ä½¿ç”¨åˆ†æ


**é¢„æœŸæˆæœï¼š**
- å®Œå–„çš„æƒé™å®¡è®¡ç³»ç»Ÿ
- å®æ—¶æƒé™ç›‘æ§èƒ½åŠ›
- æ™ºèƒ½æƒé™ä¼˜åŒ–å»ºè®®

### é˜¶æ®µå››ï¼šé«˜çº§åŠŸèƒ½ (ç¬¬7-8å‘¨)

#### ç¬¬7å‘¨ï¼šåŠ¨æ€æƒé™ç®¡ç†
- ğŸš€ å®ç°åŠ¨æ€æƒé™åˆ†é…
- ğŸš€ æƒé™ä¸´æ—¶æˆæƒåŠŸèƒ½
- ğŸš€ æƒé™è‡ªåŠ¨å›æ”¶æœºåˆ¶

#### ç¬¬8å‘¨ï¼šåˆè§„æ€§æ”¯æŒ
- ğŸš€ æƒé™åˆè§„æ€§æ£€æŸ¥
- ğŸš€ æƒé™å˜æ›´å®¡æ‰¹æµç¨‹
- ğŸš€ æƒé™æ²»ç†æŠ¥å‘Š

**é¢„æœŸæˆæœï¼š**
- çµæ´»çš„æƒé™ç®¡ç†èƒ½åŠ›
- å®Œå–„çš„åˆè§„æ€§æ”¯æŒ
- ä¼ä¸šçº§æƒé™æ²»ç†

## ğŸ“Š æˆåŠŸæŒ‡æ ‡

### å®‰å…¨æ€§æŒ‡æ ‡
- **æƒé™è£…é¥°å™¨å®Œæ•´æ€§**: 100% (ç›®æ ‡ï¼šä»å½“å‰95%æå‡åˆ°100%)
- **è®¤è¯æ–¹å¼ä¸€è‡´æ€§**: 100% (ç›®æ ‡ï¼šä»å½“å‰75%æå‡åˆ°100%)
- **å…¬å¼€ç«¯ç‚¹å®‰å…¨ä¿æŠ¤**: 100% (ç›®æ ‡ï¼šä»å½“å‰50%æå‡åˆ°100%)

### æ€§èƒ½æŒ‡æ ‡
- **æƒé™æ£€æŸ¥å“åº”æ—¶é—´**: <10ms (ç›®æ ‡ï¼šç»´æŒå½“å‰æ€§èƒ½)
- **æƒé™ç¼“å­˜å‘½ä¸­ç‡**: >95% (ç›®æ ‡ï¼šä¼˜åŒ–æƒé™æ£€æŸ¥æ€§èƒ½)
- **æƒé™å®¡è®¡å»¶è¿Ÿ**: <100ms (ç›®æ ‡ï¼šä¸å½±å“ä¸šåŠ¡æ€§èƒ½)

### ç®¡ç†æ•ˆç‡æŒ‡æ ‡
- **æƒé™é…ç½®æ—¶é—´**: å‡å°‘60% (é€šè¿‡æ¨¡æ¿åŒ–ç®¡ç†)
- **æƒé™é—®é¢˜æ’æŸ¥æ—¶é—´**: å‡å°‘70% (é€šè¿‡å®¡è®¡æ—¥å¿—)
- **æƒé™å˜æ›´é£é™©**: å‡å°‘80% (é€šè¿‡è‡ªåŠ¨åŒ–éªŒè¯)

### åˆè§„æ€§æŒ‡æ ‡
- **æƒé™å®¡è®¡è¦†ç›–ç‡**: 100% (ç›®æ ‡ï¼šå…¨é¢å®¡è®¡)
- **æƒé™å˜æ›´è¿½è¸ª**: 100% (ç›®æ ‡ï¼šå®Œæ•´è¿½è¸ª)
- **æƒé™åˆè§„æ£€æŸ¥**: è‡ªåŠ¨åŒ– (ç›®æ ‡ï¼šé›¶äººå·¥å¹²é¢„)

## ğŸ› ï¸ æŠ€æœ¯å®ç°ç»†èŠ‚

### æƒé™è£…é¥°å™¨éªŒè¯å·¥å…·/æƒé™éªŒè¯å·¥å…·  âœ… å·²å®ç°

**ç»„ä»¶ä½ç½®**ï¼š`src/permission/` ç‹¬ç«‹æƒé™ç»„ä»¶

**æ ¸å¿ƒæ–‡ä»¶ç»“æ„**ï¼š
```
src/permission/
â”œâ”€â”€ validators/
â”‚   â””â”€â”€ permission-decorator.validator.ts    # æƒé™è£…é¥°å™¨éªŒè¯å™¨
â”œâ”€â”€ services/
â”‚   â””â”€â”€ permission-validation.service.ts     # æƒé™éªŒè¯æœåŠ¡
â””â”€â”€ modules/
    â””â”€â”€ permission-validation.module.ts      # æƒé™éªŒè¯æ¨¡å—
```

```typescript
// âœ… å·²å®ç° - æƒé™è£…é¥°å™¨éªŒè¯å™¨/æƒé™éªŒè¯å·¥å…·  
// ä½ç½®: src/permission/validators/permission-decorator.validator.ts
@Injectable()
export class PermissionDecoratorValidator {
  private readonly logger = new Logger(PermissionDecoratorValidator.name);
  
  async validateAllControllers(): Promise<ValidationResult[]> {
    const results: ValidationResult[] = [];
    const controllers = this.discoveryService.getControllers();
    
    this.logger.log(`å¼€å§‹éªŒè¯æƒé™è£…é¥°å™¨ï¼Œå‘ç° ${controllers.length} ä¸ªæ§åˆ¶å™¨`);
    
    for (const controller of controllers) {
      try {
        const controllerResult = await this.validateController(controller);
        results.push(controllerResult);
        
        if (!controllerResult.isValid) {
          this.logger.warn(`æ§åˆ¶å™¨ ${controllerResult.controller} å­˜åœ¨ ${controllerResult.violations.length} ä¸ªæƒé™è£…é¥°å™¨é—®é¢˜`);
        }
      } catch (error: any) {
        this.logger.error(`éªŒè¯æ§åˆ¶å™¨å¤±è´¥: ${controller.name}`, error);
      }
    }
    
    return results;
  }
  
  private async validateController(controller: InstanceWrapper): Promise<ValidationResult> {
    const routes = this.getRoutes(controller.metatype);
    const violations: PermissionViolation[] = [];
    
    for (const route of routes) {
      // æ£€æŸ¥@ApiKeyAuthè£…é¥°å™¨æ˜¯å¦æœ‰å¯¹åº”çš„@RequirePermissions
      if (this.hasApiKeyAuth(route) && !this.hasRequirePermissions(route)) {
        violations.push({
          type: 'missing_require_permissions',
          route: route.path,
          method: route.method,
          message: '@ApiKeyAuthè£…é¥°å™¨å¿…é¡»é…åˆ@RequirePermissionsä½¿ç”¨',
          severity: 'high',
          recommendation: 'æ·»åŠ  @RequirePermissions(Permission.XXX) è£…é¥°å™¨'
        });
      }
      
      // æ£€æŸ¥æƒé™çº§åˆ«æ˜¯å¦åˆç†
      const permissions = this.getRequiredPermissions(route);
      const levelViolation = this.validatePermissionLevel(permissions, route);
      if (levelViolation) {
        violations.push(levelViolation);
      }
      
      // æ£€æŸ¥æƒé™ç»„åˆæ˜¯å¦æœ‰æ•ˆ
      const combinationViolation = this.validatePermissionCombination(permissions, route);
      if (combinationViolation) {
        violations.push(combinationViolation);
      }
    }
    
    return {
      controller: controller.name || 'Unknown',
      violations,
      isValid: violations.length === 0,
      totalRoutes: routes.length,
      validRoutes: routes.length - violations.length,
    };
  }
  
  // ç”Ÿæˆè¯¦ç»†çš„éªŒè¯æŠ¥å‘Š
  generateReport(results: ValidationResult[]): string {
    // ç”ŸæˆåŒ…å«ç»Ÿè®¡ä¿¡æ¯å’Œè¯¦ç»†è¿è§„å†…å®¹çš„æŠ¥å‘Š
  }
}
```

```typescript
// âœ… å·²å®ç° - æƒé™éªŒè¯æœåŠ¡
// ä½ç½®: src/permission/services/permission-validation.service.ts
@Injectable()
export class PermissionValidationService implements OnModuleInit {
  private readonly logger = new Logger(PermissionValidationService.name);
  
  constructor(
    private readonly permissionValidator: PermissionDecoratorValidator,
  ) {}
  
  // æ¨¡å—åˆå§‹åŒ–æ—¶è‡ªåŠ¨éªŒè¯
  async onModuleInit() {
    try {
      this.logger.log('åº”ç”¨å¯åŠ¨æ—¶è¿›è¡Œæƒé™è£…é¥°å™¨éªŒè¯...');
      await this.validatePermissions();
    } catch (error: any) {
      this.logger.error('æƒé™è£…é¥°å™¨éªŒè¯å¤±è´¥', error);
    }
  }
  
  // æ‰§è¡Œæƒé™éªŒè¯å¹¶ç”ŸæˆæŠ¥å‘Š
  async validatePermissions(): Promise<ValidationResult[]> {
    const startTime = Date.now();
    const results = await this.permissionValidator.validateAllControllers();
    const duration = Date.now() - startTime;
    
    const totalViolations = results.reduce((sum, result) => sum + result.violations.length, 0);
    
    if (totalViolations === 0) {
      this.logger.log(`âœ… æƒé™è£…é¥°å™¨éªŒè¯é€šè¿‡ (${duration}ms)`);
    } else {
      this.logger.warn(`âš ï¸ å‘ç°æƒé™è£…é¥°å™¨é—®é¢˜: ${totalViolations} ä¸ªè¿è§„ (${duration}ms)`);
      const report = this.permissionValidator.generateReport(results);
      this.logger.warn('æƒé™è£…é¥°å™¨éªŒè¯æŠ¥å‘Š:', report);
    }
    
    return results;
  }
}
```

### æƒé™ç»§æ‰¿æœºåˆ¶

```typescript
// æƒé™ç»§æ‰¿è®¡ç®—å™¨
@Injectable()
export class PermissionInheritanceCalculator {
  calculateInheritedPermissions(basePermissions: Permission[]): Permission[] {
    const inherited = new Set<Permission>();
    
    // æ·»åŠ åŸºç¡€æƒé™
    basePermissions.forEach(permission => inherited.add(permission));
    
    // è®¡ç®—ç»§æ‰¿æƒé™
    for (const permission of basePermissions) {
      const parentPermissions = this.getParentPermissions(permission);
      parentPermissions.forEach(parent => inherited.add(parent));
    }
    
    return Array.from(inherited);
  }
  
  private getParentPermissions(permission: Permission): Permission[] {
    const hierarchy = {
      [Permission.SYSTEM_ADMIN]: [
        Permission.SYSTEM_MONITOR,
        Permission.SYSTEM_HEALTH,
        Permission.CONFIG_READ,
        Permission.CONFIG_WRITE
      ],
      [Permission.MAPPING_WRITE]: [
        Permission.CONFIG_READ,
        Permission.DATA_READ
      ],
      [Permission.CONFIG_WRITE]: [
        Permission.CONFIG_READ
      ]
      // æ›´å¤šç»§æ‰¿å…³ç³»...
    };
    
    return hierarchy[permission] || [];
  }
}
```

### æƒé™å®¡è®¡è£…é¥°å™¨

```typescript
// æƒé™å®¡è®¡è£…é¥°å™¨
export function AuditPermissions(options?: AuditOptions) {
  return function (target: any, propertyName: string, descriptor: PropertyDescriptor) {
    const method = descriptor.value;
    
    descriptor.value = async function (...args: any[]) {
      const context = args[0]; // ExecutionContext
      const request = context.switchToHttp().getRequest();
      
      // è®°å½•æƒé™æ£€æŸ¥å¼€å§‹
      const auditEvent: PermissionAuditEvent = {
        eventId: generateEventId(),
        timestamp: new Date(),
        endpoint: request.url,
        method: request.method,
        userId: request.user?.id,
        apiKeyId: request.apiKey?.id,
        ipAddress: request.ip,
        userAgent: request.get('User-Agent'),
        requestId: request.headers['x-request-id']
      };
      
      try {
        const result = await method.apply(this, args);
        
        // è®°å½•æˆåŠŸçš„æƒé™æ£€æŸ¥
        auditEvent.result = 'granted';
        await this.auditService.logPermissionEvent(auditEvent);
        
        return result;
      } catch (error) {
        // è®°å½•å¤±è´¥çš„æƒé™æ£€æŸ¥
        auditEvent.result = 'denied';
        auditEvent.reason = error.message;
        await this.auditService.logPermissionEvent(auditEvent);
        
        throw error;
      }
    };
  };
}
```

## ğŸ”’ å®‰å…¨è€ƒè™‘

### æƒé™å‡çº§é˜²æŠ¤

```typescript
// æƒé™å‡çº§æ£€æµ‹å™¨
@Injectable()
export class PermissionEscalationDetector {
  async detectEscalationAttempt(
    user: AuthSubject,
    attemptedPermissions: Permission[]
  ): Promise<boolean> {
    const currentLevel = this.getUserPermissionLevel(user.permissions);
    const attemptedLevel = this.getMaxPermissionLevel(attemptedPermissions);
    
    // æ£€æµ‹æƒé™çº§åˆ«æå‡å°è¯•
    if (attemptedLevel > currentLevel) {
      await this.logSecurityEvent({
        type: 'permission_escalation_attempt',
        userId: user.id,
        currentLevel,
        attemptedLevel,
        timestamp: new Date()
      });
      
      return true;
    }
    
    return false;
  }
  
  private getUserPermissionLevel(permissions: Permission[]): number {
    return Math.max(...permissions.map(p => this.getPermissionLevel(p)));
  }
}
```

### æƒé™å®¡è®¡åŠ å¯†

```typescript
// æ•æ„Ÿæƒé™æ“ä½œåŠ å¯†
@Injectable()
export class PermissionAuditEncryption {
  private readonly encryptionKey = process.env.AUDIT_ENCRYPTION_KEY;
  
  async encryptSensitiveAuditData(data: PermissionAuditEvent): Promise<EncryptedAuditEvent> {
    const sensitiveFields = ['userId', 'apiKeyId', 'ipAddress'];
    const encrypted = { ...data };
    
    for (const field of sensitiveFields) {
      if (encrypted[field]) {
        encrypted[field] = await this.encrypt(encrypted[field]);
      }
    }
    
    return encrypted;
  }
  
  private async encrypt(data: string): Promise<string> {
    const cipher = crypto.createCipher('aes-256-cbc', this.encryptionKey);
    let encrypted = cipher.update(data, 'utf8', 'hex');
    encrypted += cipher.final('hex');
    return encrypted;
  }
}
```

## ğŸ“‹ æµ‹è¯•ç­–ç•¥

### æƒé™è£…é¥°å™¨æµ‹è¯•

```typescript
describe('PermissionDecorators', () => {
  it('should validate all API Key endpoints have RequirePermissions', async () => {
    const validator = new PermissionDecoratorValidator();
    const results = await validator.validateControllers();
    
    const violations = results
      .flatMap(r => r.violations)
      .filter(v => v.type === 'missing_require_permissions');
    
    expect(violations).toHaveLength(0);
  });
  
  it('should ensure permission levels are consistent', async () => {
    const analyzer = new PermissionLevelAnalyzer();
    const inconsistencies = await analyzer.findInconsistencies();
    
    expect(inconsistencies).toHaveLength(0);
  });
});
```

### æƒé™ç»§æ‰¿æµ‹è¯•

```typescript
describe('PermissionInheritance', () => {
  it('should correctly calculate inherited permissions', () => {
    const calculator = new PermissionInheritanceCalculator();
    const inherited = calculator.calculateInheritedPermissions([
      Permission.SYSTEM_ADMIN
    ]);
    
    expect(inherited).toContain(Permission.SYSTEM_MONITOR);
    expect(inherited).toContain(Permission.CONFIG_READ);
  });
  
  it('should prevent circular inheritance', () => {
    const calculator = new PermissionInheritanceCalculator();
    
    expect(() => {
      calculator.addInheritanceRule(
        Permission.CONFIG_READ,
        Permission.SYSTEM_ADMIN
      );
    }).toThrow('Circular inheritance detected');
  });
});
```

### æƒé™å®¡è®¡æµ‹è¯•

```typescript
describe('PermissionAudit', () => {
  it('should log all permission checks', async () => {
    const auditService = new PermissionAuditService();
    const mockEvent: PermissionAuditEvent = {
      eventId: 'test-001',
      timestamp: new Date(),
      endpoint: '/test',
      method: 'GET',
      result: 'granted'
    };
    
    await auditService.logPermissionEvent(mockEvent);
    
    const logged = await auditService.getEvent('test-001');
    expect(logged).toBeDefined();
    expect(logged.result).toBe('granted');
  });
  
  it('should detect permission escalation attempts', async () => {
    const detector = new PermissionEscalationDetector();
    const user = createMockUser([Permission.DATA_READ]);
    
    const isEscalation = await detector.detectEscalationAttempt(
      user,
      [Permission.SYSTEM_ADMIN]
    );
    
    expect(isEscalation).toBe(true);
  });
});
```


### é£é™©åˆ†æ

#### æŠ€æœ¯é£é™©
- **å…¼å®¹æ€§é—®é¢˜**: ä½é£é™© (å®Œå…¨å‘åå…¼å®¹)
- **æ€§èƒ½å½±å“**: ä½é£é™© (æƒé™æ£€æŸ¥æ€§èƒ½ä¼˜åŒ–)
- **æ•°æ®ä¸¢å¤±**: æä½é£é™© (éç ´åæ€§å‡çº§)

#### ä¸šåŠ¡é£é™©
- **æœåŠ¡ä¸­æ–­**: ä½é£é™© (åˆ†é˜¶æ®µå®æ–½)
- **ç”¨æˆ·é€‚åº”**: ä¸­é£é™© (éœ€è¦åŸ¹è®­æ”¯æŒ)
- **åŠŸèƒ½å›é€€**: ä½é£é™© (å®Œæ•´æµ‹è¯•è¦†ç›–)

#### ç¼“è§£æªæ–½
- åˆ†é˜¶æ®µå®æ–½ï¼Œæ¯é˜¶æ®µå……åˆ†æµ‹è¯•
- ä¿ç•™å›æ»šæœºåˆ¶
- å®Œå–„çš„ç”¨æˆ·åŸ¹è®­å’Œæ–‡æ¡£
- 24/7æŠ€æœ¯æ”¯æŒåœ¨å‡çº§æœŸé—´

## ğŸ“ æ€»ç»“

æœ¬æƒé™ä¼˜åŒ–æ–¹æ¡ˆé€šè¿‡ç³»ç»Ÿæ€§çš„åˆ†æå’Œè®¾è®¡ï¼Œè§£å†³äº†New Stock APIç³»ç»Ÿå½“å‰å­˜åœ¨çš„æƒé™ç®¡ç†é—®é¢˜ï¼š

### æ ¸å¿ƒæ”¹è¿›
1. **æƒé™è£…é¥°å™¨æ ‡å‡†åŒ–** - ç¡®ä¿æ‰€æœ‰ç«¯ç‚¹æƒé™æ§åˆ¶å®Œæ•´æ€§
2. **è®¤è¯æ–¹å¼ç»Ÿä¸€åŒ–** - å»ºç«‹ä¸€è‡´çš„è®¤è¯æ¶æ„
3. **å…¬å¼€ç«¯ç‚¹å®‰å…¨åŠ å¼º** - æ¶ˆé™¤å®‰å…¨éšæ‚£
4. **æƒé™çº§åˆ«æ ‡å‡†åŒ–** - å»ºç«‹æ¸…æ™°çš„æƒé™å±‚çº§ä½“ç³»
5. **æƒé™å®¡è®¡ä¸ç›‘æ§** - å®ç°å…¨é¢çš„æƒé™æ²»ç†

### é¢„æœŸæ•ˆæœ
- **å®‰å…¨æ€§æå‡**: æ¶ˆé™¤æƒé™æ¼æ´ï¼Œå»ºç«‹å®Œå–„çš„å®‰å…¨é˜²æŠ¤
- **ç®¡ç†æ•ˆç‡**: é€šè¿‡æ¨¡æ¿åŒ–å’Œè‡ªåŠ¨åŒ–å¤§å¹…æå‡æƒé™ç®¡ç†æ•ˆç‡
- **åˆè§„æ”¯æŒ**: æ»¡è¶³ä¼ä¸šçº§æƒé™æ²»ç†è¦æ±‚
- **æ‰©å±•æ€§**: ä¸ºæœªæ¥çš„åŠŸèƒ½æ‰©å±•å¥ å®šåšå®åŸºç¡€

### å®æ–½å»ºè®®
1. **åˆ†é˜¶æ®µå®æ–½**: æŒ‰ç…§4ä¸ªé˜¶æ®µé€æ­¥æ¨è¿›ï¼Œç¡®ä¿æ¯ä¸ªé˜¶æ®µç¨³å®š
2. **å……åˆ†æµ‹è¯•**: æ¯ä¸ªé˜¶æ®µéƒ½è¦è¿›è¡Œå…¨é¢çš„å®‰å…¨å’ŒåŠŸèƒ½æµ‹è¯•
3. **ç”¨æˆ·åŸ¹è®­**: æä¾›è¯¦ç»†çš„æƒé™ä½¿ç”¨æŒ‡å—å’ŒåŸ¹è®­
4. **æŒç»­ç›‘æ§**: å®æ–½åæŒç»­ç›‘æ§æƒé™ä½¿ç”¨æƒ…å†µå’Œå®‰å…¨çŠ¶æ€

é€šè¿‡æœ¬ä¼˜åŒ–æ–¹æ¡ˆçš„å®æ–½ï¼ŒNew Stock APIç³»ç»Ÿå°†æ‹¥æœ‰ä¼ä¸šçº§çš„æƒé™ç®¡ç†èƒ½åŠ›ï¼Œä¸ºç³»ç»Ÿçš„é•¿æœŸå‘å±•å’Œå®‰å…¨è¿è¥æä¾›å¼ºæœ‰åŠ›çš„ä¿éšœã€‚

---

*æœ¬æ–‡æ¡£æœ€åæ›´æ–°äº: 2025å¹´1æœˆ26æ—¥*  
*ç‰ˆæœ¬: v1.0.0*  
*ä½œè€…: Claude Code Assistant*