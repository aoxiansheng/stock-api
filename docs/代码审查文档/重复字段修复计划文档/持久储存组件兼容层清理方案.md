# å­˜å‚¨ç»„ä»¶å…¼å®¹å±‚æ¸…ç†æ–¹æ¡ˆ

## æ ¸å¿ƒåŸåˆ™

åŸºäºä»¥ä¸‹ä¸‰ä¸ªå…³é”®åŸåˆ™åˆ¶å®šæ¸…ç†æ–¹æ¡ˆï¼š
1. **ä¸å­˜åœ¨å†å²æ•°æ®** - å¯ä»¥ç›´æ¥è¿›è¡Œå…¼å®¹å±‚çš„å®Œæ•´ç§»é™¤
2. **StorageServiceèŒè´£å•ä¸€** - ä»…è´Ÿè´£æŒä¹…åŒ–å­˜å‚¨ï¼Œä¸æ”¯æŒä»»ä½•ç¼“å­˜æ“ä½œ
3. **ç»„ä»¶ç›®æ ‡æ˜ç¡®** - å”¯ä¸€ç›®æ ‡æ˜¯å°†ç¬¬ä¸‰æ–¹SDKè·å–çš„æ•°æ®å†™å…¥åˆ°æ•°æ®åº“

## ğŸš¨ å…³é”®å‘ç°ï¼šæ¶æ„ä¸ä¸€è‡´ä¸å…¼å®¹å±‚å†—ä½™

## 1. ğŸ”´ å…³é”®é—®é¢˜ï¼šä¸å®Œæ•´é‡æ„å¯¼è‡´çš„è¿è¡Œæ—¶é”™è¯¯

### 1.1 StorageServiceé‡æ„çŠ¶æ€
**StorageServiceå·²å®Œå…¨é‡æ„**ï¼Œä»…æ”¯æŒ`PERSISTENT`å­˜å‚¨ç±»å‹ï¼š

```typescript
// storage.service.ts - ä¸‰ä¸ªæ ¸å¿ƒæ–¹æ³•éƒ½æœ‰ä¸¥æ ¼æ£€æŸ¥
if (request.storageType !== StorageType.PERSISTENT) {
  throw new BadRequestException(
    `StorageServiceç°åœ¨ä»…æ”¯æŒPERSISTENTå­˜å‚¨ç±»å‹ã€‚å¯¹äºç¼“å­˜æ“ä½œï¼Œè¯·ä½¿ç”¨CommonCacheServiceã€‚`
  );
}
```

### 1.2 æœªåŒæ­¥æ›´æ–°çš„ç»„ä»¶
**ä»¥ä¸‹ç»„ä»¶ä»åœ¨ä½¿ç”¨è¢«æ‹’ç»çš„StorageTypeå€¼**ï¼š

| ç»„ä»¶ | é—®é¢˜ä»£ç  | è¿è¡Œæ—¶å½±å“ |
|------|----------|-----------|
| **receiver.service.ts:740** | `storageType: StorageType.BOTH` | âŒ è°ƒç”¨StorageServiceä¼šæŠ›å¼‚å¸¸ |
| **query-execution-engine.service.ts:962** | `storageType: StorageType.BOTH` | âŒ è°ƒç”¨StorageServiceä¼šæŠ›å¼‚å¸¸ |
| **storage.controller.ts:301** | `preferredType: StorageType.BOTH` | âŒ ä¼ é€’ç»™StorageServiceä¼šæŠ›å¼‚å¸¸ |
| **storage-request.dto.ts:60** | `example: StorageType.STORAGETYPECACHE` | âš ï¸ è¯¯å¯¼APIç”¨æˆ· |
| **storage-request.dto.ts:96** | `default: StorageType.STORAGETYPECACHE` | âš ï¸ è¯¯å¯¼APIç”¨æˆ· |

## 2. ğŸ”´ æ•°æ®æ ¼å¼å…¼å®¹å±‚å†—ä½™é—®é¢˜

### 2.1 å†—ä½™å…¼å®¹å±‚ä»£ç 
```typescript
// å½“å‰å­˜åœ¨çš„å†—ä½™å…¼å®¹å±‚ä»£ç 
if (document.compressed === true && typeof data === "string") {
  // æ–°æ ¼å¼æ•°æ®å¤„ç†
}
// ğŸ”´ å†—ä½™ä»£ç ï¼šæ—§æ ¼å¼å…¼å®¹å±‚ï¼ˆæ— å†å²æ•°æ®ï¼Œåº”åˆ é™¤ï¼‰
else if (data && typeof data === "object" && data.compressed === true) {
  // å¤„ç†ä¸å­˜åœ¨çš„æ—§æ ¼å¼æ•°æ®
}
```

**ä¿®æ­£è¯„ä¼°**ï¼šğŸ”´ **å…¼å®¹å±‚ä»£ç å®Œå…¨å†—ä½™**ï¼Œå› ä¸ºä¸å­˜åœ¨å†å²æ•°æ®ï¼Œåº”è¯¥å®Œæ•´ç§»é™¤ã€‚

## 3. ğŸ¯ å®Œæ•´å…¼å®¹å±‚æ¸…ç†ç­–ç•¥

### å•ä¸€é˜¶æ®µï¼šå®Œæ•´å…¼å®¹å±‚ç§»é™¤ï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰

åŸºäºæ— å†å²æ•°æ®çš„å®é™…æƒ…å†µï¼Œé‡‡ç”¨ä¸€æ¬¡æ€§å®Œæ•´æ¸…ç†ç­–ç•¥ï¼š

#### 3.1 ç«‹å³ä¿®å¤è¿è¡Œæ—¶é”™è¯¯
```typescript
// 1. ä¿®å¤è°ƒç”¨æ–¹ - receiver.service.ts
- storageType: StorageType.BOTH,
+ storageType: StorageType.PERSISTENT,

// 2. ä¿®å¤è°ƒç”¨æ–¹ - query-execution-engine.service.ts
- storageType: StorageType.BOTH,
+ storageType: StorageType.PERSISTENT,

// 3. ä¿®å¤Controlleré»˜è®¤å€¼ - storage.controller.ts
- preferredType: (preferredType as StorageType) || StorageType.BOTH,
+ preferredType: (preferredType as StorageType) || StorageType.PERSISTENT,
```

#### 3.2 æ›´æ–°DTOå®šä¹‰
```typescript
// storage-request.dto.ts
- example: StorageType.STORAGETYPECACHE,
+ example: StorageType.PERSISTENT,

- default: StorageType.STORAGETYPECACHE,
+ default: StorageType.PERSISTENT,
```

#### 3.3 æ¸…ç†åºŸå¼ƒçš„æšä¸¾å€¼
```typescript
// storage-type.enum.ts - ç®€åŒ–ä¸ºå•ä¸€èŒè´£
export enum StorageType {
-  STORAGETYPECACHE = "storagetype_cache",  // ğŸ”´ å®Œå…¨åˆ é™¤
   PERSISTENT = "persistent",               // å”¯ä¸€ä¿ç•™å€¼
-  BOTH = "both",                          // ğŸ”´ å®Œå…¨åˆ é™¤
}
```

#### 3.4 ç§»é™¤æ•°æ®æ ¼å¼å…¼å®¹å±‚
```typescript
// storage.service.ts - ç§»é™¤æ‰€æœ‰å…¼å®¹æ€§æ£€æŸ¥ä»£ç 
// ğŸ”´ å®Œå…¨åˆ é™¤ä»¥ä¸‹å…¼å®¹å±‚ä»£ç å—ï¼š
- else if (data && typeof data === "object" && data.compressed === true) {
-   try {
-     const buffer = Buffer.from(data.data, "base64");
-     data = JSON.parse((await gunzip(buffer)).toString());
-   } catch (error) {
-     this.logger.warn("è§£å‹æŒä¹…æ•°æ®å¤±è´¥ (å…¼å®¹æ ¼å¼)", error);
-     return null;
-   }
- }

// ä¿ç•™ç®€åŒ–çš„æ–°æ ¼å¼å¤„ç†
if (document.compressed === true && typeof data === "string") {
  // ä»…ä¿ç•™æ–°æ ¼å¼æ•°æ®å¤„ç†é€»è¾‘
}
```

## 4. ğŸš¨ é£é™©è¯„ä¼°

### 4.1 ä¿®æ­£åçš„é£é™©è¯„ä¼°
| é£é™©ç±»å‹ | ä¿®æ­£å‰è¯„ä¼° | ä¿®æ­£åè¯„ä¼° | åŸå›  |
|----------|------------|------------|------|
| **æ¶æ„ä¸ä¸€è‡´** | ğŸ”´ ä¸¥é‡ | ğŸ”´ ä¸¥é‡ | ç¡®å®éœ€è¦ç«‹å³ä¿®å¤ |
| **APIæ–‡æ¡£è¯¯å¯¼** | ğŸŸ¡ ä¸­ç­‰ | ğŸŸ¡ ä¸­ç­‰ | ç¡®å®éœ€è¦æ›´æ–° |
| **å†å²æ•°æ®å…¼å®¹** | ğŸŸ¢ ä½é£é™© | âœ… æ— é£é™© | æ— å†å²æ•°æ®ï¼Œç›´æ¥ç§»é™¤ |

### 4.2 ä¿®æ­£åçš„æ¸…ç†ä¼˜å…ˆçº§
**ç»Ÿä¸€é«˜ä¼˜å…ˆçº§**ï¼šä¸€æ¬¡æ€§å®Œæ•´å…¼å®¹å±‚ç§»é™¤ï¼ˆ4-6å°æ—¶å†…å®Œæˆï¼‰
1. ä¿®å¤StorageTypeä½¿ç”¨ä¸ä¸€è‡´
2. ç§»é™¤åºŸå¼ƒæšä¸¾å€¼
3. åˆ é™¤æ•°æ®æ ¼å¼å…¼å®¹å±‚ä»£ç 
4. æ›´æ–°DTOæ–‡æ¡£å’Œç¤ºä¾‹
5. è¿è¡Œå®Œæ•´æµ‹è¯•éªŒè¯

## 5. ğŸ“‹ å®Œæ•´æ¸…ç†æ£€æŸ¥æ¸…å•

### âœ… ä¸€æ¬¡æ€§å®Œæ•´æ‰§è¡Œé¡¹ç›®
- [ ] **ä¿®å¤StorageTypeä½¿ç”¨** - receiver.service.ts ä¸­çš„ StorageType.BOTH
- [ ] **ä¿®å¤StorageTypeä½¿ç”¨** - query-execution-engine.service.ts ä¸­çš„ StorageType.BOTH
- [ ] **ä¿®å¤é»˜è®¤å€¼** - storage.controller.ts ä¸­çš„æ‰€æœ‰é»˜è®¤å€¼
- [ ] **æ›´æ–°APIæ–‡æ¡£** - storage-request.dto.ts ä¸­çš„ç¤ºä¾‹å’Œé»˜è®¤å€¼
- [ ] **æ¸…ç†æšä¸¾å®šä¹‰** - ç§»é™¤ StorageType.STORAGETYPECACHE å’Œ BOTH
- [ ] **ç§»é™¤å…¼å®¹å±‚ä»£ç ** - åˆ é™¤ storage.service.ts ä¸­çš„æ—§æ ¼å¼å¤„ç†é€»è¾‘
- [ ] **ç®€åŒ–å‹ç¼©å¤„ç†** - ä»…ä¿ç•™æ–°æ ¼å¼æ•°æ®å¤„ç†
- [ ] **è¿è¡Œå®Œæ•´æµ‹è¯•** - éªŒè¯æ‰€æœ‰ä¿®å¤å’Œæ¸…ç†

### âŒ å·²å–æ¶ˆçš„æ— ç”¨é¡¹ç›®
- ~~æ£€æŸ¥æ•°æ®åº“ä¸­æ—§æ ¼å¼æ•°æ®æ•°é‡~~ - ç¡®è®¤æ— å†å²æ•°æ®
- ~~åˆ¶å®šæ•°æ®æ ¼å¼è¿ç§»è®¡åˆ’~~ - ä¸éœ€è¦è¿ç§»
- ~~æ·»åŠ å…¼å®¹å±‚ä½¿ç”¨ç›‘æ§~~ - æ— å…¼å®¹å±‚éœ€è¦ç›‘æ§
- ~~å®šæœŸè¯„ä¼°å…¼å®¹å±‚æ¸…ç†æ—¶æœº~~ - ä¸€æ¬¡æ€§å®Œæ•´æ¸…ç†

## 6. ğŸ’¡ ä¿®æ­£åçš„ç»“è®º

**åŸºäºä¸‰ä¸ªæ ¸å¿ƒåŸåˆ™çš„é‡æ–°è¯„ä¼°**ï¼š

**å®Œå…¨é”™è¯¯çš„åŸå§‹è¯„ä¼°**ï¼š
- âŒ **æ•°æ®æ ¼å¼å…¼å®¹å±‚è®¾è®¡ä¼˜ç§€ï¼Œåº”è¯¥ä¿ç•™** â†’ âœ… **æ— å†å²æ•°æ®ï¼Œåº”è¯¥å®Œæ•´ç§»é™¤**
- âŒ **åˆ†é˜¶æ®µæ¸…ç†ç­–ç•¥** â†’ âœ… **ä¸€æ¬¡æ€§å®Œæ•´æ¸…ç†ç­–ç•¥**
- âŒ **éœ€è¦æ•°æ®è¿ç§»è®¡åˆ’** â†’ âœ… **ç›´æ¥åˆ é™¤ï¼Œæ— éœ€è¿ç§»**

**ä¿®æ­£åçš„æ ¸å¿ƒå‘ç°**ï¼š
- ğŸ”´ **StorageTypeæšä¸¾å†—ä½™**ï¼šå­˜åœ¨ä¸¥é‡æ¶æ„ä¸ä¸€è‡´ï¼Œéœ€è¦ç«‹å³ä¿®å¤
- ğŸ”´ **æ•°æ®æ ¼å¼å…¼å®¹å±‚å†—ä½™**ï¼šæ— å†å²æ•°æ®æ”¯æ’‘ï¼Œå®Œå…¨å†—ä½™ä»£ç 
- âœ… **StorageServiceèŒè´£æ˜ç¡®**ï¼šçº¯ç²¹çš„æŒä¹…åŒ–å­˜å‚¨ï¼Œå•ä¸€èŒè´£åŸåˆ™

**æŠ€æœ¯å€ºåŠ¡æ€§è´¨**ï¼šå…¸å‹çš„**è¿‡åº¦è®¾è®¡ + é‡æ„ä¸å®Œæ•´**ï¼Œå¯¼è‡´å†—ä½™ä»£ç å’Œæ¶æ„ä¸ä¸€è‡´ã€‚

## 7. è¯¦ç»†å®æ–½æ–¹æ¡ˆ

### 7.1 æ–‡ä»¶ä¿®å¤æ¸…å•

#### æ–‡ä»¶1ï¼šsrc/core/01-entry/receiver/services/receiver.service.ts
**ä½ç½®**ï¼šç¬¬740è¡Œ
```typescript
// å½“å‰ä»£ç 
storageType: StorageType.BOTH, // æ—¢ç¼“å­˜åˆæŒä¹…åŒ–

// ä¿®å¤å
storageType: StorageType.PERSISTENT, // ä»…æŒä¹…åŒ–å­˜å‚¨
```

#### æ–‡ä»¶2ï¼šsrc/core/01-entry/query/services/query-execution-engine.service.ts
**ä½ç½®**ï¼šç¬¬962è¡Œ
```typescript
// å½“å‰ä»£ç 
storageType: StorageType.BOTH,

// ä¿®å¤å
storageType: StorageType.PERSISTENT,
```

#### æ–‡ä»¶3ï¼šsrc/core/04-storage/storage/controller/storage.controller.ts
**ä½ç½®**ï¼šç¬¬301ã€369ã€375ã€381è¡Œ
```typescript
// å½“å‰ä»£ç 
preferredType: (preferredType as StorageType) || StorageType.BOTH,
storageType: (storageType as StorageType) || StorageType.BOTH,
(storageType as StorageType) || StorageType.BOTH,
storageType: storageType || StorageType.BOTH,

// ä¿®å¤å
preferredType: (preferredType as StorageType) || StorageType.PERSISTENT,
storageType: (storageType as StorageType) || StorageType.PERSISTENT,
(storageType as StorageType) || StorageType.PERSISTENT,
storageType: storageType || StorageType.PERSISTENT,
```

#### æ–‡ä»¶4ï¼šsrc/core/04-storage/storage/dto/storage-request.dto.ts
**ä½ç½®**ï¼šç¬¬60ã€96è¡Œ
```typescript
// å½“å‰ä»£ç 
example: StorageType.STORAGETYPECACHE,
default: StorageType.STORAGETYPECACHE,

// ä¿®å¤å
example: StorageType.PERSISTENT,
default: StorageType.PERSISTENT,
```

#### æ–‡ä»¶5ï¼šsrc/core/04-storage/storage/enums/storage-type.enum.ts
```typescript
// å½“å‰ä»£ç 
/**
 * å­˜å‚¨ç±»å‹æšä¸¾
 * ä¿ç•™STORAGETYPECACHEç”¨äºå‘åå…¼å®¹å’Œè¯†åˆ«
 */
export enum StorageType {
  STORAGETYPECACHE = "storagetype_cache",
  PERSISTENT = "persistent",
  BOTH = "both",
}

// ä¿®å¤å
/**
 * å­˜å‚¨ç±»å‹æšä¸¾
 * é‡æ„åä»…æ”¯æŒæŒä¹…åŒ–å­˜å‚¨
 */
export enum StorageType {
  PERSISTENT = "persistent",
}
```

### 7.2 éªŒè¯è„šæœ¬

#### éªŒè¯1ï¼šç±»å‹æ£€æŸ¥
```bash
# æ£€æŸ¥ä¿®å¤åçš„ç±»å‹é”™è¯¯
DISABLE_AUTO_INIT=true npm run typecheck:file -- src/core/01-entry/receiver/services/receiver.service.ts
DISABLE_AUTO_INIT=true npm run typecheck:file -- src/core/01-entry/query/services/query-execution-engine.service.ts
DISABLE_AUTO_INIT=true npm run typecheck:file -- src/core/04-storage/storage/controller/storage.controller.ts
DISABLE_AUTO_INIT=true npm run typecheck:file -- src/core/04-storage/storage/dto/storage-request.dto.ts
```

#### éªŒè¯2ï¼šå•å…ƒæµ‹è¯•
```bash
# è¿è¡Œå­˜å‚¨ç›¸å…³æµ‹è¯•
bun run test:unit:cache
bun run test:integration:all
```

#### éªŒè¯3ï¼šAPIæµ‹è¯•
```bash
# æµ‹è¯•å­˜å‚¨APIç«¯ç‚¹
curl -X POST http://localhost:3000/api/v1/storage/store \
  -H "Content-Type: application/json" \
  -d '{
    "key": "test-key",
    "data": {"test": "data"},
    "storageType": "persistent",
    "storageClassification": "test",
    "provider": "test",
    "market": "test"
  }'
```

### 7.3 ç›‘æ§æ•°æ®æ ¼å¼å…¼å®¹å±‚

#### æ·»åŠ ç›‘æ§ä»£ç 
```typescript
// åœ¨ storage.service.ts çš„ tryRetrieveFromPersistent æ–¹æ³•ä¸­æ·»åŠ 
// Legacy format: Check nested compressed flag for backward compatibility
else if (data && typeof data === "object" && data.compressed === true) {
  // æ·»åŠ ç›‘æ§ç»Ÿè®¡
  this.logger.warn("æ£€æµ‹åˆ°æ—§æ ¼å¼å‹ç¼©æ•°æ®ï¼Œå»ºè®®è¿›è¡Œæ•°æ®è¿ç§»", {
    key: request.key,
    format: "legacy_nested_compressed"
  });

  try {
    const buffer = Buffer.from(data.data, "base64");
    data = JSON.parse((await gunzip(buffer)).toString());
  } catch (error) {
    this.logger.warn("è§£å‹æŒä¹…æ•°æ®å¤±è´¥ (å…¼å®¹æ ¼å¼)", error);
    return null; // Corrupted data
  }
}
```

### 7.4 æ•°æ®è¿ç§»æ£€æŸ¥

#### MongoDBæŸ¥è¯¢è„šæœ¬
```javascript
// æ£€æŸ¥æ—§æ ¼å¼æ•°æ®æ•°é‡
db.storeddatas.countDocuments({
  "data.compressed": true
});

// æŸ¥çœ‹å…·ä½“çš„æ—§æ ¼å¼æ•°æ®æ ·æœ¬
db.storeddatas.find({
  "data.compressed": true
}).limit(5);

// ç»Ÿè®¡æ–°æ—§æ ¼å¼æ•°æ®åˆ†å¸ƒ
db.storeddatas.aggregate([
  {
    $group: {
      _id: {
        hasRootCompressed: { $type: "$compressed" },
        hasNestedCompressed: { $type: "$data.compressed" }
      },
      count: { $sum: 1 }
    }
  }
]);
```

## 8. ä¿®æ­£åçš„æ—¶é—´å®‰æ’

| ä»»åŠ¡ç±»å‹ | ä¿®æ­£å‰é¢„ä¼° | ä¿®æ­£åé¢„ä¼° | å˜åŒ–åŸå›  |
|----------|------------|------------|----------|
| **æ¶æ„ä¸ä¸€è‡´ä¿®å¤** | 2-4å°æ—¶ | 2-4å°æ—¶ | æ— å˜åŒ– |
| **å…¼å®¹å±‚ç§»é™¤** | 1å‘¨è¯„ä¼°æœŸ | 1-2å°æ—¶ | æ— å†å²æ•°æ®ï¼Œç›´æ¥åˆ é™¤ |
| **æ•°æ®è¿ç§»** | éœ€è¦è®¡åˆ’ | ä¸éœ€è¦ | æ— å†å²æ•°æ® |
| **ç›‘æ§éƒ¨ç½²** | 1å°æ—¶ | ä¸éœ€è¦ | æ— å…¼å®¹å±‚éœ€è¦ç›‘æ§ |

**ä¿®æ­£åæ€»è®¡**ï¼š**4-6å°æ—¶å®Œæˆæ‰€æœ‰æ¸…ç†å·¥ä½œ**ï¼ˆä»åŸæ¥çš„1å‘¨ç¼©çŸ­åˆ°åŠå¤©ï¼‰

### 8.1 ç®€åŒ–çš„æ‰§è¡Œæ­¥éª¤
1. **ä»£ç ä¿®å¤**ï¼ˆ2-3å°æ—¶ï¼‰- ä¿®å¤StorageTypeä½¿ç”¨ä¸ä¸€è‡´
2. **å…¼å®¹å±‚åˆ é™¤**ï¼ˆ1-2å°æ—¶ï¼‰- ç§»é™¤æ‰€æœ‰å†—ä½™å…¼å®¹ä»£ç 
3. **æµ‹è¯•éªŒè¯**ï¼ˆ1-2å°æ—¶ï¼‰- è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶

---

**æ–‡æ¡£ä¿®æ­£æ—¶é—´**ï¼š2025-09-19
**åˆ†æå·¥å…·**ï¼šSerena MCP + æ·±åº¦ä»£ç åˆ†æ
**ä¿®æ­£åé£é™©ç­‰çº§**ï¼šğŸ”´ é«˜é£é™©ï¼ˆæ¶æ„ä¸ä¸€è‡´ï¼‰+ ğŸ”´ é«˜é£é™©ï¼ˆå†—ä½™å…¼å®¹å±‚ï¼‰
**å»ºè®®æ‰§è¡Œæ—¶é—´**ï¼šç«‹å³æ‰§è¡Œï¼ˆé¿å…ç”Ÿäº§ç¯å¢ƒæ•…éšœ + æ¸…ç†å†—ä½™ä»£ç ï¼‰

## 9. ğŸ“ StorageServiceèŒè´£æ˜ç¡®åŒ–

### 9.1 ä¿®æ­£åçš„æœåŠ¡èŒè´£
```typescript
/**
 * StorageService - æŒä¹…åŒ–å­˜å‚¨æœåŠ¡
 *
 * å”¯ä¸€èŒè´£ï¼š
 * - å°†ç¬¬ä¸‰æ–¹SDKè·å–çš„æ•°æ®å†™å…¥MongoDB
 * - æ•°æ®å‹ç¼©å’Œè§£å‹ç¼©ï¼ˆä»…æ–°æ ¼å¼ï¼‰
 * - æ•°æ®å®Œæ•´æ€§éªŒè¯
 *
 * æ˜ç¡®ä¸è´Ÿè´£ï¼š
 * - ç¼“å­˜æ“ä½œï¼ˆä½¿ç”¨CommonCacheServiceï¼‰
 * - å†å²æ•°æ®å…¼å®¹ï¼ˆæ— å†å²æ•°æ®ï¼‰
 * - å¤šç§å­˜å‚¨ç±»å‹æ”¯æŒï¼ˆä»…PERSISTENTï¼‰
 * - å¤æ‚çš„æ•°æ®æ ¼å¼å…¼å®¹å±‚
 */
```

### 9.2 ç®€åŒ–åçš„æ¶æ„
```
ç¬¬ä¸‰æ–¹SDKæ•°æ® â†’ StorageService â†’ MongoDB
                     â†“
               ï¼ˆä»…å‹ç¼©/è§£å‹ç¼©ï¼‰
```

è¿™ä¸ªä¿®æ­£å°†StorageServiceä»"å¤æ‚çš„å¤šåŠŸèƒ½å­˜å‚¨æœåŠ¡"ç®€åŒ–ä¸º"çº¯ç²¹çš„æŒä¹…åŒ–å­˜å‚¨æœåŠ¡"ï¼Œç¬¦åˆå•ä¸€èŒè´£åŸåˆ™ã€‚