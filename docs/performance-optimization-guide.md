# æ€§èƒ½ä¼˜åŒ–å’Œç›‘æ§ç³»ç»ŸæŒ‡å—

## ğŸ“Š ç³»ç»Ÿæ¦‚è§ˆ

æ™ºèƒ½è‚¡ç¥¨æ•°æ®ç³»ç»Ÿçš„æ€§èƒ½ä¼˜åŒ–å’Œç›‘æ§ç³»ç»Ÿä¸ºç¡®ä¿ç³»ç»Ÿé«˜æ•ˆè¿è¡Œã€åŠæ—¶å‘ç°é—®é¢˜å¹¶è‡ªåŠ¨å‘Šè­¦è€Œè®¾è®¡ã€‚æœ¬ç³»ç»Ÿæä¾›å…¨æ–¹ä½çš„æ€§èƒ½ç›‘æ§ã€æ™ºèƒ½ç¼“å­˜ä¼˜åŒ–å’Œå®æ—¶å‘Šè­¦åŠŸèƒ½ã€‚

### ğŸ¯ æ ¸å¿ƒç‰¹æ€§

- **å…¨é“¾è·¯æ€§èƒ½ç›‘æ§** - APIå“åº”æ—¶é—´ã€æ•°æ®åº“æŸ¥è¯¢ã€ç¼“å­˜å‘½ä¸­ç‡
- **æ™ºèƒ½å‘Šè­¦ç³»ç»Ÿ** - åŸºäºè§„åˆ™çš„è‡ªåŠ¨å‘Šè­¦ï¼Œæ”¯æŒå¤šç§é€šçŸ¥æ¸ é“
- **ç¼“å­˜ä¼˜åŒ–ç­–ç•¥** - Redisæ™ºèƒ½ç¼“å­˜ï¼Œæ”¯æŒå‹ç¼©å’Œåˆ†å¸ƒå¼é”
- **å®æ—¶ç›‘æ§é¢æ¿** - æä¾›å®Œæ•´çš„ç³»ç»Ÿå¥åº·çŠ¶æ€å’Œæ€§èƒ½æŒ‡æ ‡
- **è‡ªåŠ¨ä¼˜åŒ–å»ºè®®** - åŸºäºå†å²æ•°æ®å’Œå½“å‰çŠ¶æ€ç”Ÿæˆä¼˜åŒ–å»ºè®®

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### ç›‘æ§ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç›‘æ§é¢æ¿                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”‚ æ€§èƒ½æŒ‡æ ‡    â”‚ â”‚ å‘Šè­¦ç®¡ç†    â”‚ â”‚ ç¼“å­˜çŠ¶æ€    â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ç›‘æ§æ§åˆ¶å™¨å±‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  æ€§èƒ½ç›‘æ§    â”‚ â”‚   å‘Šè­¦æœåŠ¡   â”‚ â”‚  ç¼“å­˜ä¼˜åŒ–    â”‚       â”‚
â”‚  â”‚  Controller  â”‚ â”‚  Controller  â”‚ â”‚  Controller  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      æœåŠ¡å±‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚Performance   â”‚ â”‚  Alerting    â”‚ â”‚Cache         â”‚       â”‚
â”‚  â”‚Monitor       â”‚ â”‚  Service     â”‚ â”‚Optimization  â”‚       â”‚
â”‚  â”‚Service       â”‚ â”‚              â”‚ â”‚Service       â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     æ•°æ®å±‚                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚    Redis     â”‚ â”‚   MongoDB    â”‚ â”‚  äº‹ä»¶ç³»ç»Ÿ    â”‚       â”‚
â”‚  â”‚  (æŒ‡æ ‡ç¼“å­˜)   â”‚ â”‚ (å†å²æ•°æ®)    â”‚ â”‚ (å®æ—¶é€šçŸ¥)    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

#### 1. PerformanceMonitorService (æ€§èƒ½ç›‘æ§æœåŠ¡)
- **åŠŸèƒ½**: æ”¶é›†å’Œåˆ†æç³»ç»Ÿæ€§èƒ½æŒ‡æ ‡
- **ç›‘æ§èŒƒå›´**: APIå“åº”æ—¶é—´ã€æ•°æ®åº“æ€§èƒ½ã€ç³»ç»Ÿèµ„æºä½¿ç”¨
- **æ•°æ®å­˜å‚¨**: Redisæ—¶åºæ•°æ® + å†…å­˜ç¼“å†²åŒº
- **æŒ‡æ ‡ç±»å‹**: ç«¯ç‚¹æ€§èƒ½ã€æ•°æ®åº“æŸ¥è¯¢ã€ç¼“å­˜æ“ä½œã€è®¤è¯æ€§èƒ½

#### 2. AlertingService (å‘Šè­¦æœåŠ¡)
- **åŠŸèƒ½**: åŸºäºè§„åˆ™çš„æ™ºèƒ½å‘Šè­¦ç³»ç»Ÿ
- **å‘Šè­¦ç±»å‹**: æ€§èƒ½å‘Šè­¦ã€é”™è¯¯å‘Šè­¦ã€èµ„æºå‘Šè­¦
- **é€šçŸ¥æ¸ é“**: æ—¥å¿—ã€Webhookã€é‚®ä»¶ã€Slack
- **å‘Šè­¦ç­–ç•¥**: é˜ˆå€¼æ£€æµ‹ã€æŒç»­æ—¶é—´ã€å†·å´æ—¶é—´

#### 3. CacheService (ç¼“å­˜ä¼˜åŒ–æœåŠ¡)
- **åŠŸèƒ½**: æ™ºèƒ½ç¼“å­˜ç®¡ç†å’Œä¼˜åŒ–
- **ä¼˜åŒ–ç­–ç•¥**: è‡ªåŠ¨å‹ç¼©ã€åˆ†å¸ƒå¼é”ã€å‘½ä¸­ç‡åˆ†æ
- **ç¼“å­˜æ¨¡å¼**: ç›´å†™ã€å›å†™ã€ç©¿é€ä¿æŠ¤
- **ç›‘æ§æŒ‡æ ‡**: å‘½ä¸­ç‡ã€å†…å­˜ä½¿ç”¨ã€æ“ä½œå»¶è¿Ÿ

---

## ğŸ“ˆ æ€§èƒ½ç›‘æ§

### ç›‘æ§æŒ‡æ ‡ä½“ç³»

#### APIæ€§èƒ½æŒ‡æ ‡
```typescript
interface EndpointMetrics {
  endpoint: string;              // APIç«¯ç‚¹
  method: string;                // HTTPæ–¹æ³•
  totalRequests: number;         // æ€»è¯·æ±‚æ•°
  successfulRequests: number;    // æˆåŠŸè¯·æ±‚æ•°
  failedRequests: number;        // å¤±è´¥è¯·æ±‚æ•°
  averageResponseTime: number;   // å¹³å‡å“åº”æ—¶é—´
  p95ResponseTime: number;       // 95ç™¾åˆ†ä½å“åº”æ—¶é—´
  p99ResponseTime: number;       // 99ç™¾åˆ†ä½å“åº”æ—¶é—´
  lastMinuteRequests: number;    // æœ€è¿‘ä¸€åˆ†é’Ÿè¯·æ±‚æ•°
  errorRate: number;             // é”™è¯¯ç‡
}
```

#### æ•°æ®åº“æ€§èƒ½æŒ‡æ ‡
```typescript
interface DatabaseMetrics {
  connectionPoolSize: number;    // è¿æ¥æ± å¤§å°
  activeConnections: number;     // æ´»è·ƒè¿æ¥æ•°
  waitingConnections: number;    // ç­‰å¾…è¿æ¥æ•°
  averageQueryTime: number;      // å¹³å‡æŸ¥è¯¢æ—¶é—´
  slowQueries: number;           // æ…¢æŸ¥è¯¢æ•°é‡
  totalQueries: number;          // æ€»æŸ¥è¯¢æ•°
}
```

#### ç¼“å­˜æ€§èƒ½æŒ‡æ ‡
```typescript
interface RedisMetrics {
  memoryUsage: number;           // å†…å­˜ä½¿ç”¨é‡
  connectedClients: number;      // è¿æ¥å®¢æˆ·ç«¯æ•°
  opsPerSecond: number;          // æ¯ç§’æ“ä½œæ•°
  hitRate: number;               // å‘½ä¸­ç‡
  evictedKeys: number;           // è¢«é©±é€çš„é”®æ•°
  expiredKeys: number;           // è¿‡æœŸé”®æ•°
}
```

#### ç³»ç»Ÿèµ„æºæŒ‡æ ‡
```typescript
interface SystemMetrics {
  cpuUsage: number;              // CPUä½¿ç”¨ç‡
  memoryUsage: number;           // å†…å­˜ä½¿ç”¨é‡
  heapUsed: number;              // å †å†…å­˜ä½¿ç”¨
  heapTotal: number;             // å †å†…å­˜æ€»é‡
  uptime: number;                // è¿è¡Œæ—¶é—´
  eventLoopLag: number;          // äº‹ä»¶å¾ªç¯å»¶è¿Ÿ
}
```

### ç›‘æ§APIç«¯ç‚¹

#### è·å–æ€§èƒ½æ‘˜è¦
```bash
GET /api/v1/monitoring/performance
Authorization: Bearer {jwt_token}
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "timestamp": "2025-07-01T10:00:00.000Z",
  "healthScore": 85,
  "summary": {
    "totalRequests": 156789,
    "averageResponseTime": 245.3,
    "errorRate": 0.023,
    "systemLoad": 0.65,
    "memoryUsage": 2.1,
    "cacheHitRate": 0.78
  },
  "endpoints": [...],
  "database": {...},
  "redis": {...},
  "system": {...}
}
```

#### è·å–ç«¯ç‚¹è¯¦ç»†æŒ‡æ ‡
```bash
GET /api/v1/monitoring/endpoints?limit=20&sortBy=totalRequests
Authorization: Bearer {jwt_token}
```

#### è·å–ç³»ç»Ÿå¥åº·çŠ¶æ€
```bash
GET /api/v1/monitoring/health
Authorization: Bearer {jwt_token}
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "status": "healthy",
  "score": 85,
  "timestamp": "2025-07-01T10:00:00.000Z",
  "issues": [
    "ç¼“å­˜å‘½ä¸­ç‡åä½"
  ],
  "recommendations": [
    "ä¼˜åŒ–ç¼“å­˜ç­–ç•¥ï¼Œå¢åŠ ç¼“å­˜æ—¶é—´",
    "é¢„çƒ­å¸¸ç”¨æ•°æ®"
  ],
  "uptime": 172800,
  "version": "1.0.0"
}
```

---

## ğŸš¨ å‘Šè­¦ç³»ç»Ÿ

### å‘Šè­¦è§„åˆ™é…ç½®

#### é»˜è®¤å‘Šè­¦è§„åˆ™

| è§„åˆ™åç§° | æŒ‡æ ‡ | é˜ˆå€¼ | æŒç»­æ—¶é—´ | ä¸¥é‡çº§åˆ« | å†·å´æ—¶é—´ |
|---------|------|------|----------|----------|----------|
| é”™è¯¯ç‡è¿‡é«˜ | api.error_rate | >5% | 2åˆ†é’Ÿ | critical | 5åˆ†é’Ÿ |
| å“åº”æ—¶é—´è¿‡æ…¢ | api.avg_response_time | >2000ms | 5åˆ†é’Ÿ | warning | 10åˆ†é’Ÿ |
| CPUä½¿ç”¨ç‡è¿‡é«˜ | system.cpu_usage | >80% | 3åˆ†é’Ÿ | warning | 5åˆ†é’Ÿ |
| å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜ | system.memory_usage_percent | >85% | 5åˆ†é’Ÿ | critical | 5åˆ†é’Ÿ |
| ç¼“å­˜å‘½ä¸­ç‡è¿‡ä½ | cache.hit_rate | <70% | 10åˆ†é’Ÿ | warning | 30åˆ†é’Ÿ |
| æ•°æ®åº“æŸ¥è¯¢è¿‡æ…¢ | db.avg_query_time | >1000ms | 5åˆ†é’Ÿ | warning | 10åˆ†é’Ÿ |

#### å‘Šè­¦è§„åˆ™ç»“æ„
```typescript
interface AlertRule {
  id: string;                    // è§„åˆ™ID
  name: string;                  // è§„åˆ™åç§°
  metric: string;                // ç›‘æ§æŒ‡æ ‡
  operator: 'gt' | 'lt' | 'eq' | 'gte' | 'lte'; // æ¯”è¾ƒæ“ä½œç¬¦
  threshold: number;             // é˜ˆå€¼
  duration: number;              // æŒç»­æ—¶é—´ï¼ˆç§’ï¼‰
  severity: 'critical' | 'warning' | 'info'; // ä¸¥é‡çº§åˆ«
  enabled: boolean;              // æ˜¯å¦å¯ç”¨
  channels: AlertChannel[];      // é€šçŸ¥æ¸ é“
  cooldown: number;              // å†·å´æ—¶é—´ï¼ˆç§’ï¼‰
}
```

### å‘Šè­¦é€šçŸ¥æ¸ é“

#### 1. æ—¥å¿—é€šçŸ¥
```typescript
{
  type: 'log',
  config: {}
}
```

#### 2. Webhooké€šçŸ¥
```typescript
{
  type: 'webhook',
  config: {
    url: 'https://your-webhook-url.com/alerts',
    method: 'POST',
    headers: {
      'Authorization': 'Bearer token',
      'Content-Type': 'application/json'
    }
  }
}
```

#### 3. é‚®ä»¶é€šçŸ¥
```typescript
{
  type: 'email',
  config: {
    to: ['admin@company.com', 'dev-team@company.com'],
    subject: '[ALERT] {{severity}} - {{message}}',
    template: 'alert-template'
  }
}
```

#### 4. Slacké€šçŸ¥
```typescript
{
  type: 'slack',
  config: {
    webhook: 'https://hooks.slack.com/services/...',
    channel: '#alerts',
    username: 'AlertBot'
  }
}
```

### å‘Šè­¦APIç«¯ç‚¹

#### è·å–æ´»è·ƒå‘Šè­¦
```bash
GET /api/v1/monitoring/alerts/active
Authorization: Bearer {jwt_token}
```

#### è·å–å‘Šè­¦å†å²
```bash
GET /api/v1/monitoring/alerts/history?limit=50
Authorization: Bearer {jwt_token}
```

#### è·å–å‘Šè­¦è§„åˆ™
```bash
GET /api/v1/monitoring/alerts/rules
Authorization: Bearer {jwt_token}
```

#### æµ‹è¯•å‘Šè­¦è§„åˆ™
```bash
POST /api/v1/monitoring/alerts/test/{ruleId}
Authorization: Bearer {jwt_token}
```

---

## ğŸ¯ ç¼“å­˜ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥

#### 1. æ™ºèƒ½ç¼“å­˜è®¾ç½®
```typescript
// åŸºç¡€ç¼“å­˜è®¾ç½®
await cacheService.set('user:123', userData, {
  ttl: 3600,                     // 1å°æ—¶TTL
  compressionThreshold: 1024,    // 1KBå‹ç¼©é˜ˆå€¼
  serializer: 'json'             // åºåˆ—åŒ–æ–¹å¼
});

// æ™ºèƒ½ç¼“å­˜è·å–
const user = await cacheService.get<User>('user:123');
```

#### 2. ç¼“å­˜ç©¿é€ä¿æŠ¤
```typescript
// ä½¿ç”¨getOrSeté˜²æ­¢ç¼“å­˜å‡»ç©¿
const stockData = await cacheService.getOrSet(
  `stock:${symbol}`,
  async () => {
    return await stockDataProvider.getQuote(symbol);
  },
  { ttl: 300 } // 5åˆ†é’Ÿç¼“å­˜
);
```

#### 3. æ‰¹é‡ç¼“å­˜æ“ä½œ
```typescript
// æ‰¹é‡è·å–
const cacheKeys = symbols.map(s => `stock:${s}`);
const cachedData = await cacheService.mget<StockQuote>(cacheKeys);

// æ‰¹é‡è®¾ç½®
const entries = new Map();
stockData.forEach(data => {
  entries.set(`stock:${data.symbol}`, data);
});
await cacheService.mset(entries, 300);
```

### ç¼“å­˜æ€§èƒ½ä¼˜åŒ–

#### 1. è‡ªåŠ¨å‹ç¼©
```typescript
// å½“æ•°æ®è¶…è¿‡é˜ˆå€¼æ—¶è‡ªåŠ¨å‹ç¼©
const config: CacheConfig = {
  ttl: 3600,
  compressionThreshold: 1024,    // 1KBä»¥ä¸Šè‡ªåŠ¨å‹ç¼©
  maxMemory: 512 * 1024 * 1024   // 512MBå†…å­˜é™åˆ¶
};
```

#### 2. åˆ†å¸ƒå¼é”
```typescript
// è‡ªåŠ¨ä½¿ç”¨åˆ†å¸ƒå¼é”é˜²æ­¢ç¼“å­˜å‡»ç©¿
const result = await cacheService.getOrSet(
  'expensive-computation',
  async () => {
    // æ˜‚è´µçš„è®¡ç®—æ“ä½œ
    return await performExpensiveOperation();
  },
  { ttl: 1800 }
);
```

#### 3. ç¼“å­˜é¢„çƒ­
```typescript
// ç³»ç»Ÿå¯åŠ¨æ—¶é¢„çƒ­ç¼“å­˜
const warmupData = [
  { key: 'popular-stocks', value: popularStocks, ttl: 3600 },
  { key: 'market-status', value: marketStatus, ttl: 300 },
  { key: 'exchange-rates', value: rates, ttl: 600 }
];

await cacheService.warmup(warmupData);
```

### ç¼“å­˜ç›‘æ§æŒ‡æ ‡

#### è·å–ç¼“å­˜ç»Ÿè®¡
```bash
GET /api/v1/monitoring/cache
Authorization: Bearer {jwt_token}
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "hits": 45678,
  "misses": 12345,
  "hitRate": 0.787,
  "memoryUsage": 134217728,
  "keyCount": 5432,
  "avgTtl": 1800,
  "health": {
    "status": "healthy",
    "latency": 3,
    "errors": []
  },
  "timestamp": "2025-07-01T10:00:00.000Z"
}
```

---

## ğŸ“Š ç›‘æ§é¢æ¿

### å®Œæ•´ç›‘æ§é¢æ¿API
```bash
GET /api/v1/monitoring/dashboard
Authorization: Bearer {jwt_token}
```

**å“åº”æ•°æ®ç»“æ„:**
```json
{
  "overview": {
    "healthScore": 85,
    "status": "healthy",
    "uptime": 172800,
    "totalRequests": 156789,
    "errorRate": 0.023,
    "avgResponseTime": 245.3,
    "cacheHitRate": 0.787
  },
  "performance": {
    "endpoints": [...],
    "database": {...},
    "system": {...}
  },
  "cache": {
    "hitRate": 0.787,
    "memoryUsage": 134217728,
    "keyCount": 5432
  },
  "alerts": {
    "stats": {
      "totalRules": 6,
      "enabledRules": 6,
      "activeAlerts": 2,
      "criticalAlerts": 0,
      "warningAlerts": 2
    },
    "active": [...]
  },
  "trends": {
    "responseTime": { "trend": "improving", "change": -5.2 },
    "errorRate": { "trend": "stable", "change": 0.1 },
    "throughput": { "trend": "improving", "change": 12.3 },
    "cacheHitRate": { "trend": "stable", "change": -0.5 }
  }
}
```

### ä¼˜åŒ–å»ºè®®API
```bash
GET /api/v1/monitoring/optimization/recommendations
Authorization: Bearer {jwt_token}
```

**å“åº”ç¤ºä¾‹:**
```json
{
  "recommendations": [
    {
      "type": "cache_optimization",
      "priority": "medium",
      "description": "ç¼“å­˜å‘½ä¸­ç‡åä½ (78.7%)",
      "action": "ä¼˜åŒ–ç¼“å­˜ç­–ç•¥ï¼Œå¢åŠ ç¼“å­˜æ—¶é—´ï¼Œé¢„çƒ­å¸¸ç”¨æ•°æ®"
    },
    {
      "type": "response_time",
      "priority": "low",
      "description": "éƒ¨åˆ†ç«¯ç‚¹å“åº”æ—¶é—´åé•¿",
      "action": "ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢ï¼Œè€ƒè™‘å¢åŠ ç´¢å¼•"
    }
  ],
  "priority": {
    "high": { "count": 0, "items": [] },
    "medium": { "count": 1, "items": [...] },
    "low": { "count": 1, "items": [...] },
    "total": 2
  }
}
```

---

## ğŸ”§ æ€§èƒ½è£…é¥°å™¨

### æ•°æ®åº“æ€§èƒ½ç›‘æ§
```typescript
import { DatabasePerformance } from '../common/decorators/database-performance.decorator';

@Injectable()
export class UserService {
  @DatabasePerformance('user_query')
  async findUser(id: string): Promise<User> {
    return await this.userModel.findById(id);
  }

  @DatabasePerformance('user_creation')
  async createUser(userData: CreateUserDto): Promise<User> {
    const user = new this.userModel(userData);
    return await user.save();
  }
}
```

### è®¤è¯æ€§èƒ½ç›‘æ§
```typescript
import { AuthPerformance } from '../common/decorators/database-performance.decorator';

@Injectable()
export class AuthService {
  @AuthPerformance('jwt')
  async validateJwtToken(token: string): Promise<User> {
    // JWTéªŒè¯é€»è¾‘
  }

  @AuthPerformance('api_key')
  async validateApiKey(appKey: string, accessToken: string): Promise<ApiKey> {
    // API KeyéªŒè¯é€»è¾‘
  }
}
```

### ç¼“å­˜æ€§èƒ½ç›‘æ§
```typescript
import { CachePerformance } from '../common/decorators/database-performance.decorator';

@Injectable()
export class DataService {
  @CachePerformance('get')
  async getCachedData(key: string): Promise<any> {
    return await this.redis.get(key);
  }

  @CachePerformance('set')
  async setCachedData(key: string, value: any): Promise<void> {
    await this.redis.setex(key, 3600, JSON.stringify(value));
  }
}
```

---

## ğŸ“‹ æœ€ä½³å®è·µ

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

#### 1. APIå“åº”æ—¶é—´ä¼˜åŒ–
- **æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–**: ä½¿ç”¨ç´¢å¼•ã€ä¼˜åŒ–æŸ¥è¯¢è¯­å¥
- **ç¼“å­˜ç­–ç•¥**: åˆç†è®¾ç½®ç¼“å­˜TTLï¼Œé¢„çƒ­çƒ­ç‚¹æ•°æ®
- **æ‰¹é‡æ“ä½œ**: é¿å…N+1æŸ¥è¯¢ï¼Œä½¿ç”¨æ‰¹é‡æ¥å£
- **å¼‚æ­¥å¤„ç†**: å°†è€—æ—¶æ“ä½œç§»è‡³åå°å¤„ç†

#### 2. å†…å­˜ä½¿ç”¨ä¼˜åŒ–
- **å¯¹è±¡æ± å¤ç”¨**: é‡ç”¨å¸¸ç”¨å¯¹è±¡ï¼Œå‡å°‘GCå‹åŠ›
- **æ•°æ®ç»“æ„ä¼˜åŒ–**: é€‰æ‹©åˆé€‚çš„æ•°æ®ç»“æ„
- **å†…å­˜æ³„æ¼æ£€æµ‹**: å®šæœŸæ£€æŸ¥å†…å­˜ä½¿ç”¨æƒ…å†µ
- **ç¼“å­˜å¤§å°æ§åˆ¶**: è®¾ç½®åˆç†çš„ç¼“å­˜å®¹é‡é™åˆ¶

#### 3. æ•°æ®åº“æ€§èƒ½ä¼˜åŒ–
- **ç´¢å¼•ä¼˜åŒ–**: ä¸ºé¢‘ç¹æŸ¥è¯¢çš„å­—æ®µæ·»åŠ ç´¢å¼•
- **è¿æ¥æ± é…ç½®**: åˆç†è®¾ç½®è¿æ¥æ± å¤§å°
- **æŸ¥è¯¢ä¼˜åŒ–**: é¿å…å…¨è¡¨æ‰«æï¼Œä¼˜åŒ–å¤æ‚æŸ¥è¯¢
- **è¯»å†™åˆ†ç¦»**: è€ƒè™‘ä½¿ç”¨è¯»å†™åˆ†ç¦»æ¶æ„

#### 4. ç¼“å­˜ä½¿ç”¨ä¼˜åŒ–
- **ç¼“å­˜ç²’åº¦**: é€‰æ‹©åˆé€‚çš„ç¼“å­˜ç²’åº¦
- **ç¼“å­˜æ›´æ–°**: åŠæ—¶æ›´æ–°æˆ–åˆ é™¤è¿‡æœŸæ•°æ®
- **ç¼“å­˜é¢„çƒ­**: åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶é¢„çƒ­å¸¸ç”¨æ•°æ®
- **ç¼“å­˜ç©¿é€é˜²æŠ¤**: ä½¿ç”¨åˆ†å¸ƒå¼é”é˜²æ­¢ç¼“å­˜å‡»ç©¿

### ç›‘æ§é…ç½®å»ºè®®

#### 1. å‘Šè­¦é˜ˆå€¼è®¾ç½®
- **é”™è¯¯ç‡**: 5%ä»¥ä¸Šè§¦å‘å‘Šè­¦
- **å“åº”æ—¶é—´**: P95è¶…è¿‡2ç§’è§¦å‘å‘Šè­¦
- **CPUä½¿ç”¨ç‡**: 80%ä»¥ä¸ŠæŒç»­3åˆ†é’Ÿå‘Šè­¦
- **å†…å­˜ä½¿ç”¨ç‡**: 85%ä»¥ä¸ŠæŒç»­5åˆ†é’Ÿå‘Šè­¦

#### 2. ç›‘æ§é¢‘ç‡è®¾ç½®
- **æ€§èƒ½æŒ‡æ ‡æ”¶é›†**: æ¯30ç§’
- **å‘Šè­¦è§„åˆ™è¯„ä¼°**: æ¯30ç§’
- **æ•°æ®æ¸…ç†**: æ¯5åˆ†é’Ÿ
- **å¥åº·æ£€æŸ¥**: æ¯30åˆ†é’Ÿ

#### 3. æ•°æ®ä¿ç•™ç­–ç•¥
- **å®æ—¶æŒ‡æ ‡**: ä¿ç•™1å°æ—¶
- **å‘Šè­¦å†å²**: ä¿ç•™7å¤©
- **æ€§èƒ½ç»Ÿè®¡**: ä¿ç•™30å¤©
- **è¶‹åŠ¿æ•°æ®**: ä¿ç•™90å¤©

---

## ğŸ” æ•…éšœæ’æŸ¥

### å¸¸è§æ€§èƒ½é—®é¢˜

#### 1. å“åº”æ—¶é—´è¿‡é•¿
**ç—‡çŠ¶**: APIå“åº”æ—¶é—´è¶…è¿‡é¢„æœŸé˜ˆå€¼

**æ’æŸ¥æ­¥éª¤**:
```bash
# æŸ¥çœ‹ç«¯ç‚¹æ€§èƒ½ç»Ÿè®¡
GET /api/v1/monitoring/endpoints?sortBy=averageResponseTime

# æ£€æŸ¥æ•°æ®åº“æ€§èƒ½
GET /api/v1/monitoring/database

# æŸ¥çœ‹æ…¢æŸ¥è¯¢
GET /api/v1/monitoring/alerts/history?severity=warning
```

**ä¼˜åŒ–å»ºè®®**:
- æ£€æŸ¥æ•°æ®åº“ç´¢å¼•
- ä¼˜åŒ–ç¼“å­˜ç­–ç•¥
- è€ƒè™‘å¼‚æ­¥å¤„ç†

#### 2. å†…å­˜ä½¿ç”¨è¿‡é«˜
**ç—‡çŠ¶**: ç³»ç»Ÿå†…å­˜ä½¿ç”¨ç‡æŒç»­å‡é«˜

**æ’æŸ¥æ­¥éª¤**:
```bash
# æŸ¥çœ‹ç³»ç»Ÿèµ„æºä½¿ç”¨
GET /api/v1/monitoring/system

# æ£€æŸ¥ç¼“å­˜å†…å­˜ä½¿ç”¨
GET /api/v1/monitoring/cache

# æŸ¥çœ‹å†…å­˜ç›¸å…³å‘Šè­¦
GET /api/v1/monitoring/alerts/active
```

**ä¼˜åŒ–å»ºè®®**:
- æ£€æŸ¥å†…å­˜æ³„æ¼
- ä¼˜åŒ–ç¼“å­˜å¤§å°
- è°ƒæ•´GCç­–ç•¥

#### 3. ç¼“å­˜å‘½ä¸­ç‡ä½
**ç—‡çŠ¶**: ç¼“å­˜å‘½ä¸­ç‡ä½äºé¢„æœŸï¼ˆ<70%ï¼‰

**æ’æŸ¥æ­¥éª¤**:
```bash
# æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡
GET /api/v1/monitoring/cache

# æ£€æŸ¥ç¼“å­˜å¥åº·çŠ¶æ€
GET /api/v1/monitoring/health
```

**ä¼˜åŒ–å»ºè®®**:
- è°ƒæ•´ç¼“å­˜TTL
- å¢åŠ ç¼“å­˜é¢„çƒ­
- ä¼˜åŒ–ç¼“å­˜é”®è®¾è®¡

#### 4. æ•°æ®åº“æŸ¥è¯¢æ…¢
**ç—‡çŠ¶**: æ•°æ®åº“æŸ¥è¯¢æ—¶é—´è¶…è¿‡é¢„æœŸ

**æ’æŸ¥æ­¥éª¤**:
```bash
# æŸ¥çœ‹æ•°æ®åº“æ€§èƒ½æŒ‡æ ‡
GET /api/v1/monitoring/database

# æ£€æŸ¥æ…¢æŸ¥è¯¢å‘Šè­¦
GET /api/v1/monitoring/alerts/history?type=slow_queries
```

**ä¼˜åŒ–å»ºè®®**:
- æ·»åŠ æ•°æ®åº“ç´¢å¼•
- ä¼˜åŒ–æŸ¥è¯¢è¯­å¥
- è€ƒè™‘åˆ†åº“åˆ†è¡¨

### ç›‘æ§æ•°æ®åˆ†æ

#### æ€§èƒ½è¶‹åŠ¿åˆ†æ
```bash
# è·å–ç›‘æ§é¢æ¿æ•°æ®
GET /api/v1/monitoring/dashboard

# æŸ¥çœ‹æ€§èƒ½è¶‹åŠ¿
{
  "trends": {
    "responseTime": {
      "trend": "improving",    // æ”¹å–„ä¸­
      "change": -5.2          // ä¸‹é™5.2%
    },
    "errorRate": {
      "trend": "stable",      // ç¨³å®š
      "change": 0.1           // ä¸Šå‡0.1%
    }
  }
}
```

#### å‘Šè­¦æ¨¡å¼åˆ†æ
```bash
# è·å–å‘Šè­¦å†å²
GET /api/v1/monitoring/alerts/history?limit=100

# åˆ†æå‘Šè­¦é¢‘ç‡å’Œæ¨¡å¼
# - å‘Šè­¦è§¦å‘æ—¶é—´åˆ†å¸ƒ
# - å‘Šè­¦ç±»å‹åˆ†å¸ƒ
# - å‘Šè­¦æŒç»­æ—¶é—´åˆ†æ
```

---

## ğŸ“š é…ç½®ç¤ºä¾‹

### ç”Ÿäº§ç¯å¢ƒé…ç½®

#### ç¯å¢ƒå˜é‡
```bash
# ç›‘æ§é…ç½®
MONITORING_ENABLED=true
MONITORING_INTERVAL=30000
ALERT_WEBHOOK_URL=https://your-webhook-url.com/alerts

# ç¼“å­˜é…ç½®
REDIS_HOST=localhost
REDIS_PORT=6379
CACHE_DEFAULT_TTL=3600
CACHE_COMPRESSION_THRESHOLD=1024

# æ€§èƒ½é…ç½®
PERFORMANCE_BUFFER_SIZE=1000
PERFORMANCE_FLUSH_INTERVAL=10000
METRICS_RETENTION_HOURS=24
```

#### Dockeréƒ¨ç½²é…ç½®
```yaml
version: '3.8'
services:
  stockapi:
    build: .
    environment:
      - MONITORING_ENABLED=true
      - REDIS_HOST=redis
      - MONGODB_URI=mongodb://mongo:27017/stockapi
    depends_on:
      - redis
      - mongo
    
  redis:
    image: redis:7.0-alpine
    command: redis-server --maxmemory 512mb --maxmemory-policy allkeys-lru
    
  mongo:
    image: mongo:6.0
    volumes:
      - mongodb_data:/data/db
```

### Kubernetesé…ç½®
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: stockapi-monitoring
spec:
  replicas: 3
  selector:
    matchLabels:
      app: stockapi
  template:
    metadata:
      labels:
        app: stockapi
    spec:
      containers:
      - name: stockapi
        image: stockapi:latest
        env:
        - name: MONITORING_ENABLED
          value: "true"
        - name: REDIS_HOST
          value: "redis-service"
        resources:
          requests:
            memory: "256Mi"
            cpu: "200m"
          limits:
            memory: "512Mi"
            cpu: "500m"
        livenessProbe:
          httpGet:
            path: /api/v1/monitoring/health
            port: 3000
          initialDelaySeconds: 30
          periodSeconds: 10
        readinessProbe:
          httpGet:
            path: /api/v1/monitoring/health
            port: 3000
          initialDelaySeconds: 5
          periodSeconds: 5
```

---

## ğŸ–ï¸ æ€»ç»“

æ™ºèƒ½è‚¡ç¥¨æ•°æ®ç³»ç»Ÿçš„æ€§èƒ½ä¼˜åŒ–å’Œç›‘æ§ç³»ç»Ÿæä¾›äº†ï¼š

âœ… **å…¨æ–¹ä½æ€§èƒ½ç›‘æ§** - APIã€æ•°æ®åº“ã€ç¼“å­˜ã€ç³»ç»Ÿèµ„æºçš„å®Œæ•´ç›‘æ§  
âœ… **æ™ºèƒ½å‘Šè­¦ç³»ç»Ÿ** - åŸºäºè§„åˆ™çš„è‡ªåŠ¨å‘Šè­¦ï¼Œæ”¯æŒå¤šç§é€šçŸ¥æ¸ é“  
âœ… **ç¼“å­˜ä¼˜åŒ–ç­–ç•¥** - æ™ºèƒ½ç¼“å­˜ç®¡ç†ï¼Œæå‡ç³»ç»Ÿå“åº”é€Ÿåº¦  
âœ… **å®æ—¶ç›‘æ§é¢æ¿** - ç›´è§‚çš„ç³»ç»Ÿå¥åº·çŠ¶æ€å’Œæ€§èƒ½æŒ‡æ ‡å±•ç¤º  
âœ… **è‡ªåŠ¨ä¼˜åŒ–å»ºè®®** - åŸºäºå†å²æ•°æ®ç”Ÿæˆçš„æ€§èƒ½ä¼˜åŒ–å»ºè®®  
âœ… **å®Œæ•´çš„æ•…éšœæ’æŸ¥** - è¯¦ç»†çš„æ’æŸ¥æ­¥éª¤å’Œä¼˜åŒ–å»ºè®®  

ç³»ç»Ÿå·²å‡†å¤‡å¥½ä¸ºç”Ÿäº§ç¯å¢ƒæä¾›ç¨³å®šã€é«˜æ€§èƒ½çš„ç›‘æ§å’Œä¼˜åŒ–æœåŠ¡ã€‚

---

*æ–‡æ¡£ç‰ˆæœ¬: v1.0.0*  
*æœ€åæ›´æ–°: 2025-07-01*  
*ç»´æŠ¤å›¢é˜Ÿ: æ™ºèƒ½è‚¡ç¥¨æ•°æ®ç³»ç»Ÿå¼€å‘ç»„*