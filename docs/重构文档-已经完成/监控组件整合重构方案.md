# ğŸ“Š ç›‘æ§ç»„ä»¶æ•´åˆé‡æ„æ–¹æ¡ˆ

## ğŸ“‹ æ–‡æ¡£ä¿¡æ¯
- **åˆ›å»ºæ—¥æœŸ**: 2025-01-23
- **æ–‡æ¡£ç‰ˆæœ¬**: v1.6
- **è´Ÿè´£äºº**: ç³»ç»Ÿæ¶æ„å›¢é˜Ÿ
- **å®¡æ ¸çŠ¶æ€**: å·²ä¼˜åŒ–
- **é¢„è®¡å·¥æœŸ**: 12ä¸ªå·¥ä½œæ—¥
- **ä¿®è®¢è¯´æ˜**: ä¿æŒåŸç›®å½•åï¼Œå‡å°‘ä¸å¿…è¦çš„é‡å‘½å

---

## ğŸ¯ ä¸€ã€ç°çŠ¶åˆ†æ

### 1.1 å½“å‰ç›‘æ§ç»„ä»¶åˆ†å¸ƒ

ç³»ç»Ÿä¸­å­˜åœ¨ä¸‰ä¸ªåˆ†æ•£çš„ç›‘æ§ç›¸å…³ç»„ä»¶ï¼Œä½ç½®åˆ†æ•£ä¸”èŒè´£é‡å ï¼š

#### 1. **system-status ç»„ä»¶** (`/src/system-status/`)
- **å®šä½**: åº”ç”¨å±‚ç›‘æ§ä»ªè¡¨æ¿ç³»ç»Ÿ
- **æ¶æ„**: Collector â†’ Analyzer â†’ Presenter (ä¸‰å±‚æ¶æ„)
- **è§„æ¨¡**: 4ä¸ªå­æ¨¡å—ï¼Œ20+ä¸ªæœåŠ¡æ–‡ä»¶
- **åŠŸèƒ½**: 
  - æ•°æ®æ”¶é›† (HTTPè¯·æ±‚ã€æ•°æ®åº“ã€ç³»ç»ŸæŒ‡æ ‡)
  - æ•°æ®åˆ†æ (æ€§èƒ½åˆ†æã€å¥åº·è¯„åˆ†ã€è¶‹åŠ¿åˆ†æ)
  - æ•°æ®å±•ç¤º (12ä¸ªç›‘æ§APIç«¯ç‚¹)

#### 2. **common/core/monitoring ç»„ä»¶** (`/src/common/core/monitoring/`)
- **å®šä½**: åº•å±‚ç›‘æ§åŸºç¡€è®¾æ–½
- **æ¶æ„**: è£…é¥°å™¨ + æ³¨å†Œè¡¨ + æ‹¦æˆªå™¨
- **è§„æ¨¡**: 68ä¸ªPrometheusè‡ªå®šä¹‰æŒ‡æ ‡
- **åŠŸèƒ½**:
  - PrometheusæŒ‡æ ‡æ³¨å†Œ (InfrastructureMetricsRegistryService)
  - æ€§èƒ½ç›‘æ§è£…é¥°å™¨ (DatabasePerformanceç­‰)
  - æ€§èƒ½æ‹¦æˆªå™¨ (PerformanceInterceptor)

#### 3. **performance-monitoring è£…é¥°å™¨** (`/src/common/core/decorators/performance-monitoring.decorator.ts`)
- **å®šä½**: æ§åˆ¶å™¨çº§æ€§èƒ½ç›‘æ§å¼€å…³
- **æ¶æ„**: å…ƒæ•°æ®è£…é¥°å™¨æ¨¡å¼
- **åŠŸèƒ½**:
  - æ€§èƒ½ç›‘æ§å¯ç”¨/ç¦ç”¨æ§åˆ¶
  - é‡‡æ ·ç‡é…ç½®
  - æ…¢è¯·æ±‚è·Ÿè¸ªé…ç½®

### 1.2 å­˜åœ¨çš„é—®é¢˜

#### ğŸ”´ ä¸¥é‡é—®é¢˜
1. **åŠŸèƒ½é‡å¤å»ºè®¾**
   - system-statuså’Œcommon/monitoringéƒ½åœ¨æ”¶é›†æ€§èƒ½æ•°æ®
   - ä¸¤å¥—ç‹¬ç«‹çš„æ•°æ®åº“ç›‘æ§ç³»ç»Ÿ
   - é‡å¤çš„å¥åº·æ£€æŸ¥å®ç°

2. **æ¶æ„èŒè´£æ··ä¹±**
   - system-statusæ—¢åšåŸºç¡€ç›‘æ§åˆåšåº”ç”¨ç›‘æ§
   - common/monitoringæ•£è½åœ¨commonç›®å½•ä¸‹ï¼Œä¸æ˜“å‘ç°
   - æ€§èƒ½è£…é¥°å™¨åˆ†æ•£åœ¨ä¸åŒä½ç½®

3. **ç»´æŠ¤æˆæœ¬é«˜**
   - ä¿®æ”¹ç›‘æ§é€»è¾‘éœ€è¦æ”¹åŠ¨å¤šå¤„
   - æ–°å¢ç›‘æ§æŒ‡æ ‡ä¸çŸ¥é“åŠ åœ¨å“ªé‡Œ
   - ç¼ºä¹ç»Ÿä¸€çš„ç›‘æ§æ¡†æ¶

#### ğŸŸ¡ ä¸­ç­‰é—®é¢˜
- ç›‘æ§é…ç½®åˆ†æ•£ï¼Œéš¾ä»¥ç»Ÿä¸€ç®¡ç†
- æŒ‡æ ‡å‘½åä¸ä¸€è‡´
- ç¼ºå°‘ç›‘æ§æ–‡æ¡£

#### ğŸŸ¢ æ¬¡è¦é—®é¢˜
- éƒ¨åˆ†ä»£ç é‡å¤
- å¯¼å…¥è·¯å¾„è¿‡é•¿
- æµ‹è¯•è¦†ç›–ä¸å…¨

---

## ğŸ¯ äºŒã€é‡æ„ç›®æ ‡

### 2.1 æ ¸å¿ƒç›®æ ‡
1. **å»ºç«‹ç»Ÿä¸€çš„ç›‘æ§æ¡†æ¶**: æ‰€æœ‰ç›‘æ§åŠŸèƒ½é›†ä¸­åœ¨ä¸€ä¸ªæ¨¡å—
2. **æ¸…æ™°çš„åˆ†å±‚æ¶æ„**: åŸºç¡€è®¾æ–½â†’æ”¶é›†â†’åˆ†æâ†’å±•ç¤º
3. **æ¶ˆé™¤åŠŸèƒ½é‡å¤**: ä¸€ä¸ªåŠŸèƒ½åªåœ¨ä¸€å¤„å®ç°
4. **æå‡å¯ç»´æŠ¤æ€§**: ç»Ÿä¸€çš„ä»£ç ç»„ç»‡å’Œå‘½åè§„èŒƒ

### 2.2 é¢„æœŸæ”¶ç›Š
- **å‡å°‘30%ä»£ç é‡**: æ¶ˆé™¤é‡å¤ä»£ç 
- **æå‡50%å¼€å‘æ•ˆç‡**: æ¸…æ™°çš„ä»£ç ç»„ç»‡
- **é™ä½60%ç»´æŠ¤æˆæœ¬**: ç»Ÿä¸€çš„ç›‘æ§æ¡†æ¶

---

## ğŸ“ ä¸‰ã€ç›®æ ‡æ¶æ„è®¾è®¡

### 3.1 æ–°çš„æ¨¡å—ç»“æ„

```
src/monitoring/  (æ–°çš„ç»Ÿä¸€ç›‘æ§æ¨¡å—)
â”œâ”€â”€ infrastructure/     # åŸºç¡€è®¾æ–½å±‚ (åŸ common/core/monitoring)
â”‚   â”œâ”€â”€ metrics/
â”‚   â”‚   â”œâ”€â”€ infrastructure-metrics-registry.service.ts # Prometheus æ³¨å†Œè¡¨
â”‚   â”‚   â”œâ”€â”€ infrastructure-metrics.module.ts           # æŒ‡æ ‡æ¨¡å—
â”‚   â”‚   â””â”€â”€ infrastructure-metrics.constants.ts        # æŒ‡æ ‡å¸¸é‡
â”‚   â”œâ”€â”€ decorators/
â”‚   â”‚   â”œâ”€â”€ infrastructure-database-performance.decorator.ts
â”‚   â”‚   â”œâ”€â”€ infrastructure-auth-performance.decorator.ts
â”‚   â”‚   â””â”€â”€ infrastructure-monitoring-config.decorator.ts # åŸ performance-monitoring
â”‚   â”œâ”€â”€ interceptors/
â”‚   â”‚   â”œâ”€â”€ infrastructure-performance.interceptor.ts  # æ€§èƒ½æ‹¦æˆªå™¨
â”‚   â”‚   â””â”€â”€ infrastructure-metrics.interceptor.ts      # æŒ‡æ ‡æ”¶é›†æ‹¦æˆªå™¨
â”‚   â””â”€â”€ infrastructure.module.ts
â”‚
â”œâ”€â”€ collector/          # æ•°æ®æ”¶é›†å±‚ (åŸ system-status/collector)
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ collector.service.ts           # ç»Ÿä¸€æ•°æ®æ”¶é›†æœåŠ¡
â”‚   â”œâ”€â”€ repositories/
â”‚   â”‚   â””â”€â”€ collector.repository.ts        # æ•°æ®æŒä¹…åŒ–
â”‚   â”œâ”€â”€ interceptors/
â”‚   â”‚   â””â”€â”€ collector.interceptor.ts       # æ”¶é›†æ‹¦æˆªå™¨
â”‚   â””â”€â”€ collector.module.ts
â”‚
â”œâ”€â”€ analyzer/           # æ•°æ®åˆ†æå±‚ (åŸ system-status/analyzer)
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ analyzer.service.ts            # åˆ†æåè°ƒå™¨
â”‚   â”‚   â”œâ”€â”€ analyzer-health.service.ts     # å¥åº·åˆ†æ
â”‚   â”‚   â””â”€â”€ analyzer-trend.service.ts      # è¶‹åŠ¿åˆ†æ
â”‚   â”œâ”€â”€ calculators/
â”‚   â”‚   â”œâ”€â”€ analyzer-health-score.calculator.ts # å¥åº·åˆ†æ•°è®¡ç®—
â”‚   â”‚   â””â”€â”€ analyzer-metrics.calculator.ts      # æŒ‡æ ‡è®¡ç®—
â”‚   â””â”€â”€ analyzer.module.ts
â”‚
â”œâ”€â”€ presenter/          # å±•ç¤ºå±‚ (åŸ system-status/presenter)
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â””â”€â”€ presenter.controller.ts        # å±•ç¤ºå±‚API
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ presenter.service.ts           # å±•ç¤ºä¸šåŠ¡é€»è¾‘
â”‚   â”‚   â””â”€â”€ presenter-error-handler.service.ts # é”™è¯¯å¤„ç†
â”‚   â”œâ”€â”€ dto/
â”‚   â”‚   â”œâ”€â”€ presenter-query.dto.ts         # æŸ¥è¯¢DTO
â”‚   â”‚   â””â”€â”€ presenter-response.dto.ts      # å“åº”DTO
â”‚   â””â”€â”€ presenter.module.ts
â”‚
â”œâ”€â”€ shared/            # å…±äº«èµ„æº
â”‚   â”œâ”€â”€ interfaces/
â”‚   â”‚   â”œâ”€â”€ monitoring-collector.interface.ts
â”‚   â”‚   â”œâ”€â”€ monitoring-analyzer.interface.ts
â”‚   â”‚   â””â”€â”€ monitoring.interface.ts
â”‚   â”œâ”€â”€ types/
â”‚   â”‚   â””â”€â”€ monitoring.types.ts
â”‚   â”œâ”€â”€ constants/
â”‚   â”‚   â””â”€â”€ monitoring.constants.ts
â”‚   â””â”€â”€ utils/
â”‚       â””â”€â”€ monitoring.utils.ts
â”‚
â””â”€â”€ monitoring.module.ts  # ä¸»æ¨¡å—

```

### 3.2 åˆ†å±‚èŒè´£å®šä¹‰

#### åŸºç¡€è®¾æ–½å±‚ (Infrastructure)
- **èŒè´£**: æä¾›ç›‘æ§åŸºç¡€èƒ½åŠ›
- **ç»„ä»¶**: 
  - PrometheusæŒ‡æ ‡æ³¨å†Œ
  - æ€§èƒ½ç›‘æ§è£…é¥°å™¨
  - ç›‘æ§æ‹¦æˆªå™¨
- **ä¸åŒ…å«**: ä¸šåŠ¡é€»è¾‘ã€æ•°æ®åˆ†æ

#### æ•°æ®æ”¶é›†å±‚ (Collection)
- **èŒè´£**: æ”¶é›†åŸå§‹ç›‘æ§æ•°æ®
- **ç»„ä»¶**:
  - HTTPè¯·æ±‚ç›‘æ§
  - æ•°æ®åº“æ“ä½œç›‘æ§
  - ç³»ç»ŸæŒ‡æ ‡æ”¶é›†
- **ä¸åŒ…å«**: æ•°æ®åˆ†æã€å±•ç¤ºé€»è¾‘

#### æ•°æ®åˆ†æå±‚ (Analysis)
- **èŒè´£**: åˆ†æå’Œè®¡ç®—ç›‘æ§æŒ‡æ ‡
- **ç»„ä»¶**:
  - æ€§èƒ½åˆ†æ
  - å¥åº·è¯„åˆ†
  - è¶‹åŠ¿åˆ†æ
  - ä¼˜åŒ–å»ºè®®
- **ä¸åŒ…å«**: æ•°æ®æ”¶é›†ã€APIå±•ç¤º

#### å±•ç¤ºå±‚ (Presentation)
- **èŒè´£**: å¯¹å¤–æä¾›ç›‘æ§API
- **ç»„ä»¶**:
  - RESTful APIç«¯ç‚¹
  - æ•°æ®æ ¼å¼åŒ–
  - æƒé™æ§åˆ¶
- **ä¸åŒ…å«**: æ•°æ®æ”¶é›†ã€åˆ†æé€»è¾‘

---

## ğŸ“… å››ã€å®æ–½è®¡åˆ’

### 4.1 Phase 1: ç›®å½•ç»“æ„é‡ç»„ (ç¬¬1å¤©)

#### ä»»åŠ¡æ¸…å•
- [ ] é‡å‘½åç°æœ‰çš„ system-status ç›®å½•
- [ ] åˆ›å»ºæ–°çš„ monitoring ç›®å½•ç»“æ„
- [ ] å»ºç«‹å®Œæ•´çš„å­ç›®å½•ä½“ç³»

#### å…·ä½“æ­¥éª¤
```bash
# 1. å¤‡ä»½å¹¶é‡å‘½åç°æœ‰ç›®å½•
mv src/system-status src/system-status-backup
mv src/common/core/monitoring src/common/core/monitoring-backup

# 2. åˆ›å»ºæ–°çš„ç›‘æ§ç›®å½•ç»“æ„
mkdir -p src/monitoring/{infrastructure,collector,analyzer,presenter,shared}

# 3. åˆ›å»ºåŸºç¡€è®¾æ–½å±‚å­ç›®å½•
mkdir -p src/monitoring/infrastructure/{metrics,decorators,interceptors}

# 4. åˆ›å»ºæ”¶é›†å±‚å­ç›®å½•
mkdir -p src/monitoring/collector/{services,repositories,interceptors}

# 5. åˆ›å»ºåˆ†æå±‚å­ç›®å½•
mkdir -p src/monitoring/analyzer/{services,calculators}

# 6. åˆ›å»ºå±•ç¤ºå±‚å­ç›®å½•
mkdir -p src/monitoring/presenter/{controllers,services,dto}

# 7. åˆ›å»ºå…±äº«èµ„æºå­ç›®å½•
mkdir -p src/monitoring/shared/{interfaces,types,constants,utils}
```

#### éªŒæ”¶æ ‡å‡†
- æ–°ç›®å½•ç»“æ„åˆ›å»ºå®Œæˆ
- åŸæœ‰ç›®å½•å·²å¤‡ä»½é‡å‘½å
- ç›®å½•å±‚æ¬¡ç»“æ„æ­£ç¡®

### 4.2 Phase 2: ä»£ç æ–‡ä»¶è¿ç§» (ç¬¬2å¤©)

#### ä»»åŠ¡æ¸…å•
- [ ] è¿ç§» common/core/monitoring ä¸‹çš„æ–‡ä»¶åˆ° infrastructure å±‚
- [ ] è¿ç§» system-status/collector ä¸‹çš„æ–‡ä»¶åˆ° collection å±‚  
- [ ] è¿ç§» system-status/analyzer ä¸‹çš„æ–‡ä»¶åˆ° analysis å±‚
- [ ] è¿ç§» system-status/presenter ä¸‹çš„æ–‡ä»¶åˆ° presentation å±‚
- [ ] è¿ç§»å…±äº«æ¥å£å’Œç±»å‹å®šä¹‰

#### ä»£ç è¿ç§»è·¯å¾„æ˜ å°„
```bash
# Infrastructure å±‚è¿ç§»
cp src/common/core/monitoring-backup/infrastructure/metrics-registry.service.ts \
   src/monitoring/infrastructure/metrics/

cp src/common/core/monitoring-backup/decorators/database-performance.decorator.ts \
   src/monitoring/infrastructure/decorators/

cp src/common/core/decorators/performance-monitoring.decorator.ts \
   src/monitoring/infrastructure/decorators/

# Collector å±‚è¿ç§»
cp src/system-status-backup/collector/services/* \
   src/monitoring/collector/services/

cp src/system-status-backup/collector/repositories/* \
   src/monitoring/collector/repositories/

# Analyzer å±‚è¿ç§»
cp src/system-status-backup/analyzer/services/* \
   src/monitoring/analyzer/services/

cp src/system-status-backup/analyzer/calculators/* \
   src/monitoring/analyzer/calculators/

# Presenter å±‚è¿ç§»
cp src/system-status-backup/presenter/controllers/* \
   src/monitoring/presenter/controllers/

cp src/system-status-backup/presenter/services/* \
   src/monitoring/presenter/services/

cp src/system-status-backup/presenter/dto/* \
   src/monitoring/presenter/dto/
```

#### éªŒæ”¶æ ‡å‡†
- æ‰€æœ‰åŸæœ‰ä»£ç æ–‡ä»¶å·²å¤åˆ¶åˆ°æ–°ç›®å½•
- æ–‡ä»¶å®Œæ•´æ€§æ£€æŸ¥é€šè¿‡
- æ— æ–‡ä»¶ä¸¢å¤±æˆ–æŸå

### 4.3 Phase 3: æ–‡ä»¶å’Œç±»åé‡å‘½å (ç¬¬3å¤©)

#### ä»»åŠ¡æ¸…å•
- [ ] æŒ‰ç…§å‘½åè§„èŒƒé‡å‘½åæ‰€æœ‰æ–‡ä»¶
- [ ] æ›´æ–°æ–‡ä»¶å†…çš„ç±»åå’Œå¯¼å‡ºå
- [ ] æ‰¹é‡æ›´æ–°ç±»åå¼•ç”¨
- [ ] éªŒè¯æ–‡ä»¶åä¸ç±»åä¸€è‡´æ€§

#### æ–‡ä»¶é‡å‘½åè„šæœ¬
```bash
#!/bin/bash
# æ–‡ä»¶é‡å‘½åè„šæœ¬ - rename-files.sh

# Infrastructure å±‚é‡å‘½å
cd src/monitoring/infrastructure/
mv metrics/metrics-registry.service.ts metrics/infrastructure-metrics-registry.service.ts
mv decorators/database-performance.decorator.ts decorators/infrastructure-database-performance.decorator.ts
mv decorators/performance-monitoring.decorator.ts decorators/infrastructure-monitoring-config.decorator.ts

# Collector å±‚é‡å‘½å (ä¿æŒåŸå)
cd ../collector/services/
# collector.service.ts ä¿æŒä¸å˜
cd ../repositories/
# collector.repository.ts ä¿æŒä¸å˜

# Analyzer å±‚é‡å‘½å (ä¿æŒåŸå)
cd ../../analyzer/services/
# analyzer.service.ts ä¿æŒä¸å˜
mv health-analyzer.service.ts analyzer-health.service.ts
mv trend-analyzer.service.ts analyzer-trend.service.ts
cd ../calculators/
mv health-score.calculator.ts analyzer-health-score.calculator.ts
mv metrics.calculator.ts analyzer-metrics.calculator.ts

# Presenter å±‚é‡å‘½å (ä¿æŒåŸå)
cd ../../presenter/controllers/
mv monitoring.controller.ts presenter.controller.ts
cd ../services/
mv monitoring.service.ts presenter.service.ts
mv error-handler.service.ts presenter-error-handler.service.ts
cd ../dto/
mv monitoring-query.dto.ts presenter-query.dto.ts
mv monitoring-response.dto.ts presenter-response.dto.ts
```

#### ç±»åé‡å‘½åè„šæœ¬
```bash
#!/bin/bash
# ç±»åé‡å‘½åè„šæœ¬ - rename-classes.sh

# ä½¿ç”¨ sed æ‰¹é‡æ›¿æ¢ç±»å
find src/monitoring -name "*.ts" -exec sed -i 's/class InfrastructureMetricsRegistryService/class InfrastructureMetricsRegistryService/g' {} \;
find src/monitoring -name "*.ts" -exec sed -i 's/class MonitoringController/class PresenterController/g' {} \;
find src/monitoring -name "*.ts" -exec sed -i 's/class MonitoringService/class PresenterService/g' {} \;

# æ›´æ–°å¯¼å‡ºè¯­å¥
find src/monitoring -name "*.ts" -exec sed -i 's/export class InfrastructureMetricsRegistryService/export class InfrastructureMetricsRegistryService/g' {} \;
find src/monitoring -name "*.ts" -exec sed -i 's/export class MonitoringController/export class PresenterController/g' {} \;
find src/monitoring -name "*.ts" -exec sed -i 's/export class MonitoringService/export class PresenterService/g' {} \;
```

#### éªŒæ”¶æ ‡å‡†
- æ‰€æœ‰æ–‡ä»¶å·²æŒ‰è§„èŒƒé‡å‘½å
- ç±»åä¸æ–‡ä»¶åå®Œå…¨ä¸€è‡´
- å¯¼å‡ºè¯­å¥æ­£ç¡®æ›´æ–°
- TypeScript ç¼–è¯‘æ— é”™è¯¯

### 4.4 Phase 4: åˆ›å»ºç¼ºå¤±æ–‡ä»¶ (ç¬¬4å¤©)

#### ä»»åŠ¡æ¸…å•
- [ ] åˆ†æç°æœ‰æ–‡ä»¶ä¸ç›®æ ‡æ¶æ„çš„å·®å¼‚
- [ ] åˆ›å»ºç¼ºå¤±çš„æœåŠ¡æ–‡ä»¶
- [ ] åˆ›å»ºç¼ºå¤±çš„æ¥å£æ–‡ä»¶
- [ ] åˆ›å»ºç¼ºå¤±çš„æ¨¡å—é…ç½®æ–‡ä»¶
- [ ] åˆ›å»ºåŸºç¡€çš„æµ‹è¯•æ–‡ä»¶æ¡†æ¶

#### ç¼ºå¤±æ–‡ä»¶åˆ›å»ºè„šæœ¬
```bash
#!/bin/bash
# åˆ›å»ºç¼ºå¤±æ–‡ä»¶è„šæœ¬ - create-missing-files.sh

# 1. åˆ›å»ºæ¨¡å—é…ç½®æ–‡ä»¶
touch src/monitoring/monitoring.module.ts
touch src/monitoring/infrastructure/infrastructure.module.ts
touch src/monitoring/collector/collector.module.ts
touch src/monitoring/analyzer/analyzer.module.ts
touch src/monitoring/presenter/presenter.module.ts

# 2. åˆ›å»ºç¼ºå¤±çš„æ‹¦æˆªå™¨æ–‡ä»¶
touch src/monitoring/infrastructure/interceptors/infrastructure-performance.interceptor.ts
touch src/monitoring/infrastructure/interceptors/infrastructure-metrics.interceptor.ts
touch src/monitoring/collector/interceptors/collector.interceptor.ts

# 3. åˆ›å»ºå…±äº«èµ„æºæ–‡ä»¶
touch src/monitoring/shared/interfaces/monitoring-collector.interface.ts
touch src/monitoring/shared/interfaces/monitoring-analyzer.interface.ts
touch src/monitoring/shared/interfaces/monitoring.interface.ts
touch src/monitoring/shared/types/monitoring.types.ts
touch src/monitoring/shared/constants/monitoring.constants.ts
touch src/monitoring/shared/utils/monitoring.utils.ts

# 4. åˆ›å»ºå¸¸é‡å’Œé…ç½®æ–‡ä»¶
touch src/monitoring/infrastructure/metrics/infrastructure-metrics.constants.ts
touch src/monitoring/infrastructure/metrics/infrastructure-metrics.module.ts

# 5. ä¸ºæ¯ä¸ªä¸»è¦æœåŠ¡åˆ›å»ºåŸºç¡€æµ‹è¯•æ–‡ä»¶
touch src/monitoring/infrastructure/metrics/__tests__/infrastructure-metrics-registry.service.spec.ts
touch src/monitoring/collector/services/__tests__/collector.service.spec.ts
touch src/monitoring/analyzer/services/__tests__/analyzer.service.spec.ts
touch src/monitoring/presenter/controllers/__tests__/presenter.controller.spec.ts
```

#### æ–‡ä»¶æ¨¡æ¿åˆ›å»º
```typescript
// æ¨¡æ¿: monitoring.module.ts
import { Module } from '@nestjs/common';
import { InfrastructureModule } from './infrastructure/infrastructure.module';
import { CollectorModule } from './collector/collector.module';
import { AnalyzerModule } from './analyzer/analyzer.module';
import { PresenterModule } from './presenter/presenter.module';

@Module({
  imports: [
    InfrastructureModule,
    CollectorModule,
    AnalyzerModule,
    PresenterModule,
  ],
  exports: [
    InfrastructureModule,
    CollectorModule,
    AnalyzerModule,
    PresenterModule,
  ],
})
export class MonitoringModule {}
```

#### éªŒæ”¶æ ‡å‡†
- æ‰€æœ‰å¿…éœ€æ–‡ä»¶å·²åˆ›å»º
- æ–‡ä»¶ç»“æ„å®Œæ•´æ— ç¼ºå¤±
- åŸºç¡€æ¨¡æ¿ä»£ç æ­£ç¡®
- TypeScript ç¼–è¯‘é€šè¿‡

### 4.5 Phase 5: ä»£ç é‡æ„å’Œæ•´åˆ (ç¬¬5-7å¤©)

#### ä»»åŠ¡æ¸…å•
- [ ] é‡æ„ Collection Service å†…éƒ¨é€»è¾‘
- [ ] æ•´åˆé‡å¤çš„æ•°æ®æ”¶é›†é€»è¾‘
- [ ] å¯¹æ¥ Infrastructure Metrics Registry Service
- [ ] æ¶ˆé™¤é‡å¤æŒ‡æ ‡å®šä¹‰
- [ ] æ›´æ–°æ‰€æœ‰ä¾èµ–æ³¨å…¥å…³ç³»
- [ ] é‡æ„ Analysis Service åŠç›¸å…³æœåŠ¡
- [ ] ä¼˜åŒ–åˆ†æç®—æ³•å’Œè®¡ç®—æ€§èƒ½

#### é‡æ„è¦ç‚¹
```typescript
// é‡æ„å‰ï¼šç‹¬ç«‹çš„æ”¶é›†é€»è¾‘
class CollectorService {
  private readonly metricsBuffer: RawMetric[] = [];
  recordRequest() { /* ç‹¬ç«‹å®ç° */ }
}

// é‡æ„åï¼šä½¿ç”¨ç»Ÿä¸€çš„æŒ‡æ ‡æ³¨å†Œ
// æ–‡ä»¶: src/monitoring/collector/services/collector.service.ts
export class CollectorService {
  constructor(
    private readonly InfrastructureMetricsRegistryService: InfrastructureMetricsRegistryService
  ) {}
  
  recordRequest() {
    // ä½¿ç”¨ Prometheus æŒ‡æ ‡
    this.InfrastructureMetricsRegistryService.receiverRequestsTotal.inc();
  }
}
```

#### ä¾èµ–æ³¨å…¥é‡æ„
```typescript
// å„å±‚æ¨¡å—çš„ä¾èµ–å…³ç³»
// Collector Module ä¾èµ– Infrastructure Module
@Module({
  imports: [InfrastructureModule],
  providers: [CollectorService, CollectorRepository],
  exports: [CollectorService],
})
export class CollectorModule {}

// Analyzer Module ä¾èµ– Collector Module
@Module({
  imports: [CollectorModule],
  providers: [AnalyzerService, AnalyzerHealthService],
  exports: [AnalyzerService],
})
export class AnalyzerModule {}
```

#### éªŒæ”¶æ ‡å‡†
- æ•°æ®æ”¶é›†åŠŸèƒ½æ­£å¸¸
- åˆ†æåŠŸèƒ½æ­£å¸¸è¿è¡Œ
- æ¶ˆé™¤æ‰€æœ‰é‡å¤ä»£ç 
- æ€§èƒ½æå‡20%
- ä¾èµ–æ³¨å…¥å…³ç³»æ­£ç¡®
- å•å…ƒæµ‹è¯•è¦†ç›–ç‡>80%

### 4.6 Phase 6: å±•ç¤ºå±‚æ•´åˆå’ŒAPIè®¾è®¡ (ç¬¬8-9å¤©)

#### ä»»åŠ¡æ¸…å•
- [ ] è®¾è®¡ç»Ÿä¸€çš„ API ç«¯ç‚¹
- [ ] ç»Ÿä¸€å“åº”æ ¼å¼
- [ ] é‡æ„ Presentation Service ä¸šåŠ¡é€»è¾‘
- [ ] åˆ›å»º DTO ç±»å’ŒéªŒè¯è§„åˆ™
- [ ] æ›´æ–° Swagger æ–‡æ¡£

#### API è®¾è®¡ç­–ç•¥
```typescript
// æ–‡ä»¶: src/monitoring/presenter/controllers/presenter.controller.ts
@Controller('monitoring')
export class PresenterController {
  constructor(
    private readonly presenterService: PresenterService,
    private readonly presenterErrorHandlerService: PresenterErrorHandlerService
  ) {}

  @Get('metrics')
  @ApiOperation({ summary: 'è·å–ç³»ç»ŸæŒ‡æ ‡' })
  async getMetrics(@Query() query: PresenterQueryDto): Promise<PresenterResponseDto> { 
    try {
      const metrics = await this.presenterService.getMetrics(query);
      return new PresenterResponseDto(metrics);
    } catch (error) {
      this.presenterErrorHandlerService.handleError(error);
      throw error;
    }
  }
  
  @Get('health')
  @ApiOperation({ summary: 'è·å–å¥åº·çŠ¶æ€' })
  async getHealthStatus(): Promise<PresenterResponseDto> { 
    return this.presenterService.getHealthStatus();
  }
  
  @Get('performance')  
  @ApiOperation({ summary: 'è·å–æ€§èƒ½æŒ‡æ ‡' })
  async getPerformanceMetrics(@Query() query: PresenterQueryDto): Promise<PresenterResponseDto> { 
    return this.presenterService.getPerformanceMetrics(query);
  }
}
```

#### DTO è®¾è®¡
```typescript
// æ–‡ä»¶: src/monitoring/presenter/dto/presenter-query.dto.ts
export class PresenterQueryDto {
  @IsOptional()
  @IsString()
  startTime?: string;

  @IsOptional()
  @IsString()
  endTime?: string;

  @IsOptional()
  @IsNumber()
  limit?: number;
}

// æ–‡ä»¶: src/monitoring/presenter/dto/presenter-response.dto.ts
export class PresenterResponseDto {
  statusCode: number;
  message: string;
  data: any;
  timestamp: string;

  constructor(data: any) {
    this.statusCode = 200;
    this.message = 'è·å–æˆåŠŸ';
    this.data = data;
    this.timestamp = new Date().toISOString();
  }
}
```

#### éªŒæ”¶æ ‡å‡†
- æ‰€æœ‰APIæ­£å¸¸å·¥ä½œ
- APIè®¾è®¡ç¬¦åˆRESTfulè§„èŒƒ
- DTO éªŒè¯è§„åˆ™æ­£ç¡®
- é”™è¯¯å¤„ç†æœºåˆ¶å®Œå–„
- Swaggeræ–‡æ¡£æ›´æ–°å®Œæˆ

### 4.7 Phase 7: å¯¼å…¥è·¯å¾„æ›´æ–°å’Œæ¸…ç† (ç¬¬10å¤©)

#### ä»»åŠ¡æ¸…å•
- [ ] æ›´æ–°é¡¹ç›®ä¸­æ‰€æœ‰å¯¹æ—§è·¯å¾„çš„å¼•ç”¨
- [ ] æ‰¹é‡æ›¿æ¢å¯¼å…¥è¯­å¥
- [ ] æ›´æ–°æµ‹è¯•æ–‡ä»¶ä¸­çš„å¯¼å…¥è·¯å¾„
- [ ] æ¸…ç†å·²å¤‡ä»½çš„æ—§ç›®å½•
- [ ] éªŒè¯æ‰€æœ‰å¯¼å…¥è·¯å¾„æ­£ç¡®æ€§

#### å¯¼å…¥è·¯å¾„æ›´æ–°è„šæœ¬
```bash
#!/bin/bash
# å¯¼å…¥è·¯å¾„æ›´æ–°è„šæœ¬ - update-import-paths.sh

# 1. æ›´æ–°å¯¹æ—§ç›‘æ§ç»„ä»¶çš„å¯¼å…¥
find src -name "*.ts" -not -path "*/monitoring/*" -not -path "*-backup/*" \
  -exec sed -i 's|from.*system-status/collector|from "@monitoring/collector"|g' {} \;

find src -name "*.ts" -not -path "*/monitoring/*" -not -path "*-backup/*" \
  -exec sed -i 's|from.*system-status/analyzer|from "@monitoring/analyzer"|g' {} \;

find src -name "*.ts" -not -path "*/monitoring/*" -not -path "*-backup/*" \
  -exec sed -i 's|from.*system-status/presenter|from "@monitoring/presenter"|g' {} \;

find src -name "*.ts" -not -path "*/monitoring/*" -not -path "*-backup/*" \
  -exec sed -i 's|from.*common/core/monitoring|from "@monitoring/infrastructure"|g' {} \;

# 2. æ›´æ–°æµ‹è¯•æ–‡ä»¶ä¸­çš„å¯¼å…¥è·¯å¾„
find test -name "*.ts" \
  -exec sed -i 's|from.*system-status|from "@monitoring"|g' {} \;

find test -name "*.ts" \
  -exec sed -i 's|from.*common/core/monitoring|from "@monitoring/infrastructure"|g' {} \;

# 3. æ›´æ–°ç±»åå¼•ç”¨ (ä¿æŒåŸæœ‰ç±»å)
find src -name "*.ts" -not -path "*-backup/*" \
  -exec sed -i 's/InfrastructureMetricsRegistryService/InfrastructureMetricsRegistryService/g' {} \;

find src -name "*.ts" -not -path "*-backup/*" \
  -exec sed -i 's/MonitoringController/PresenterController/g' {} \;

find src -name "*.ts" -not -path "*-backup/*" \
  -exec sed -i 's/MonitoringService/PresenterService/g' {} \;
```

#### æ¸…ç†æ—§æ–‡ä»¶
```bash
#!/bin/bash
# æ¸…ç†è„šæœ¬ - cleanup-old-files.sh

# ç¡®è®¤æ–°æ¶æ„å·¥ä½œæ­£å¸¸åæ‰§è¡Œæ¸…ç†
echo "âš ï¸  æ‰§è¡Œå‰è¯·ç¡®è®¤æ–°ç›‘æ§æ¶æ„å·²é€šè¿‡æ‰€æœ‰æµ‹è¯•"
read -p "ç»§ç»­æ¸…ç†æ—§æ–‡ä»¶? (y/N): " -n 1 -r
echo

if [[ $REPLY =~ ^[Yy]$ ]]; then
  # åˆ é™¤å¤‡ä»½çš„æ—§ç›®å½•
  rm -rf src/system-status-backup
  rm -rf src/common/core/monitoring-backup
  
  # åˆ é™¤å¯èƒ½æ®‹ç•™çš„æ—§å¯¼å…¥
  echo "æ¸…ç†å®Œæˆ"
else
  echo "æ¸…ç†å·²å–æ¶ˆ"
fi
```

#### éªŒæ”¶æ ‡å‡†
- æ‰€æœ‰å¯¼å…¥è·¯å¾„æ›´æ–°æ­£ç¡®
- TypeScript ç¼–è¯‘æ— é”™è¯¯
- æ‰€æœ‰æµ‹è¯•æ­£å¸¸è¿è¡Œ
- æ—§æ–‡ä»¶å·²å®‰å…¨æ¸…ç†

### 4.8 Phase 8: ç»¼åˆæµ‹è¯•å’Œä¼˜åŒ– (ç¬¬11-12å¤©)

#### ä»»åŠ¡æ¸…å•
- [ ] å®Œæ•´çš„å•å…ƒæµ‹è¯•
- [ ] å®Œæ•´çš„é›†æˆæµ‹è¯•
- [ ] ç«¯åˆ°ç«¯æµ‹è¯•
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•
- [ ] å‹åŠ›æµ‹è¯•
- [ ] å®‰å…¨æ‰«æ
- [ ] ä»£ç è´¨é‡å®¡æŸ¥
- [ ] æ–‡æ¡£æ›´æ–°å’Œå®Œå–„

#### æµ‹è¯•ç­–ç•¥
```bash
# 1. å•å…ƒæµ‹è¯•
npm run test:unit:monitoring
# é¢„æœŸè¦†ç›–ç‡ > 85%

# 2. é›†æˆæµ‹è¯•
npm run test:integration:monitoring  
# æµ‹è¯•å„å±‚ä¹‹é—´çš„é›†æˆ

# 3. E2E æµ‹è¯•
npm run test:e2e:monitoring
# æµ‹è¯•å®Œæ•´çš„ç›‘æ§æµç¨‹

# 4. æ€§èƒ½æµ‹è¯•
npm run test:performance:monitoring
# éªŒè¯æ€§èƒ½æå‡ç›®æ ‡
```

#### è´¨é‡é—¨ç¦
- å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 85%
- é›†æˆæµ‹è¯•è¦†ç›–ç‡ > 70%
- ä»£ç å¤æ‚åº¦ < 10
- é‡å¤ä»£ç ç‡ < 5%
- TypeScript ç¼–è¯‘ 0 é”™è¯¯
- ESLint æ£€æŸ¥ 0 è­¦å‘Š

#### æ€§èƒ½åŸºå‡†éªŒè¯
- API å“åº”æ—¶é—´ < 100ms (P95)
- å†…å­˜å ç”¨å‡å°‘ > 20%
- CPU ä½¿ç”¨ç‡å‡å°‘ > 15%
- ä»£ç é‡å‡å°‘ > 30%

#### éªŒæ”¶æ ‡å‡†
- æ‰€æœ‰æµ‹è¯•é€šè¿‡
- æ€§èƒ½åŸºå‡†è¾¾æ ‡
- ä»£ç è´¨é‡ç¬¦åˆæ ‡å‡†
- æ–‡æ¡£å®Œæ•´å‡†ç¡®
- åŠŸèƒ½å®Œå…¨å…¼å®¹

---

## ğŸš€ äº”ã€å®æ–½ç­–ç•¥

### 5.1 é£é™©æ§åˆ¶

#### å®æ–½ç­–ç•¥
1. **é˜¶æ®µ1**: åˆ›å»ºæ–°çš„ç›‘æ§æ¨¡å—æ¶æ„
2. **é˜¶æ®µ2**: è¿ç§»ç°æœ‰åŠŸèƒ½åˆ°æ–°æ¶æ„
3. **é˜¶æ®µ3**: æ¸…ç†æ—§ä»£ç å’Œæ–‡ä»¶

### 5.2 ç›‘æ§é‡æ„è¿‡ç¨‹

#### å…³é”®æŒ‡æ ‡
- APIå“åº”æ—¶é—´
- é”™è¯¯ç‡
- å†…å­˜ä½¿ç”¨
- CPUä½¿ç”¨ç‡

#### å‘Šè­¦è®¾ç½®
- é”™è¯¯ç‡ > 1% è§¦å‘å‘Šè­¦
- å“åº”æ—¶é—´ > 200ms è§¦å‘å‘Šè­¦
- å†…å­˜å¢é•¿ > 10% è§¦å‘å‘Šè­¦

---

## ğŸ“Š å…­ã€éªŒæ”¶æ ‡å‡†

### 6.1 åŠŸèƒ½éªŒæ”¶

| åŠŸèƒ½æ¨¡å— | éªŒæ”¶æ ‡å‡† | ä¼˜å…ˆçº§ |
|---------|---------|--------|
| PrometheusæŒ‡æ ‡ | 68ä¸ªæŒ‡æ ‡å…¨éƒ¨æ­£å¸¸å·¥ä½œ | P0 |
| ç›‘æ§API | æ–°APIç«¯ç‚¹å…¨éƒ¨å¯ç”¨ | P0 |
| æ€§èƒ½è£…é¥°å™¨ | è£…é¥°å™¨æ­£å¸¸å·¥ä½œ | P1 |
| æ•°æ®æ”¶é›† | æ•°æ®ç±»å‹æ­£å¸¸æ”¶é›† | P0 |
| æ•°æ®åˆ†æ | å¥åº·è¯„åˆ†è¯¯å·®<5% | P1 |

### 6.2 æ€§èƒ½éªŒæ”¶

| æŒ‡æ ‡ | å½“å‰å€¼ | ç›®æ ‡å€¼ | éªŒæ”¶æ ‡å‡† |
|-----|--------|--------|---------|
| APIå“åº”æ—¶é—´(P95) | 150ms | 100ms | <120ms |
| å†…å­˜å ç”¨ | 200MB | 150MB | <180MB |
| CPUä½¿ç”¨ç‡ | 15% | 10% | <12% |
| ä»£ç è¡Œæ•° | 5000 | 3500 | <4000 |

### 6.3 è´¨é‡éªŒæ”¶

| è´¨é‡æŒ‡æ ‡ | ç›®æ ‡å€¼ | éªŒæ”¶æ ‡å‡† |
|---------|--------|---------|
| å•å…ƒæµ‹è¯•è¦†ç›–ç‡ | 90% | >85% |
| é›†æˆæµ‹è¯•è¦†ç›–ç‡ | 80% | >70% |
| ä»£ç å¤æ‚åº¦ | <10 | <15 |
| é‡å¤ä»£ç ç‡ | <5% | <10% |
| æ–‡æ¡£å®Œæ•´åº¦ | 100% | >90% |

---

## ğŸ”§ ä¸ƒã€æŠ€æœ¯ç»†èŠ‚

### 7.1 æ–‡ä»¶åä¸ç±»åä¸€è‡´æ€§è§„èŒƒ

#### å‘½åè§„èŒƒ
```typescript
// 1. Infrastructure å±‚
// æ–‡ä»¶: infrastructure-metrics-registry.service.ts
export class InfrastructureMetricsRegistryService { }

// æ–‡ä»¶: infrastructure-database-performance.decorator.ts  
export const InfrastructureDatabasePerformance = createDecorator();

// æ–‡ä»¶: infrastructure-performance.interceptor.ts
export class InfrastructurePerformanceInterceptor { }

// 2. Collection å±‚
// æ–‡ä»¶: collection.service.ts
export class CollectionService { }

// æ–‡ä»¶: collection.repository.ts
export class CollectionRepository { }

// 3. Analysis å±‚
// æ–‡ä»¶: analysis.service.ts
export class AnalysisService { }

// æ–‡ä»¶: analysis-health-score.calculator.ts
export class AnalysisHealthScoreCalculator { }

// 4. Presentation å±‚
// æ–‡ä»¶: presentation.controller.ts
export class PresentationController { }

// æ–‡ä»¶: presentation-query.dto.ts
export class PresentationQueryDto { }
```

### 7.2 ä¾èµ–æ³¨å…¥ä¼˜åŒ–

```typescript
// é‡æ„å‰ï¼šå¤šä¸ªç‹¬ç«‹çš„æœåŠ¡
@Module({
  providers: [
    CollectorService,
    AnalyzerService,
    PresenterService,
    InfrastructureMetricsRegistryService,
    // ... åˆ†æ•£çš„æœåŠ¡
  ]
})

// é‡æ„åï¼šæ¨¡å—åŒ–çš„æœåŠ¡ç»„ç»‡
@Module({
  imports: [
    InfrastructureModule,  // åŸºç¡€è®¾æ–½æœåŠ¡
    CollectionModule,      // æ•°æ®æ”¶é›†æœåŠ¡
    AnalysisModule,        // æ•°æ®åˆ†ææœåŠ¡
    PresentationModule     // å±•ç¤ºæœåŠ¡
  ]
})
export class MonitoringModule {}
```

### 7.3 æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

#### æ‰¹å¤„ç†ä¼˜åŒ–
```typescript
// æ–‡ä»¶: src/monitoring/infrastructure/metrics/infrastructure-metrics-registry.service.ts
export class InfrastructureMetricsRegistryService {
  private batch: MetricUpdate[] = [];
  private batchTimer: NodeJS.Timer;
  
  recordMetric(metric: MetricUpdate) {
    this.batch.push(metric);
    
    if (this.batch.length >= 100) {
      this.flush();
    }
  }
  
  private flush() {
    // æ‰¹é‡æ›´æ–° Prometheus æŒ‡æ ‡
    this.registry.batchUpdate(this.batch);
    this.batch = [];
  }
}
```

### 7.4 é”™è¯¯å¤„ç†æ ‡å‡†åŒ–

```typescript
// æ–‡ä»¶: src/monitoring/presentation/services/presentation-error-handler.service.ts
export class PresentationErrorHandlerService {
  handleError(error: MonitoringError) {
    // å¤„ç†ç›‘æ§ç›¸å…³é”™è¯¯
  }
}

// æ–‡ä»¶: src/monitoring/shared/types/monitoring.types.ts
export class MonitoringError extends Error {
  constructor(
    public readonly code: string,
    public readonly component: string,
    message: string,
    public readonly details?: any
  ) {
    super(message);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
throw new MonitoringError(
  'METRICS_REGISTRY_ERROR',
  'infrastructure',
  'Failed to register metric',
  { metricName, error: originalError }
);
```

---

## ğŸ“ å…«ã€ç›¸å…³æ–‡æ¡£

### éœ€è¦æ›´æ–°çš„æ–‡æ¡£
1. APIæ–‡æ¡£ (Swagger)
2. æ¶æ„è®¾è®¡æ–‡æ¡£
3. éƒ¨ç½²æ–‡æ¡£
4. è¿ç»´æ‰‹å†Œ
5. å¼€å‘æŒ‡å—

### æ–°å¢æ–‡æ¡£
1. ç›‘æ§ç»„ä»¶ä½¿ç”¨æŒ‡å—
2. è¿ç§»æŒ‡å—
3. æ€§èƒ½è°ƒä¼˜æŒ‡å—
4. æ•…éšœæ’æŸ¥æ‰‹å†Œ

---

## âœ… ä¹ã€æˆåŠŸæ ‡å‡†

### çŸ­æœŸæˆåŠŸï¼ˆ1ä¸ªæœˆå†…ï¼‰
- âœ… æ‰€æœ‰ç›‘æ§åŠŸèƒ½æ­£å¸¸å·¥ä½œ
- âœ… æ€§èƒ½è¾¾åˆ°é¢„æœŸç›®æ ‡
- âœ… ä»£ç é‡å‡å°‘30%

### ä¸­æœŸæˆåŠŸï¼ˆ3ä¸ªæœˆå†…ï¼‰
- âœ… å¼€å‘æ•ˆç‡æå‡50%
- âœ… æ–°åŠŸèƒ½å¼€å‘æ—¶é—´å‡å°‘40%
- âœ… æ•…éšœå¤„ç†æ—¶é—´å‡å°‘30%
- âœ… ç›‘æ§è¦†ç›–ç‡è¾¾åˆ°95%

### é•¿æœŸæˆåŠŸï¼ˆ6ä¸ªæœˆå†…ï¼‰
- âœ… ç»´æŠ¤æˆæœ¬é™ä½60%
- âœ… ç³»ç»Ÿç¨³å®šæ€§æå‡åˆ°99.9%
- âœ… æˆä¸ºå…¬å¸å…¶ä»–é¡¹ç›®çš„æ ‡å‡†ç›‘æ§æ–¹æ¡ˆ
- âœ… å¼€æºç¤¾åŒºè´¡çŒ®

---

## ğŸ“Œ åã€æ³¨æ„äº‹é¡¹

### é‡è¦æé†’
1. **å…¨æ–°è®¾è®¡**: é‡‡ç”¨å…¨æ–°çš„ç›‘æ§æ¶æ„ï¼Œæ— éœ€è€ƒè™‘å†å²åŒ…è¢±
2. **æ¨¡å—åŒ–å®æ–½**: æŒ‰é˜¶æ®µé€æ­¥æ„å»ºæ–°çš„ç›‘æ§ç³»ç»Ÿ
3. **å……åˆ†æµ‹è¯•**: æ¯ä¸ªé˜¶æ®µéƒ½è¦æœ‰å®Œæ•´çš„æµ‹è¯•
4. **æ–‡æ¡£å…ˆè¡Œ**: å…ˆæ›´æ–°æ–‡æ¡£ï¼Œå†æ”¹ä»£ç 
5. **ç›‘æ§é‡æ„è¿‡ç¨‹**: å®æ—¶ç›‘æ§é‡æ„å¯¹ç³»ç»Ÿçš„å½±å“

### æ½œåœ¨é£é™©
1. **åŠŸèƒ½å®Œæ•´æ€§é£é™©**: ç¡®ä¿æ–°æ¶æ„è¦†ç›–æ‰€æœ‰å¿…è¦åŠŸèƒ½
2. **æ€§èƒ½ç›®æ ‡é£é™©**: æ–°æ¶æ„éœ€è¾¾åˆ°é¢„æœŸæ€§èƒ½æŒ‡æ ‡
3. **æ•°æ®è¿ç»­æ€§é£é™©**: ç¡®ä¿ç›‘æ§æ•°æ®çš„è¿ç»­æ€§
4. **å¼€å‘è¿›åº¦é£é™©**: ä¸¥æ ¼æŒ‰ç…§æ—¶é—´è®¡åˆ’æ‰§è¡Œ

---

## ğŸ“ åä¸€ã€è”ç³»æ–¹å¼

- **æŠ€æœ¯è´Ÿè´£äºº**: æ¶æ„å›¢é˜Ÿ
- **é¡¹ç›®ç»ç†**: å¾…å®š
- **ç´§æ€¥è”ç³»**: è¿ç»´å€¼ç­ç”µè¯

---

## ğŸ“š é™„å½•

### A. æ–‡ä»¶åä¸ç±»åæ˜ å°„è¡¨

| æ–‡ä»¶è·¯å¾„ | ç±»å | è¯´æ˜ |
|---------|------|------|
| **Infrastructure å±‚** | | |
| `infrastructure-metrics-registry.service.ts` | `InfrastructureMetricsRegistryService` | PrometheusæŒ‡æ ‡æ³¨å†Œè¡¨ |
| `infrastructure-database-performance.decorator.ts` | `InfrastructureDatabasePerformance` | æ•°æ®åº“æ€§èƒ½è£…é¥°å™¨ |
| `infrastructure-auth-performance.decorator.ts` | `InfrastructureAuthPerformance` | è®¤è¯æ€§èƒ½è£…é¥°å™¨ |
| `infrastructure-monitoring-config.decorator.ts` | `InfrastructureMonitoringConfig` | ç›‘æ§é…ç½®è£…é¥°å™¨ |
| `infrastructure-performance.interceptor.ts` | `InfrastructurePerformanceInterceptor` | æ€§èƒ½æ‹¦æˆªå™¨ |
| `infrastructure-metrics.interceptor.ts` | `InfrastructureMetricsInterceptor` | æŒ‡æ ‡æ”¶é›†æ‹¦æˆªå™¨ |
| **Collector å±‚** | | |
| `collector.service.ts` | `CollectorService` | æ•°æ®æ”¶é›†æœåŠ¡ |
| `collector.repository.ts` | `CollectorRepository` | æ•°æ®æŒä¹…åŒ–ä»“åº“ |
| `collector.interceptor.ts` | `CollectorInterceptor` | æ”¶é›†æ‹¦æˆªå™¨ |
| **Analyzer å±‚** | | |
| `analyzer.service.ts` | `AnalyzerService` | åˆ†æåè°ƒå™¨ |
| `analyzer-health.service.ts` | `AnalyzerHealthService` | å¥åº·åˆ†ææœåŠ¡ |
| `analyzer-trend.service.ts` | `AnalyzerTrendService` | è¶‹åŠ¿åˆ†ææœåŠ¡ |
| `analyzer-health-score.calculator.ts` | `AnalyzerHealthScoreCalculator` | å¥åº·åˆ†è®¡ç®—å™¨ |
| `analyzer-metrics.calculator.ts` | `AnalyzerMetricsCalculator` | æŒ‡æ ‡è®¡ç®—å™¨ |
| **Presenter å±‚** | | |
| `presenter.controller.ts` | `PresenterController` | å±•ç¤ºå±‚æ§åˆ¶å™¨ |
| `presenter.service.ts` | `PresenterService` | å±•ç¤ºä¸šåŠ¡æœåŠ¡ |
| `presenter-error-handler.service.ts` | `PresenterErrorHandlerService` | é”™è¯¯å¤„ç†æœåŠ¡ |
| `presenter-query.dto.ts` | `PresenterQueryDto` | æŸ¥è¯¢æ•°æ®ä¼ è¾“å¯¹è±¡ |
| `presenter-response.dto.ts` | `PresenterResponseDto` | å“åº”æ•°æ®ä¼ è¾“å¯¹è±¡ |

### B. ä»£ç è¿ç§»è„šæœ¬

```bash
#!/bin/bash
# è‡ªåŠ¨è¿ç§»è„šæœ¬
# migrate-monitoring.sh

# 1. å¤‡ä»½ç°æœ‰ä»£ç 
git checkout -b monitoring-refactor-backup
git add .
git commit -m "Backup before monitoring refactor"

# 2. åˆ›å»ºæ–°ç»“æ„
mkdir -p src/monitoring/{infrastructure,collection,analysis,presentation,shared}

# 3. è¿ç§»æ–‡ä»¶
mv src/common/core/monitoring/* src/monitoring/infrastructure/
mv src/system-status/collector/* src/monitoring/collection/
mv src/system-status/analyzer/* src/monitoring/analysis/
mv src/system-status/presenter/* src/monitoring/presentation/

# 4. æ›´æ–°å¯¼å…¥è·¯å¾„
find src -name "*.ts" -exec sed -i 's|@common/core/monitoring|@monitoring/infrastructure|g' {} \;
find src -name "*.ts" -exec sed -i 's|../system-status/|@monitoring/|g' {} \;

echo "Migration completed!"
```

### C. åŠŸèƒ½éªŒè¯æ¸…å•

- [ ] æ‰€æœ‰PrometheusæŒ‡æ ‡æ­£å¸¸
- [ ] æ‰€æœ‰ç›‘æ§APIå¯è®¿é—®
- [ ] æ€§èƒ½è£…é¥°å™¨æ­£å¸¸å·¥ä½œ
- [ ] æ•°æ®æ”¶é›†æ— é—æ¼
- [ ] åˆ†æç»“æœå‡†ç¡®
- [ ] APIè®¾è®¡è§„èŒƒéªŒè¯
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•
- [ ] å‹åŠ›æµ‹è¯•é€šè¿‡
- [ ] å®‰å…¨æ‰«æé€šè¿‡
- [ ] æ–‡æ¡£å®Œæ•´æ€§æ£€æŸ¥

### D. å‘å¸ƒæ£€æŸ¥æ¸…å•

- [ ] ä»£ç å®¡æŸ¥å®Œæˆ
- [ ] æµ‹è¯•å…¨éƒ¨é€šè¿‡
- [ ] æ–‡æ¡£æ›´æ–°å®Œæˆ
- [ ] æ€§èƒ½åŸºå‡†è¾¾æ ‡
- [ ] å®‰å…¨æ‰«æé€šè¿‡
- [ ] ç›‘æ§å‘Šè­¦é…ç½®
- [ ] è¿ç»´å›¢é˜ŸåŸ¹è®­
- [ ] å‘å¸ƒè®¡åˆ’ç¡®è®¤
- [ ] ç´§æ€¥è”ç³»äººç¡®è®¤

---

**æ–‡æ¡£ç»“æŸ**

æœ€åæ›´æ–°æ—¶é—´: 2025-01-23 (v1.6 - ä¿æŒåŸç›®å½•åï¼Œå‡å°‘ä¸å¿…è¦çš„é‡å‘½å)