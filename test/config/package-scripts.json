{
  "description": "新的测试脚本配置 - 替换 package.json 中的测试相关脚本",
  "scripts": {
    "comment_old_scripts": "以下是旧的测试脚本，可以逐步替换",
    "old": {
      "test": "jest",
      "test:watch": "jest --watch",
      "test:coverage": "jest --coverage",
      "test:api": "jest test/api/",
      "test:api:coverage": "jest test/api/ --coverage",
      "test:integration": "jest --config jest.integration.config.js",
      "test:e2e": "jest --config jest.e2e.config.js"
    },
    
    "comment_new_scripts": "以下是新的测试脚本，按技术栈和功能分组",
    "new": {
      "test": "npm run test:unit && npm run test:integration && npm run test:e2e",
      "test:all": "npm run test:unit && npm run test:integration && npm run test:e2e && npm run test:security",
      "test:quick": "npm run test:unit",
      
      "comment_unit_tests": "单元测试 - 快速、隔离",
      "test:unit": "jest --config test/config/jest.unit.config.js",
      "test:unit:watch": "jest --config test/config/jest.unit.config.js --watch",
      "test:unit:coverage": "jest --config test/config/jest.unit.config.js --coverage",
      "test:unit:auth": "jest --config test/config/jest.unit.config.js test/jest/unit/auth",
      "test:unit:core": "jest --config test/config/jest.unit.config.js test/jest/unit/core",
      "test:unit:common": "jest --config test/config/jest.unit.config.js test/jest/unit/common",
      
      "comment_integration_tests": "集成测试 - 模块协作",
      "test:integration": "jest --config test/config/jest.integration.config.js",
      "test:integration:watch": "jest --config test/config/jest.integration.config.js --watch",
      "test:integration:coverage": "jest --config test/config/jest.integration.config.js --coverage",
      "test:integration:auth": "jest --config test/config/jest.integration.config.js test/jest/integration/auth",
      "test:integration:core": "jest --config test/config/jest.integration.config.js test/jest/integration/core",
      
      "comment_e2e_tests": "端到端测试 - 完整场景",
      "test:e2e": "jest --config test/config/jest.e2e.config.js",
      "test:e2e:watch": "jest --config test/config/jest.e2e.config.js --watch",
      "test:e2e:auth": "jest --config test/config/jest.e2e.config.js test/jest/e2e/auth",
      "test:e2e:core": "jest --config test/config/jest.e2e.config.js test/jest/e2e/core",
      "test:e2e:workflows": "jest --config test/config/jest.e2e.config.js test/jest/e2e/core",
      
      "comment_security_tests": "安全测试 - 安全验证",
      "test:security": "jest --config test/config/jest.security.config.js",
      "test:security:auth": "jest --config test/config/jest.security.config.js test/jest/security/auth",
      "test:security:core": "jest --config test/config/jest.security.config.js test/jest/security/core",
      
      "comment_performance_tests": "性能测试 - K6",
      "test:perf": "k6 run test/k6/load/api/api-load.perf.test.js",
      "test:perf:load": "k6 run test/k6/load/api/bulk-requests.perf.test.js",
      "test:perf:stress": "k6 run test/k6/stress/api/api-stress.perf.test.js",
      "test:perf:spike": "k6 run test/k6/spike/api/api-spike.perf.test.js",
      "test:perf:auth": "k6 run test/k6/load/auth/auth-load.perf.test.js",
      
      "comment_test_utilities": "测试工具和验证",
      "test:validate-structure": "ts-node test/utils/test-structure-validator.ts",
      "test:detect-conflicts": "ts-node test/utils/test-conflict-detector.ts",
      "test:coverage-mapping": "ts-node test/utils/test-coverage-mapper.ts",
      
      "comment_coverage_reports": "覆盖率报告",
      "test:coverage": "npm run test:unit:coverage && npm run test:integration:coverage",
      "test:coverage:merge": "nyc merge coverage coverage/merged.json",
      "test:coverage:report": "nyc report --reporter=html --temp-dir coverage",
      
      "comment_test_data_management": "测试数据管理",
      "test:data:setup": "ts-node test/utils/test-data-setup.ts",
      "test:data:cleanup": "ts-node test/utils/test-data-cleanup.ts",
      "test:data:reset": "npm run test:data:cleanup && npm run test:data:setup",
      
      "comment_ci_cd_scripts": "CI/CD 专用脚本",
      "test:ci": "npm run test:validate-structure && npm run test:detect-conflicts && npm run test:unit && npm run test:integration",
      "test:ci:full": "npm run test:ci && npm run test:e2e && npm run test:security",
      "test:ci:quick": "npm run test:unit && npm run test:integration",
      
      "comment_development_scripts": "开发环境脚本",
      "test:dev": "npm run test:unit:watch",
      "test:debug": "node --inspect-brk node_modules/.bin/jest --config test/config/jest.unit.config.js --runInBand",
      "test:debug:e2e": "node --inspect-brk node_modules/.bin/jest --config test/config/jest.e2e.config.js --runInBand",
      
      "comment_migration_scripts": "迁移脚本",
      "test:migrate": "ts-node test/utils/test-migration-tool.ts",
      "test:migrate:dry-run": "ts-node test/utils/test-migration-tool.ts --dry-run",
      "test:compare-old-new": "ts-node test/utils/test-comparison-tool.ts"
    }
  },
  
  "testEnvironments": {
    "development": {
      "NODE_ENV": "test",
      "DISABLE_AUTO_INIT": "true",
      "JWT_SECRET": "test-jwt-secret",
      "MONGODB_URI": "mongodb://localhost:27017/test-stock-api",
      "REDIS_HOST": "localhost",
      "REDIS_PORT": "6379"
    },
    "ci": {
      "NODE_ENV": "test",
      "DISABLE_AUTO_INIT": "true",
      "CI": "true",
      "JWT_SECRET": "test-jwt-secret-ci",
      "MONGODB_URI": "mongodb://mongodb:27017/test-stock-api-ci",
      "REDIS_HOST": "redis",
      "REDIS_PORT": "6379"
    }
  },
  
  "testRunOrders": {
    "sequential": {
      "description": "按依赖顺序执行测试",
      "order": ["unit", "integration", "e2e", "security", "performance"],
      "parallelizable": {
        "unit": true,
        "integration": false,
        "e2e": false,
        "security": false,
        "performance": false
      }
    },
    "parallel": {
      "description": "并行执行独立的测试",
      "groups": [
        ["unit"],
        ["integration", "security"],
        ["e2e"],
        ["performance"]
      ]
    }
  },
  
  "testReporting": {
    "formats": ["html", "json", "lcov", "text"],
    "outputs": {
      "html": "test-results/",
      "json": "test-results/",
      "coverage": "coverage/"
    },
    "consolidation": {
      "enabled": true,
      "outputFile": "test-results/consolidated-report.html"
    }
  },
  
  "hooks": {
    "pre-test": [
      "npm run test:validate-structure",
      "npm run test:detect-conflicts"
    ],
    "post-test": [
      "npm run test:coverage:merge",
      "npm run test:coverage:report"
    ],
    "pre-commit": [
      "npm run test:quick",
      "npm run test:validate-structure"
    ]
  }
}