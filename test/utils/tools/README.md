# æµ‹è¯•ç›®å½•ç»“æ„è§„èŒƒåŒ–å·¥å…·

è¿™ä¸ªç›®å½•åŒ…å«äº†ç”¨äºè§„èŒƒåŒ–æµ‹è¯•ç›®å½•ç»“æ„çš„å·¥å…·è„šæœ¬ï¼Œå¸®åŠ©ç¡®ä¿æµ‹è¯•æ–‡ä»¶ä¸æºä»£ç æ–‡ä»¶çš„ä¸€ä¸€å¯¹åº”å…³ç³»ï¼Œæ”¯æŒ**7ç»„ä»¶æ ¸å¿ƒæ¶æ„**çš„ç›®å½•ç»“æ„ç®¡ç†ã€‚

## ğŸ› ï¸ å·¥å…·æ¦‚è¿°

### 1. test-structure-validator.ts â­ï¸
**æµ‹è¯•ç›®å½•ç»“æ„éªŒè¯å™¨** - æ”¯æŒç›®å½•çº§åˆ«æ‰¹é‡ç§»åŠ¨çš„æ™ºèƒ½ç»“æ„ç®¡ç†å·¥å…·
- ğŸ¯ **æ ¸å¿ƒåŠŸèƒ½**: ç›®å½•çº§åˆ«çš„æ‰¹é‡é‡ç»„å’Œç»“æ„éªŒè¯
- ğŸ”§ **é€‚ç”¨åœºæ™¯**: å¤§è§„æ¨¡ç›®å½•ç»“æ„è°ƒæ•´ã€æ¶æ„é‡ç»„

### 2. test-find-duplicates.ts
**é‡å¤æ–‡ä»¶æ£€æµ‹å’Œæ¸…ç†å·¥å…·** - ç”¨äºæ£€æµ‹å’Œæ¸…ç†ç§»åŠ¨æ“ä½œåäº§ç”Ÿçš„é‡å¤æµ‹è¯•æ–‡ä»¶
- ğŸ¯ **æ ¸å¿ƒåŠŸèƒ½**: æ™ºèƒ½é‡å¤æ–‡ä»¶æ£€æµ‹å’Œè‡ªåŠ¨æ¸…ç†
- ğŸ”§ **é€‚ç”¨åœºæ™¯**: æ–‡ä»¶ç§»åŠ¨åçš„æ¸…ç†ã€é‡å¤å†…å®¹ç®¡ç†

### 3. test-naming-validator.ts
**æµ‹è¯•æ–‡ä»¶å‘½åè§„èŒƒéªŒè¯å™¨** - ç”¨äºéªŒè¯æµ‹è¯•æ–‡ä»¶å‘½åæ˜¯å¦ç¬¦åˆé¡¹ç›®è§„èŒƒ
- ğŸ¯ **æ ¸å¿ƒåŠŸèƒ½**: å‘½åè§„èŒƒéªŒè¯å’Œé‡å‘½åå»ºè®®
- ğŸ”§ **é€‚ç”¨åœºæ™¯**: ä»£ç è§„èŒƒæ£€æŸ¥ã€æ–‡ä»¶é‡å‘½å

### 4. test-quality-analyzer.ts
**æµ‹è¯•å†²çªæ£€æµ‹å™¨** - è‡ªåŠ¨æ£€æµ‹æµ‹è¯•æ–‡ä»¶ä¸­çš„é‡å¤ã€å†²çªå’Œä¸ä¸€è‡´
  - ä¸“æ³¨äºæµ‹è¯•è´¨é‡åˆ†æ
  - æ£€æµ‹é€»è¾‘å†²çªã€ä¾èµ–è¿è§„ã€è¾¹ç•Œè¿è§„
  - ä¸å¤„ç†æ–‡ä»¶åˆ é™¤ï¼ŒåªæŠ¥å‘Šé—®é¢˜

### 5. test-duplicate-cleaner.ts â­ï¸
**é€šç”¨å ä½æµ‹è¯•æ–‡ä»¶æ¸…ç†å™¨** - æ™ºèƒ½æ£€æµ‹å’Œæ¸…ç†å ä½æµ‹è¯•æ–‡ä»¶ï¼Œæ”¯æŒå¤šç§æµ‹è¯•ç±»å‹
- ğŸ¯ **æ ¸å¿ƒåŠŸèƒ½**: é€šç”¨å ä½æ–‡ä»¶æ£€æµ‹å’Œæ‰¹é‡å†…å®¹æ¸…ç†
- ğŸ”§ **é€‚ç”¨åœºæ™¯**: æ¸…ç†æ— ç”¨çš„å ä½æµ‹è¯•æ–‡ä»¶ï¼Œé¿å…é¡¹ç›®ä¸­çš„å†—ä½™ä»£ç 
- ğŸ’¡ **æ™ºèƒ½æ£€æµ‹**: è‡ªåŠ¨è¯†åˆ«unitã€integrationã€securityã€e2eç­‰æ‰€æœ‰ç±»å‹çš„å ä½æ–‡ä»¶


## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®Œæ•´å·¥ä½œæµç¨‹ (æ¨è)

```bash
# 1. å¤‡ä»½æµ‹è¯•æ–‡ä»¶ (é‡è¦!)
cp -r test/ test-backup/

# 2. åˆ†æå½“å‰çŠ¶æ€
npx ts-node test/utils/tools/test-structure-validator.ts
npx ts-node test/utils/tools/test-naming-validator.ts
npx ts-node test/utils/tools/test-find-duplicates.ts

# 3. æ‰§è¡Œç»“æ„ä¿®å¤ (æ ¸å¿ƒæ­¥éª¤)
npx ts-node test/utils/tools/test-structure-validator.ts --execute

# 4. æ¸…ç†é‡å¤æ–‡ä»¶
npx ts-node test/utils/tools/test-find-duplicates.ts --cleanup --execute

# 5. æ¸…ç†å ä½æµ‹è¯•æ–‡ä»¶
npx ts-node test/utils/tools/test-duplicate-cleaner.ts --universal --execute

# 6. æœ€ç»ˆéªŒè¯
npx ts-node test/utils/tools/test-structure-validator.ts
npx ts-node test/utils/tools/test-find-duplicates.ts
```

### å¸¸ç”¨å‘½ä»¤

```bash
# å¿«é€Ÿæ£€æŸ¥
npx ts-node test/utils/tools/test-structure-validator.ts
npx ts-node test/utils/tools/test-find-duplicates.ts

# æ‰§è¡Œä¿®å¤
npx ts-node test/utils/tools/test-structure-validator.ts --execute
npx ts-node test/utils/tools/test-find-duplicates.ts --cleanup --execute

# å‘½åæ£€æŸ¥
npx ts-node test/utils/tools/test-naming-validator.ts
npx ts-node test/utils/tools/test-naming-validator.ts --generate-script

# å ä½æ–‡ä»¶æ¸…ç†
npx ts-node test/utils/tools/test-duplicate-cleaner.ts --universal
npx ts-node test/utils/tools/test-duplicate-cleaner.ts --universal --execute
```

## ğŸ“‹ test-structure-validator.ts è¯¦ç»†è¯´æ˜

### ğŸ¯ æ ¸å¿ƒèƒ½åŠ›

è¿™æ˜¯æœ€é‡è¦çš„å·¥å…·ï¼Œæ”¯æŒ**ç›®å½•çº§åˆ«çš„æ‰¹é‡ç§»åŠ¨**ï¼Œä¸“é—¨ä¸ºæœ¬é¡¹ç›®çš„**7ç»„ä»¶æ ¸å¿ƒæ¶æ„**è®¾è®¡ï¼š

**âœ… æ”¯æŒçš„æ¶æ„é‡ç»„è§„åˆ™:**
- **Public ç»„ä»¶** â†’ `core/public/`: data-mapper, storage, symbol-mapper, transformer
- **RestAPI ç»„ä»¶** â†’ `core/restapi/`: data-fetcher, query, receiver  
- **Stream ç»„ä»¶** â†’ `core/stream/`: stream-data-fetcher, stream-receiver

**ğŸ”§ åˆ†æçš„æµ‹è¯•ç›®å½•:**
- `test/jest/unit/` - å•å…ƒæµ‹è¯•
- `test/jest/integration/` - é›†æˆæµ‹è¯•  
- `test/jest/e2e/` - ç«¯åˆ°ç«¯æµ‹è¯•
- `test/jest/security/` - å®‰å…¨æµ‹è¯•

### åŠŸèƒ½ç‰¹æ€§

- ğŸ—ï¸ **ç›®å½•çº§åˆ«æ‰¹é‡ç§»åŠ¨** - ä¸€æ¬¡æ€§ç§»åŠ¨æ•´ä¸ªæ¨¡å—ç›®å½•
- ğŸ“ **æ™ºèƒ½ç›®å½•åˆ›å»º** - è‡ªåŠ¨åˆ›å»ºç¼ºå¤±çš„ç›®å½•ç»“æ„
- ğŸ“ **æµ‹è¯•æ–‡ä»¶æ¨¡æ¿ç”Ÿæˆ** - ä¸ºç¼ºå¤±çš„æºæ–‡ä»¶åˆ›å»ºæ ‡å‡†æµ‹è¯•æ¨¡æ¿
- ğŸ” **ç»“æ„å·®å¼‚æ£€æµ‹** - æ·±åº¦åˆ†ææµ‹è¯•ç›®å½•ä¸æºç ç›®å½•çš„å·®å¼‚
- âš¡ **æ“ä½œä¼˜å…ˆçº§ç®¡ç†** - å…ˆç›®å½•ç§»åŠ¨ï¼Œå†æ–‡ä»¶æ“ä½œï¼Œæœ€ååˆ›å»ºæ–°æ–‡ä»¶

### å‚æ•°é€‰é¡¹

```bash
# ä»…åˆ†æï¼Œä¸æ‰§è¡Œä»»ä½•æ›´æ”¹ï¼ˆé»˜è®¤æ¨¡å¼ï¼‰
npx ts-node test/utils/tools/test-structure-validator.ts

# æ‰§è¡Œæ‰€æœ‰ä¿®å¤æ“ä½œï¼ˆåŒ…æ‹¬ç›®å½•ç§»åŠ¨ã€æ–‡ä»¶åˆ›å»ºç­‰ï¼‰
npx ts-node test/utils/tools/test-structure-validator.ts --execute
```

### å®é™…è¾“å‡ºç¤ºä¾‹

```
ğŸ“‹ æµ‹è¯•ç›®å½•ç»“æ„åˆ†ææŠ¥å‘Š
==================================================

ğŸšš éœ€è¦é‡æ–°å®šä½çš„æµ‹è¯•æ–‡ä»¶:
   ğŸ“¦ data-mapper
      ä»: test/jest/unit/core/data-mapper
      åˆ°: test/jest/unit/core/public/data-mapper
      åŸå› : ç›®å½•ç»“æ„ä¸åŒ¹é…æºä»£ç ç»„ç»‡ç»“æ„

   ğŸ“¦ data-fetcher
      ä»: test/jest/unit/core/data-fetcher
      åˆ°: test/jest/unit/core/restapi/data-fetcher
      åŸå› : ç›®å½•ç»“æ„ä¸åŒ¹é…æºä»£ç ç»„ç»‡ç»“æ„

   ğŸ“¦ stream-receiver
      ä»: test/jest/unit/core/stream-receiver
      åˆ°: test/jest/unit/core/stream/stream-receiver
      åŸå› : ç›®å½•ç»“æ„ä¸åŒ¹é…æºä»£ç ç»„ç»‡ç»“æ„

ğŸ—ï¸  éœ€è¦åˆ›å»ºçš„ç›®å½•:
   ğŸ“ test/jest/unit/core/public
   ğŸ“ test/jest/unit/core/restapi
   ğŸ“ test/jest/unit/core/stream
   ... è¿˜æœ‰ 591 ä¸ªç›®å½•

ğŸ“ éœ€è¦åˆ›å»ºçš„æµ‹è¯•æ–‡ä»¶:
   UNIT (178 ä¸ªæ–‡ä»¶):
     ğŸ“„ alert.module.spec.ts (for alert/module/alert.module.ts)
     ğŸ“„ auth.module.spec.ts (for auth/module/auth.module.ts)

ğŸ“Š ç»Ÿè®¡ä¿¡æ¯:
   - éœ€è¦ç§»åŠ¨/é‡å‘½åæ–‡ä»¶: 20
     Â· é‡æ–°å®šä½: 20 (ç›®å½•çº§åˆ«ç§»åŠ¨)
     Â· é‡å‘½å: 0
   - éœ€è¦åˆ›å»ºç›®å½•: 594
   - éœ€è¦åˆ›å»ºæµ‹è¯•æ–‡ä»¶: 1059
   - ç»“æ„ä¸åŒ¹é…é¡¹: 0
```

### æ‰§è¡Œè¿‡ç¨‹ç¤ºä¾‹

```
ğŸš€ æ‰§è¡Œè¿ç§»è®¡åˆ’...

ğŸ“¦ ç¬¬ä¸€æ­¥ï¼šæ‰§è¡Œç›®å½•çº§åˆ«çš„ç§»åŠ¨...
âœ… ç›®å½•ç§»åŠ¨å®Œæˆ: data-mapper â†’ test/jest/unit/core/public/data-mapper
    åŸå› : ç›®å½•ç»“æ„ä¸åŒ¹é…æºä»£ç ç»„ç»‡ç»“æ„
âœ… ç›®å½•ç§»åŠ¨å®Œæˆ: data-fetcher â†’ test/jest/unit/core/restapi/data-fetcher
    åŸå› : ç›®å½•ç»“æ„ä¸åŒ¹é…æºä»£ç ç»„ç»‡ç»“æ„

ğŸ“„ ç¬¬äºŒæ­¥ï¼šç§»åŠ¨å•ä¸ªæµ‹è¯•æ–‡ä»¶...

ğŸ—ï¸ ç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºç¼ºå¤±çš„ç›®å½•...
âœ… åˆ›å»ºç›®å½•: test/jest/unit/alert/module

ğŸ“ ç¬¬å››æ­¥ï¼šåˆ›å»ºç¼ºå¤±çš„æµ‹è¯•æ–‡ä»¶...
âœ… åˆ›å»ºæµ‹è¯•æ–‡ä»¶: test/jest/unit/alert/module/alert.module.spec.ts

ğŸ‰ è¿ç§»è®¡åˆ’æ‰§è¡Œå®Œæˆ!
```

## ğŸ” test-find-duplicates.ts è¯¦ç»†è¯´æ˜

### æ ¸å¿ƒåŠŸèƒ½

ä¸“é—¨å¤„ç†æ–‡ä»¶ç§»åŠ¨æ“ä½œåäº§ç”Ÿçš„é‡å¤æ–‡ä»¶ï¼Œæ”¯æŒæ™ºèƒ½æ¸…ç†ç­–ç•¥ï¼š

- ğŸ“Š **å†…å®¹å“ˆå¸Œå¯¹æ¯”** - ä½¿ç”¨MD5å“ˆå¸Œæ£€æµ‹çœŸæ­£çš„é‡å¤å†…å®¹
- ğŸ¯ **æ™ºèƒ½ä¿ç•™ç­–ç•¥** - ä¼˜å…ˆä¿ç•™æ­£ç¡®ä½ç½®çš„æ–‡ä»¶
- ğŸ§¹ **æ‰¹é‡æ¸…ç†** - ä¸€æ¬¡æ€§æ¸…ç†æ‰€æœ‰é‡å¤æ–‡ä»¶
- ğŸ“ˆ **ç©ºé—´ç»Ÿè®¡** - æ˜¾ç¤ºå¯èŠ‚çœçš„ç£ç›˜ç©ºé—´

### å‚æ•°é€‰é¡¹

```bash
# æ£€æµ‹é‡å¤æ–‡ä»¶ï¼ˆé»˜è®¤ï¼‰
npx ts-node test/utils/tools/test-find-duplicates.ts

# é¢„è§ˆæ¸…ç†æ“ä½œ
npx ts-node test/utils/tools/test-find-duplicates.ts --cleanup

# æ‰§è¡Œæ¸…ç†æ“ä½œ
npx ts-node test/utils/tools/test-find-duplicates.ts --cleanup --execute

# ç”Ÿæˆæ¸…ç†è„šæœ¬
npx ts-node test/utils/tools/test-find-duplicates.ts --generate-script
```

### è¾“å‡ºç¤ºä¾‹

```
ğŸ“‹ é‡å¤æ–‡ä»¶æ£€æµ‹æŠ¥å‘Š
==================================================
âš ï¸  å‘ç° 5 ç»„é‡å¤æ–‡ä»¶:

1. ğŸ“„ index.e2e.test.ts (17 ä¸ªå‰¯æœ¬)
   ğŸŸ¢ ä¿ç•™ e2e/core/restapi/data-fetcher/dto/index.e2e.test.ts
        âœ… æ­£ç¡®ä½ç½® | å¤§å°: 615 å­—èŠ‚ | å“ˆå¸Œ: b8c53758...
   ğŸ”´ åˆ é™¤ e2e/alert/dto/index.e2e.test.ts
        âŒ é”™è¯¯ä½ç½® | å¤§å°: 615 å­—èŠ‚ | å“ˆå¸Œ: b8c53758...

ğŸ“Š ç»Ÿè®¡ä¿¡æ¯:
   - é‡å¤æ–‡ä»¶ç»„: 5
   - å†—ä½™æ–‡ä»¶æ•°: 20
   - å¯èŠ‚çœç©ºé—´: 12 KB
```

## ğŸ“ test-naming-validator.ts è¯¦ç»†è¯´æ˜

### å‘½åè§„èŒƒ

- **å•å…ƒæµ‹è¯•**: `*.spec.ts`
- **é›†æˆæµ‹è¯•**: `*.integration.test.ts`
- **E2Eæµ‹è¯•**: `*.e2e.test.ts`
- **å®‰å…¨æµ‹è¯•**: `*.security.test.ts`
- **æ€§èƒ½æµ‹è¯•**: `*.perf.test.ts`
- **é»‘ç›’æµ‹è¯•**: `*.e2e.test.ts`

### å‚æ•°é€‰é¡¹

```bash
# éªŒè¯å‘½åè§„èŒƒï¼ˆé»˜è®¤ï¼‰
npx ts-node test/utils/tools/test-naming-validator.ts

# ç”Ÿæˆé‡å‘½åè„šæœ¬
npx ts-node test/utils/tools/test-naming-validator.ts --generate-script
```

## ğŸ§¹ test-duplicate-cleaner.ts è¯¦ç»†è¯´æ˜

### æ ¸å¿ƒåŠŸèƒ½

ä¸“é—¨æ£€æµ‹å’Œæ¸…ç†å ä½æµ‹è¯•æ–‡ä»¶ï¼Œæ”¯æŒé€šç”¨æ¨¡å¼å’Œæ™ºèƒ½å†…å®¹æ£€æµ‹ï¼š

- ğŸ” **æ™ºèƒ½æ£€æµ‹**: è‡ªåŠ¨è¯†åˆ«åŸºç¡€çš„"should be defined"å ä½æµ‹è¯•
- ğŸ§¹ **æ‰¹é‡æ¸…ç†**: ä¸€æ¬¡æ€§æ¸…ç†æ‰€æœ‰ç±»å‹çš„å ä½æ–‡ä»¶
- ğŸ“ **å†…å®¹æ›¿æ¢**: å°†å¤æ‚çš„å ä½ä»£ç æ›¿æ¢ä¸ºç®€æ´çš„æ³¨é‡Š
- ğŸ“Š **å…¨é¢æ”¯æŒ**: æ”¯æŒunitã€integrationã€securityã€e2eç­‰æ‰€æœ‰æµ‹è¯•ç±»å‹

### æ£€æµ‹é€»è¾‘

å·¥å…·ä½¿ç”¨ä»¥ä¸‹é€»è¾‘æ¥è¯†åˆ«å ä½æµ‹è¯•æ–‡ä»¶ï¼š

```typescript
// æ£€æµ‹æ¡ä»¶
- åŒ…å« `import { Test, TestingModule }`
- åŒ…å« `describe()` å’Œ `beforeEach()`
- åŒ…å« `should be defined` æµ‹è¯•
- åªæœ‰ä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹
- æ–‡ä»¶è¡Œæ•°è¾ƒå°‘ï¼ˆâ‰¤30è¡Œï¼‰
- æ²¡æœ‰å¤æ‚çš„æµ‹è¯•é€»è¾‘ï¼ˆmockã€spyç­‰ï¼‰
```

### å‚æ•°é€‰é¡¹

```bash
# é¢„è§ˆæ¸…ç†ï¼ˆä¼ ç»Ÿæ¨¡å¼ï¼Œéœ€è¦æŒ‡å®šå‚è€ƒæ–‡ä»¶ï¼‰
npx ts-node test/utils/tools/test-duplicate-cleaner.ts --dry-run

# æ‰§è¡Œæ¸…ç†ï¼ˆä¼ ç»Ÿæ¨¡å¼ï¼‰
npx ts-node test/utils/tools/test-duplicate-cleaner.ts --execute

# é€šç”¨æ¨¡å¼é¢„è§ˆï¼ˆæ¨èï¼‰
npx ts-node test/utils/tools/test-duplicate-cleaner.ts --universal --dry-run

# é€šç”¨æ¨¡å¼æ‰§è¡Œï¼ˆæ¨èï¼‰
npx ts-node test/utils/tools/test-duplicate-cleaner.ts --universal --execute

# æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š
npx ts-node test/utils/tools/test-duplicate-cleaner.ts --universal --report
```

### æ”¯æŒçš„æ–‡ä»¶æ‰©å±•å

- **å•å…ƒæµ‹è¯•**: `*.spec.ts`
- **é›†æˆæµ‹è¯•**: `*.integration.test.ts`
- **E2Eæµ‹è¯•**: `*.e2e.test.ts`
- **å®‰å…¨æµ‹è¯•**: `*.security.test.ts`
- **æ€§èƒ½æµ‹è¯•**: `*.perf.test.ts`

### è¾“å‡ºç¤ºä¾‹

```
ğŸ” å¼€å§‹æ‰«æå ä½æµ‹è¯•æ–‡ä»¶...
ğŸ“‚ ç›®æ ‡ç›®å½•: /Users/honor/Documents/code/newstockapi/backend/test/jest
ğŸ¯ æ‰«ææ¨¡å¼: é€šç”¨å ä½æ–‡ä»¶æ£€æµ‹

ğŸ“‹ æ‰¾åˆ° 1231 ä¸ªæµ‹è¯•æ–‡ä»¶
ğŸ“„ æ‰¾åˆ°å ä½æ–‡ä»¶: test/jest/integration/alert/constants/alert-history.constants.integration.test.ts
ğŸ“„ æ‰¾åˆ°å ä½æ–‡ä»¶: test/jest/security/core/public/shared/services/batch-optimization.service.security.test.ts
   ... è¿˜æœ‰æ›´å¤šæ–‡ä»¶

âœ… æ‰«æå®Œæˆ! æ‰¾åˆ° 584 ä¸ªå ä½æµ‹è¯•æ–‡ä»¶

ğŸ§¹ æ‰§è¡Œæ¸…ç†æ“ä½œ...

ğŸ“ [æ‰§è¡Œ] test/jest/integration/alert/constants/alert-history.constants.integration.test.ts
   âœ… å·²æ¸…ç†

âœ… æ¸…ç†å®Œæˆ! å¤„ç†äº† 584 ä¸ªæ–‡ä»¶
```

### æ¸…ç†åçš„æ–‡ä»¶æ ¼å¼

æ‰€æœ‰å ä½æ–‡ä»¶è¢«æ›¿æ¢ä¸ºç®€æ´çš„æ³¨é‡Šæ ¼å¼ï¼š

```typescript
// alert-history.constants.integration.test.ts - æµ‹è¯•å ä½ä»£ç 
// è·¯å¾„: integration/alert/constants/alert-history.constants.integration.test.ts

// TODO: å®ç°å…·ä½“çš„æµ‹è¯•ç”¨ä¾‹
```

### Package.json å‘½ä»¤é›†æˆ

å·¥å…·å·²é›†æˆåˆ°é¡¹ç›®çš„npm scriptsä¸­ï¼š

```json
{
  "scripts": {
    "test:clean-duplicates": "ts-node test/utils/tools/test-duplicate-cleaner.ts --dry-run",
    "test:clean-duplicates:report": "ts-node test/utils/tools/test-duplicate-cleaner.ts --report", 
    "test:clean-duplicates:execute": "ts-node test/utils/tools/test-duplicate-cleaner.ts --execute",
    "test:clean-duplicates:universal": "ts-node test/utils/tools/test-duplicate-cleaner.ts --universal --dry-run",
    "test:clean-duplicates:universal:execute": "ts-node test/utils/tools/test-duplicate-cleaner.ts --universal --execute"
  }
}
```

ä½¿ç”¨npm scriptsè¿è¡Œï¼š

```bash
# é€šç”¨æ¨¡å¼é¢„è§ˆ
npm run test:clean-duplicates:universal

# é€šç”¨æ¨¡å¼æ‰§è¡Œæ¸…ç†
npm run test:clean-duplicates:universal:execute

# æŸ¥çœ‹è¯¦ç»†æŠ¥å‘Š
npm run test:clean-duplicates:report
```

### æœ€ä½³å®è·µ

1. **ä½¿ç”¨é€šç”¨æ¨¡å¼**: æ¨èä½¿ç”¨ `--universal` å‚æ•°ï¼Œæ— éœ€æŒ‡å®šå‚è€ƒæ–‡ä»¶
2. **å…ˆé¢„è§ˆå†æ‰§è¡Œ**: ä½¿ç”¨ `--dry-run` æˆ–ä¸å¸¦å‚æ•°å…ˆé¢„è§ˆç»“æœ
3. **å®šæœŸæ¸…ç†**: åœ¨é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­å®šæœŸè¿è¡Œå·¥å…·æ¸…ç†å ä½æ–‡ä»¶
4. **å¤‡ä»½é‡è¦æ–‡ä»¶**: è™½ç„¶å·¥å…·åªå¤„ç†å ä½æ–‡ä»¶ï¼Œå»ºè®®æ¸…ç†å‰å¤‡ä»½

### æˆåŠŸæ¡ˆä¾‹

**æœ€è¿‘ä¸€æ¬¡è¿è¡Œç»“æœ:**
- âœ… **æ‰«ææ–‡ä»¶**: 1231 ä¸ªæµ‹è¯•æ–‡ä»¶
- âœ… **æ£€æµ‹å ä½**: 584 ä¸ªå ä½æ–‡ä»¶
- âœ… **æ¸…ç†æˆåŠŸ**: 100% æˆåŠŸç‡
- âœ… **è¦†ç›–ç±»å‹**: unitã€integrationã€securityã€e2e æ‰€æœ‰ç±»å‹
- âœ… **èŠ‚çœç©ºé—´**: æ˜¾è‘—å‡å°‘å†—ä½™ä»£ç 

## ğŸ¯ é¡¹ç›®ç‰¹å®šé…ç½®

### 7ç»„ä»¶æ ¸å¿ƒæ¶æ„æ”¯æŒ

å·¥å…·ä¸“é—¨æ”¯æŒæœ¬é¡¹ç›®çš„æ ¸å¿ƒæ¶æ„ï¼š

**ğŸ“‚ æºç ç›®å½•ç»“æ„:**
```
src/core/
â”œâ”€â”€ public/          # å…¬å…±ç»„ä»¶
â”‚   â”œâ”€â”€ data-mapper/
â”‚   â”œâ”€â”€ storage/
â”‚   â”œâ”€â”€ symbol-mapper/
â”‚   â””â”€â”€ transformer/
â”œâ”€â”€ restapi/         # REST API ç»„ä»¶
â”‚   â”œâ”€â”€ data-fetcher/
â”‚   â”œâ”€â”€ query/
â”‚   â””â”€â”€ receiver/
â””â”€â”€ stream/          # æµæ•°æ®ç»„ä»¶
    â”œâ”€â”€ stream-data-fetcher/
    â””â”€â”€ stream-receiver/
```

**ğŸ“‚ å¯¹åº”æµ‹è¯•ç›®å½•ç»“æ„:**
```
test/jest/{unit|integration|e2e|security}/core/
â”œâ”€â”€ public/          # å¯¹åº” src/core/public/
â”œâ”€â”€ restapi/         # å¯¹åº” src/core/restapi/
â””â”€â”€ stream/          # å¯¹åº” src/core/stream/
```

### æ™ºèƒ½é‡ç»„è§„åˆ™

å·¥å…·å†…ç½®äº†æ™ºèƒ½é‡ç»„è§„åˆ™ï¼Œèƒ½è‡ªåŠ¨è¯†åˆ«éœ€è¦ç§»åŠ¨çš„ç›®å½•ï¼š

```typescript
// è‡ªåŠ¨è¯†åˆ«çš„é‡ç»„è§„åˆ™
const coreReorganization = [
  // Public ç»„ä»¶ç§»åŠ¨
  { pattern: 'core/data-mapper', targetLocation: 'core/public/data-mapper' },
  { pattern: 'core/storage', targetLocation: 'core/public/storage' },
  { pattern: 'core/symbol-mapper', targetLocation: 'core/public/symbol-mapper' },
  { pattern: 'core/transformer', targetLocation: 'core/public/transformer' },
  
  // RestAPI ç»„ä»¶ç§»åŠ¨
  { pattern: 'core/data-fetcher', targetLocation: 'core/restapi/data-fetcher' },
  { pattern: 'core/query', targetLocation: 'core/restapi/query' },
  { pattern: 'core/receiver', targetLocation: 'core/restapi/receiver' },
  
  // Stream ç»„ä»¶ç§»åŠ¨
  { pattern: 'core/stream-data-fetcher', targetLocation: 'core/stream/stream-data-fetcher' },
  { pattern: 'core/stream-receiver', targetLocation: 'core/stream/stream-receiver' },
];
```

## ğŸ”„ æµ‹è¯•æ–‡ä»¶æ¨¡æ¿

å·¥å…·ä¼šæ ¹æ®æµ‹è¯•ç±»å‹è‡ªåŠ¨ç”Ÿæˆç›¸åº”çš„æµ‹è¯•æ–‡ä»¶æ¨¡æ¿ï¼š

### å•å…ƒæµ‹è¯•æ¨¡æ¿ (.spec.ts)
```typescript
import { Test, TestingModule } from '@nestjs/testing';
import { ServiceName } from '../../../src/path/to/service';

describe('ServiceName', () => {
  let serviceName: ServiceName;

  beforeEach(async () => {
    const module: TestingModule = await Test.createTestingModule({
      providers: [ServiceName],
    }).compile();

    serviceName = module.get<ServiceName>(ServiceName);
  });

  it('should be defined', () => {
    expect(serviceName).toBeDefined();
  });
});
```

### é›†æˆæµ‹è¯•æ¨¡æ¿ (.integration.test.ts)
```typescript
import { Test, TestingModule } from '@nestjs/testing';
import { ServiceName } from '../../../src/path/to/service';

describe('ServiceName Integration', () => {
  let serviceName: ServiceName;

  beforeEach(async () => {
    const module: TestingModule = await Test.createTestingModule({
      providers: [ServiceName],
    }).compile();

    serviceName = module.get<ServiceName>(ServiceName);
  });

  it('should be defined', () => {
    expect(serviceName).toBeDefined();
  });
});
```

### E2Eæµ‹è¯•æ¨¡æ¿ (.e2e.test.ts)
```typescript
import { Test, TestingModule } from '@nestjs/testing';
import { INestApplication } from '@nestjs/common';
import * as request from 'supertest';
import { AppModule } from '../../../src/app.module';

describe('ServiceName E2E', () => {
  let app: INestApplication;

  beforeEach(async () => {
    const moduleFixture: TestingModule = await Test.createTestingModule({
      imports: [AppModule],
    }).compile();

    app = moduleFixture.createNestApplication();
    await app.init();
  });

  afterEach(async () => {
    await app.close();
  });

  it('should be defined', () => {
    expect(app).toBeDefined();
  });
});
```

## ğŸ“‹ æœ€ä½³å®è·µ

### æ¨èå·¥ä½œæµç¨‹

#### 1. **åˆ†æé˜¶æ®µ** ğŸ“Š
```bash
# å…¨é¢äº†è§£å½“å‰çŠ¶å†µ
npx ts-node test/utils/tools/test-structure-validator.ts
npx ts-node test/utils/tools/test-naming-validator.ts
npx ts-node test/utils/tools/test-find-duplicates.ts
```

#### 2. **å¤‡ä»½é˜¶æ®µ** ğŸ’¾
```bash
# å¿…é¡»å¤‡ä»½ï¼
cp -r test/ test-backup/
```

#### 3. **æ‰§è¡Œé˜¶æ®µ** âš¡
```bash
# æ‰§è¡Œç»“æ„ä¿®å¤ï¼ˆæ ¸å¿ƒæ­¥éª¤ï¼‰
npx ts-node test/utils/tools/test-structure-validator.ts --execute

# æ¸…ç†é‡å¤æ–‡ä»¶
npx ts-node test/utils/tools/test-find-duplicates.ts --cleanup --execute

# æ¸…ç†å ä½æµ‹è¯•æ–‡ä»¶
npx ts-node test/utils/tools/test-duplicate-cleaner.ts --universal --execute
```

#### 4. **éªŒè¯é˜¶æ®µ** âœ…
```bash
# è¿è¡Œæµ‹è¯•ç¡®ä¿æ²¡æœ‰ç ´å
bun run test:unit
bun run test:integration

# å†æ¬¡éªŒè¯ç»“æ„
npx ts-node test/utils/tools/test-structure-validator.ts
npx ts-node test/utils/tools/test-find-duplicates.ts
```

### æˆåŠŸæ¡ˆä¾‹ç»Ÿè®¡

**æœ€è¿‘ä¸€æ¬¡å®Œæ•´è¿è¡Œç»“æœ:**
- âœ… **ç§»åŠ¨ç›®å½•**: 20 ä¸ªæ ¸å¿ƒæ¨¡å—ç›®å½•
- âœ… **åˆ›å»ºç›®å½•**: 594 ä¸ªæ–°ç›®å½•
- âœ… **åˆ›å»ºæ–‡ä»¶**: 1059 ä¸ªæµ‹è¯•æ–‡ä»¶
- âœ… **æ¸…ç†é‡å¤**: 40 ä¸ªé‡å¤æ–‡ä»¶
- âœ… **æ¸…ç†å ä½**: 584 ä¸ªå ä½æµ‹è¯•æ–‡ä»¶
- âœ… **èŠ‚çœç©ºé—´**: æ˜¾è‘—å‡å°‘å†—ä½™ä»£ç 
- âœ… **æœ€ç»ˆçŠ¶æ€**: 100% ç»“æ„åˆè§„

## âš ï¸ æ³¨æ„äº‹é¡¹

### é‡è¦æé†’

- ğŸ” **å¿…é¡»å¤‡ä»½**: æ‰§è¡Œä»»ä½•ä¿®æ”¹æ“ä½œå‰ï¼ŒåŠ¡å¿…å¤‡ä»½æµ‹è¯•æ–‡ä»¶
- ğŸ“ **æ‰‹åŠ¨å®Œå–„**: ç”Ÿæˆçš„æµ‹è¯•æ–‡ä»¶æ¨¡æ¿éœ€è¦æ‰‹åŠ¨å®Œå–„å…·ä½“çš„æµ‹è¯•é€»è¾‘
- ğŸ”§ **é…ç½®æ£€æŸ¥**: é‡å‘½åæ“ä½œå¯èƒ½å½±å“ç°æœ‰çš„æµ‹è¯•é…ç½®ï¼Œè¯·æ£€æŸ¥Jesté…ç½®æ–‡ä»¶
- ğŸŒ¿ **åˆ†æ”¯æ“ä½œ**: å»ºè®®åœ¨éç”Ÿäº§åˆ†æ”¯ä¸Šè¿›è¡Œæµ‹è¯•ç»“æ„è°ƒæ•´

### é¡¹ç›®ç‰¹å®šè§„åˆ™

- ğŸ—ï¸ **7ç»„ä»¶æ¶æ„**: æµ‹è¯•ç»“æ„å¿…é¡»ä¸7ç»„ä»¶æ ¸å¿ƒæ¶æ„å¯¹åº”
- ğŸ“ **å‘½åçº¦å®š**: ä½¿ç”¨kebab-caseå‘½åæ–‡ä»¶å’Œç›®å½•
- ğŸ§ª **æµ‹è¯•è¦†ç›–**: ç¡®ä¿æ¯ä¸ªæ ¸å¿ƒç»„ä»¶éƒ½æœ‰å¯¹åº”çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- ğŸŒŠ **WebSocketæµ‹è¯•**: æµæ•°æ®ç›¸å…³åŠŸèƒ½éœ€è¦ç‰¹æ®Šçš„E2Eæµ‹è¯•

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

#### é—®é¢˜1: è„šæœ¬è¿è¡Œæƒé™ä¸è¶³
```bash
chmod +x test/utils/tools/*.ts
# æˆ–ä½¿ç”¨ npx è¿è¡Œ
npx ts-node test/utils/tools/test-structure-validator.ts
```

#### é—®é¢˜2: TypeScriptç¼–è¯‘é”™è¯¯
```bash
# ç¡®ä¿å·²å®‰è£…ä¾èµ–
bun install
# æˆ–é‡æ–°å®‰è£…
rm -rf node_modules && bun install
```

#### é—®é¢˜3: ç”Ÿæˆçš„æµ‹è¯•æ–‡ä»¶å¯¼å…¥è·¯å¾„é”™è¯¯
- æ‰‹åŠ¨æ£€æŸ¥å¹¶ä¿®æ­£ç”Ÿæˆæµ‹è¯•æ–‡ä»¶ä¸­çš„å¯¼å…¥è·¯å¾„
- ç¡®ä¿ç›¸å¯¹è·¯å¾„æ­£ç¡®æŒ‡å‘æºæ–‡ä»¶
- ç‰¹åˆ«æ³¨æ„7ç»„ä»¶æ¶æ„ä¸‹çš„è·¯å¾„å˜åŒ–

#### é—®é¢˜4: ç›®å½•ç§»åŠ¨åæµ‹è¯•è¿è¡Œå¤±è´¥
```bash
# æ£€æŸ¥Jesté…ç½®æ˜¯å¦éœ€è¦æ›´æ–°
cat test/config/jest.*.config.js

# éªŒè¯è·¯å¾„æ˜ å°„
npx jest --showConfig

# é‡æ–°è¿è¡Œç‰¹å®šç±»å‹çš„æµ‹è¯•
bun run test:unit
```

#### é—®é¢˜5: å¤§é‡é‡å¤æ–‡ä»¶
```bash
# è¿™æ˜¯æ­£å¸¸ç°è±¡ï¼Œä½¿ç”¨æ¸…ç†å·¥å…·
npx ts-node test/utils/tools/test-find-duplicates.ts --cleanup --execute

# æ£€æŸ¥æ¸…ç†ç»“æœ
npx ts-node test/utils/tools/test-find-duplicates.ts
```

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [é¡¹ç›®ä¸»æ–‡æ¡£](../../README.md)
- [CLAUDE.md å¼€å‘æŒ‡å—](../../CLAUDE.md)
- [Jesté…ç½®è¯´æ˜](../config/)
- [7ç»„ä»¶æ¶æ„æ–‡æ¡£](../../docs/ç³»ç»ŸåŸºæœ¬æ¶æ„å’Œè¯´æ˜æ–‡æ¡£.md)

## ğŸ¤ è´¡çŒ®æŒ‡å—

å¦‚æœå‘ç°å·¥å…·bugæˆ–æœ‰æ”¹è¿›å»ºè®®ï¼š

1. **é—®é¢˜æŠ¥å‘Š**: æ£€æŸ¥ç°æœ‰çš„issueï¼Œæäº¤è¯¦ç»†çš„bugæŠ¥å‘Š
2. **åŠŸèƒ½è¯·æ±‚**: æè¿°æ–°åŠŸèƒ½çš„ä½¿ç”¨åœºæ™¯å’Œé¢„æœŸæ•ˆæœ
3. **ä»£ç è´¡çŒ®**: æ¬¢è¿æäº¤PRæ”¹è¿›å·¥å…·åŠŸèƒ½
4. **æ–‡æ¡£æ”¹è¿›**: å¸®åŠ©å®Œå–„ä½¿ç”¨æ–‡æ¡£å’Œç¤ºä¾‹

### å¼€å‘è°ƒè¯•

```bash
# å¯ç”¨è°ƒè¯•æ¨¡å¼
DEBUG=true npx ts-node test/utils/tools/test-structure-validator.ts

# æŸ¥çœ‹å·¥å…·å†…éƒ¨é€»è¾‘
npx ts-node test/utils/tools/test-structure-validator.ts --verbose
```

---

**ğŸ“ éœ€è¦å¸®åŠ©?** 
- æŸ¥çœ‹ [æ•…éšœæ’é™¤](#ğŸš¨-æ•…éšœæ’é™¤) éƒ¨åˆ†
- æ£€æŸ¥ [æœ€ä½³å®è·µ](#ğŸ“‹-æœ€ä½³å®è·µ) æµç¨‹
- å‚è€ƒå®é™…çš„ [æˆåŠŸæ¡ˆä¾‹ç»Ÿè®¡](#æˆåŠŸæ¡ˆä¾‹ç»Ÿè®¡)

**ğŸ¯ è®°ä½**: è¿™äº›å·¥å…·æ˜¯ä¸ºäº†è®©æµ‹è¯•ç›®å½•ç»“æ„ä¸7ç»„ä»¶æ ¸å¿ƒæ¶æ„å®Œç¾å¯¹åº”ï¼Œç¡®ä¿ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§ï¼